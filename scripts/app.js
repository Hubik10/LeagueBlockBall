!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://at-app.cdntvn.pl/package/lib/utils/2.7.7/",n(n.s=28)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(11).default,i=n(3);t.exports=function(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(36)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){var r=n(29);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){function n(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function s(t){n(a,i,o,s,u,"next",t)}function u(t){n(a,i,o,s,u,"throw",t)}s(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(30),i=n(31),o=n(19),a=n(32);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";var r=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===i}(t)}(t)};var i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function o(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function a(t,e,n){return t.concat(e).map((function(t){return o(t,n)}))}function s(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function u(t,e){try{return e in t}catch(t){return!1}}function c(t,e,n){var r={};return n.isMergeableObject(t)&&s(t).forEach((function(e){r[e]=o(t[e],n)})),s(e).forEach((function(i){(function(t,e){return u(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,i)||(u(t,i)&&n.isMergeableObject(e[i])?r[i]=function(t,e){if(!e.customMerge)return l;var n=e.customMerge(t);return"function"==typeof n?n:l}(i,n)(t[i],e[i],n):r[i]=o(e[i],n))})),r}function l(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||a,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=o;var i=Array.isArray(e);return i===Array.isArray(t)?i?n.arrayMerge(t,e,n):c(t,e,n):o(e,n)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return l(t,n,e)}),{})};var f=l;t.exports=f},function(t,e){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(33),i=n(34),o=n(19),a=n(35);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){try{(void 0!==t&&t.env&&t.env.DEBUG&&t.env.DEBUG.match(/json-rules-engine/)||"undefined"!=typeof window&&window.localStorage&&window.localStorage.debug&&window.localStorage.debug.match(/json-rules-engine/))&&console.log(e)}catch(t){}}}).call(this,n(16))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(39),a=(r=o)&&r.__esModule?r:{default:r};var s=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e;var i={cache:!0};if(void 0===r&&(r=i),"function"!=typeof n?(this.value=n,this.type=this.constructor.CONSTANT):(this.calculationMethod=n,this.type=this.constructor.DYNAMIC),!this.id)throw new Error("factId required");return this.priority=parseInt(r.priority||1,10),this.options=Object.assign({},i,r),this.cacheKeyMethod=this.defaultCacheKeys,this}return i(t,[{key:"isConstant",value:function(){return this.type===this.constructor.CONSTANT}},{key:"isDynamic",value:function(){return this.type===this.constructor.DYNAMIC}},{key:"calculate",value:function(t,e){return Object.prototype.hasOwnProperty.call(this,"value")?this.value:this.calculationMethod(t,e)}},{key:"defaultCacheKeys",value:function(t,e){return{params:e,id:t}}},{key:"getCacheKey",value:function(e){if(!0===this.options.cache){var n=this.cacheKeyMethod(this.id,e);return t.hashFromObject(n)}}}],[{key:"hashFromObject",value:function(t){return(0,a.default)(t)}}]),t}();s.CONSTANT="CONSTANT",s.DYNAMIC="DYNAMIC",e.default=s},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=String(e),!e)throw new Error("Missing operator name");if("function"!=typeof n)throw new Error("Missing operator callback");this.cb=n,this.factValueValidator=r,this.factValueValidator||(this.factValueValidator=function(){return!0})}return r(t,[{key:"evaluate",value:function(t,e){return this.factValueValidator(t)&&this.cb(t,e)}}]),t}();e.default=i},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(18);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(40),i=n(41),o=n(42);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return S(this,e,n);case"utf8":case"utf-8":return R(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return P(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){f=!1;break}if(f)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function w(t,e,n,r){return q(U(e,t.length-n),t,n,r)}function _(t,e,n,r){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return _(t,e,n,r)}function O(t,e,n,r){return q(z(e),t,n,r)}function x(t,e,n,r){return q(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function R(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):v.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=t.slice(e,n),f=0;f<s;++f)if(c[f]!==l[f]){o=c[f],a=l[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function P(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function S(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=B(t[o]);return i}function T(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function j(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,r,o){return o||L(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function M(t,e,n,r,o){return o||L(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||j(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||j(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||j(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||j(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||j(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||j(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||j(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||j(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||j(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||j(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||j(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||j(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||j(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||j(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return M(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return M(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:U(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(15))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=s(n(43)),o=s(n(44)),a=s(n(13));function s(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));"string"==typeof t&&(t=JSON.parse(t)),t&&t.conditions&&n.setConditions(t.conditions),t&&t.onSuccess&&n.on("success",t.onSuccess),t&&t.onFailure&&n.on("failure",t.onFailure),t&&(t.name||0===t.name)&&n.setName(t.name);var r=t&&t.priority||1;n.setPriority(r);var i=t&&t.event||{type:"unknown"};return n.setEvent(i),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"setPriority",value:function(t){if((t=parseInt(t,10))<=0)throw new Error("Priority must be greater than zero");return this.priority=t,this}},{key:"setName",value:function(t){if(!t&&0!==t)throw new Error('Rule "name" must be defined');return this.name=t,this}},{key:"setConditions",value:function(t){if(!Object.prototype.hasOwnProperty.call(t,"all")&&!Object.prototype.hasOwnProperty.call(t,"any"))throw new Error('"conditions" root must contain a single instance of "all" or "any"');return this.conditions=new i.default(t),this}},{key:"setEvent",value:function(t){if(!t)throw new Error("Rule: setEvent() requires event object");if(!Object.prototype.hasOwnProperty.call(t,"type"))throw new Error('Rule: setEvent() requires event object with "type" property');return this.ruleEvent={type:t.type},t.params&&(this.ruleEvent.params=t.params),this}},{key:"getEvent",value:function(){return this.ruleEvent}},{key:"getPriority",value:function(){return this.priority}},{key:"getConditions",value:function(){return this.conditions}},{key:"getEngine",value:function(){return this.engine}},{key:"setEngine",value:function(t){return this.engine=t,this}},{key:"toJSON",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e={conditions:this.conditions.toJSON(!1),priority:this.priority,event:this.ruleEvent,name:this.name};return t?JSON.stringify(e):e}},{key:"prioritizeConditions",value:function(t){var e=this,n=t.reduce((function(t,n){var r=n.priority;if(!r){var i=e.engine.getFact(n.fact);r=i&&i.priority||1}return t[r]||(t[r]=[]),t[r].push(n),t}),{});return Object.keys(n).sort((function(t,e){return Number(t)>Number(e)?-1:1})).map((function(t){return n[t]}))}},{key:"evaluate",value:function(t){var e=this,n=new o.default(this.conditions,this.ruleEvent,this.priority,this.name),r=function(n,r){return Array.isArray(n)||(n=[n]),Promise.all(n.map((function(n){return function(n){if(n.isBooleanOperator()){var r=n[n.operator];return("all"===n.operator?u(r):s(r)).then((function(t){var e=!0===t;return n.result=e,e}))}return n.evaluate(t,e.engine.operators).then((function(t){var e=t.result;return n.factResult=t.leftHandSideValue,n.result=e,e}))}(n)}))).then((function(t){return(0,a.default)("rule::evaluateConditions results",t),r.call(t,(function(t){return!0===t}))}))},i=function(t,n){if(0===t.length)return Promise.resolve(!0);var i=Array.prototype.some;"all"===n&&(i=Array.prototype.every);for(var o=e.prioritizeConditions(t),s=Promise.resolve(),u=function(t){var e=o[t],u=!1;s=s.then((function(t){return"any"===n&&!0===t||u?((0,a.default)("prioritizeAndRun::detected truthy result; skipping remaining conditions"),u=!0,!0):"all"===n&&!1===t||u?((0,a.default)("prioritizeAndRun::detected falsey result; skipping remaining conditions"),u=!0,!1):r(e,i)}))},c=0;c<o.length;c++)u(c);return s},s=function(t){return i(t,"any")},u=function(t){return i(t,"all")},c=function(r){n.setResult(r);var i=r?"success":"failure";return e.emitAsync(i,n.event,t,n).then((function(){return n}))};return n.conditions.any?s(n.conditions.any).then((function(t){return c(t)})):u(n.conditions.all).then((function(t){return c(t)}))}}]),e}(s(n(23)).default);e.default=u},function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},function(t,e,n){(function(r,i){var o;
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(a){var s=Object.hasOwnProperty,u=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},c="object"==typeof r&&"function"==typeof r.nextTick,l="function"==typeof Symbol,f="object"==typeof Reflect,h="function"==typeof i?i:setTimeout,d=l?f&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(t){var e=Object.getOwnPropertyNames(t);return e.push.apply(e,Object.getOwnPropertySymbols(t)),e}:Object.keys;function p(){this._events={},this._conf&&v.call(this,this._conf)}function v(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),void 0!==t.maxListeners&&(this._maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),t.ignoreErrors&&(this.ignoreErrors=t.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function g(t,e){var n="(node) warning: possible EventEmitter memory leak detected. "+t+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+e+"."),void 0!==r&&r.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=t,r.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var y=function(t,e,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[t];case 2:return[t,e];case 3:return[t,e,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function m(t,e){for(var n={},r=t.length,i=e?e.length:0,o=0;o<r;o++)n[t[o]]=o<i?e[o]:void 0;return n}function b(t,e,n){var r,i;if(this._emitter=t,this._target=e,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),e.addEventListener?(r=e.addEventListener,i=e.removeEventListener):e.addListener?(r=e.addListener,i=e.removeListener):e.on&&(r=e.on,i=e.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var o=t._observers;o?o.push(this):t._observers=[this]}function w(t,e,n,r){var i=Object.assign({},e);if(!t)return i;if("object"!=typeof t)throw TypeError("options must be an object");var o,a,u,c=Object.keys(t),l=c.length;function f(t){throw Error('Invalid "'+o+'" option value'+(t?". Reason: "+t:""))}for(var h=0;h<l;h++){if(o=c[h],!r&&!s.call(e,o))throw Error('Unknown "'+o+'" option');void 0!==(a=t[o])&&(u=n[o],i[o]=u?u(a,f):a)}return i}function _(t,e){return"function"==typeof t&&t.hasOwnProperty("prototype")||e("value must be a constructor"),t}function E(t){var e="value must be type of "+t.join("|"),n=t.length,r=t[0],i=t[1];return 1===n?function(t,n){if(typeof t===r)return t;n(e)}:2===n?function(t,n){var o=typeof t;if(o===r||o===i)return t;n(e)}:function(r,i){for(var o=typeof r,a=n;a-- >0;)if(o===t[a])return r;i(e)}}Object.assign(b.prototype,{subscribe:function(t,e,n){var r=this,i=this._target,o=this._emitter,a=this._listeners,s=function(){var r=y.apply(null,arguments),a={data:r,name:e,original:t};if(n){var s=n.call(i,a);!1!==s&&o.emit.apply(o,[a.name].concat(r))}else o.emit.apply(o,[e].concat(r))};if(a[t])throw Error("Event '"+t+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===e&&null===a[t]&&(a[t]=s,r._on.call(i,t,s))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===e&&!o.hasListeners(n)&&a[t]&&(a[t]=null,r._off.call(i,t,s))},a[t]=null,o.on("removeListener",this._onRemoveListener)):(a[t]=s,r._on.call(i,t,s))},unsubscribe:function(t){var e,n,r,i=this,o=this._listeners,a=this._emitter,s=this._off,u=this._target;if(t&&"string"!=typeof t)throw TypeError("event must be a string");function c(){i._onNewListener&&(a.off("newListener",i._onNewListener),a.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var t=R.call(a,i);a._observers.splice(t,1)}if(t){if(!(e=o[t]))return;s.call(u,t,e),delete o[t],--this._listenersCount||c()}else{for(r=(n=d(o)).length;r-- >0;)t=n[r],s.call(u,t,o[t]);this._listeners={},this._listenersCount=0,c()}}});var O=E(["function"]),x=E(["object","function"]);function A(t,e,n){var r,i,o,a=0,s=new t((function(u,c,l){function f(){i&&(i=null),a&&(clearTimeout(a),a=0)}n=w(n,{timeout:0,overload:!1},{timeout:function(t,e){return("number"!=typeof(t*=1)||t<0||!Number.isFinite(t))&&e("timeout must be a positive number"),t}}),r=!n.overload&&"function"==typeof t.prototype.cancel&&"function"==typeof l;var h=function(t){f(),u(t)},d=function(t){f(),c(t)};r?e(h,d,l):(i=[function(t){d(t||Error("canceled"))}],e(h,d,(function(t){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof t)throw TypeError("onCancel callback must be a function");i.push(t)})),o=!0),n.timeout>0&&(a=setTimeout((function(){var t=Error("timeout");t.code="ETIMEDOUT",a=0,s.cancel(t),c(t)}),n.timeout))}));return r||(s.cancel=function(t){if(i){for(var e=i.length,n=1;n<e;n++)i[n](t);i[0](t),i=null}}),s}function R(t){var e=this._observers;if(!e)return-1;for(var n=e.length,r=0;r<n;r++)if(e[r]._target===t)return r;return-1}function k(t,e,n,r,i){if(!n)return null;if(0===r){var o=typeof e;if("string"===o){var a,s,u=0,c=0,l=this.delimiter,f=l.length;if(-1!==(s=e.indexOf(l))){a=new Array(5);do{a[u++]=e.slice(c,s),c=s+f}while(-1!==(s=e.indexOf(l,c)));a[u++]=e.slice(c),e=a,i=u}else e=[e],i=1}else"object"===o?i=e.length:(e=[e],i=1)}var h,p,v,g,y,m,b,w=null,_=e[r],E=e[r+1];if(r===i)n._listeners&&("function"==typeof n._listeners?(t&&t.push(n._listeners),w=[n]):(t&&t.push.apply(t,n._listeners),w=[n]));else{if("*"===_){for(s=(m=d(n)).length;s-- >0;)"_listeners"!==(h=m[s])&&(b=k(t,e,n[h],r+1,i))&&(w?w.push.apply(w,b):w=b);return w}if("**"===_){for((y=r+1===i||r+2===i&&"*"===E)&&n._listeners&&(w=k(t,e,n,i,i)),s=(m=d(n)).length;s-- >0;)"_listeners"!==(h=m[s])&&("*"===h||"**"===h?(n[h]._listeners&&!y&&(b=k(t,e,n[h],i,i))&&(w?w.push.apply(w,b):w=b),b=k(t,e,n[h],r,i)):b=k(t,e,n[h],h===E?r+2:r,i),b&&(w?w.push.apply(w,b):w=b));return w}n[_]&&(w=k(t,e,n[_],r+1,i))}if((p=n["*"])&&k(t,e,p,r+1,i),v=n["**"])if(r<i)for(v._listeners&&k(t,e,v,i,i),s=(m=d(v)).length;s-- >0;)"_listeners"!==(h=m[s])&&(h===E?k(t,e,v[h],r+2,i):h===_?k(t,e,v[h],r+1,i):((g={})[h]=v[h],k(t,e,{"**":g},r+1,i)));else v._listeners?k(t,e,v,i,i):v["*"]&&v["*"]._listeners&&k(t,e,v["*"],i,i);return w}function P(t,e,n){var r,i,o=0,a=0,s=this.delimiter,u=s.length;if("string"==typeof t)if(-1!==(r=t.indexOf(s))){i=new Array(5);do{i[o++]=t.slice(a,r),a=r+u}while(-1!==(r=t.indexOf(s,a)));i[o++]=t.slice(a)}else i=[t],o=1;else i=t,o=t.length;if(o>1)for(r=0;r+1<o;r++)if("**"===i[r]&&"**"===i[r+1])return;var c,l=this.listenerTree;for(r=0;r<o;r++)if(l=l[c=i[r]]||(l[c]={}),r===o-1)return l._listeners?("function"==typeof l._listeners&&(l._listeners=[l._listeners]),n?l._listeners.unshift(e):l._listeners.push(e),!l._listeners.warned&&this._maxListeners>0&&l._listeners.length>this._maxListeners&&(l._listeners.warned=!0,g.call(this,l._listeners.length,c))):l._listeners=e,!0;return!0}function S(t,e,n,r){for(var i,o,a,s,u=d(t),c=u.length,l=t._listeners;c-- >0;)i=t[o=u[c]],a="_listeners"===o?n:n?n.concat(o):[o],s=r||"symbol"==typeof o,l&&e.push(s?a:a.join(this.delimiter)),"object"==typeof i&&S.call(this,i,e,a,s);return e}function T(t){for(var e,n,r,i=d(t),o=i.length;o-- >0;)(e=t[n=i[o]])&&(r=!0,"_listeners"===n||T(e)||delete t[n]);return r}function j(t,e,n){this.emitter=t,this.event=e,this.listener=n}function C(t,e,n){if(!0===n)o=!0;else if(!1===n)i=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var i=n.async,o=n.promisify,a=n.nextTick,s=n.objectify}if(i||a||o){var u=e,l=e._origin||e;if(a&&!c)throw Error("process.nextTick is not supported");void 0===o&&(o="AsyncFunction"===e.constructor.name),(e=function(){var t=arguments,e=this,n=this.event;return o?a?Promise.resolve():new Promise((function(t){h(t)})).then((function(){return e.event=n,u.apply(e,t)})):(a?r.nextTick:h)((function(){e.event=n,u.apply(e,t)}))})._async=!0,e._origin=l}return[e,s?new j(this,t,e):this]}function D(t){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,v.call(this,t)}j.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},D.EventEmitter2=D,D.prototype.listenTo=function(t,e,n){if("object"!=typeof t)throw TypeError("target musts be an object");var r=this;function i(e){if("object"!=typeof e)throw TypeError("events must be an object");var i,o=n.reducers,a=R.call(r,t);i=-1===a?new b(r,t,n):r._observers[a];for(var s,u=d(e),c=u.length,l="function"==typeof o,f=0;f<c;f++)s=u[f],i.subscribe(s,e[s]||s,l?o:o&&o[s])}return n=w(n,{on:void 0,off:void 0,reducers:void 0},{on:O,off:O,reducers:x}),u(e)?i(m(e)):i("string"==typeof e?m(e.split(/\s+/)):e),this},D.prototype.stopListeningTo=function(t,e){var n=this._observers;if(!n)return!1;var r,i=n.length,o=!1;if(t&&"object"!=typeof t)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],t&&r._target!==t||(r.unsubscribe(e),o=!0);return o},D.prototype.delimiter=".",D.prototype.setMaxListeners=function(t){void 0!==t&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},D.prototype.getMaxListeners=function(){return this._maxListeners},D.prototype.event="",D.prototype.once=function(t,e,n){return this._once(t,e,!1,n)},D.prototype.prependOnceListener=function(t,e,n){return this._once(t,e,!0,n)},D.prototype._once=function(t,e,n,r){return this._many(t,1,e,n,r)},D.prototype.many=function(t,e,n,r){return this._many(t,e,n,!1,r)},D.prototype.prependMany=function(t,e,n,r){return this._many(t,e,n,!0,r)},D.prototype._many=function(t,e,n,r,i){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function a(){return 0==--e&&o.off(t,a),n.apply(this,arguments)}return a._origin=n,this._on(t,a,r,i)},D.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var t,e,n,r,i,o,a=arguments[0],s=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(s&&(t=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,l)for(r=0;r<n;r++)if("symbol"==typeof a[r]){o=!0;break}o||(a=a.join(this.delimiter))}var u,c=arguments.length;if(this._all&&this._all.length)for(r=0,n=(u=this._all.slice()).length;r<n;r++)switch(this.event=a,c){case 1:u[r].call(this,a);break;case 2:u[r].call(this,a,arguments[1]);break;case 3:u[r].call(this,a,arguments[1],arguments[2]);break;default:u[r].apply(this,arguments)}if(s)u=[],k.call(this,u,t,this.listenerTree,0,n);else{if("function"==typeof(u=this._events[a])){switch(this.event=a,c){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(e=new Array(c-1),i=1;i<c;i++)e[i-1]=arguments[i];u.apply(this,e)}return!0}u&&(u=u.slice())}if(u&&u.length){if(c>3)for(e=new Array(c-1),i=1;i<c;i++)e[i-1]=arguments[i];for(r=0,n=u.length;r<n;r++)switch(this.event=a,c){case 1:u[r].call(this);break;case 2:u[r].call(this,arguments[1]);break;case 3:u[r].call(this,arguments[1],arguments[2]);break;default:u[r].apply(this,e)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},D.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var t,e,n,r,i,o,a=arguments[0],s=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(s&&(t=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(r=a.length,l)for(i=0;i<r;i++)if("symbol"==typeof a[i]){e=!0;break}e||(a=a.join(this.delimiter))}var u,c=[],f=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=a,f){case 1:c.push(this._all[i].call(this,a));break;case 2:c.push(this._all[i].call(this,a,arguments[1]));break;case 3:c.push(this._all[i].call(this,a,arguments[1],arguments[2]));break;default:c.push(this._all[i].apply(this,arguments))}if(s?(u=[],k.call(this,u,t,this.listenerTree,0)):u=this._events[a],"function"==typeof u)switch(this.event=a,f){case 1:c.push(u.call(this));break;case 2:c.push(u.call(this,arguments[1]));break;case 3:c.push(u.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];c.push(u.apply(this,n))}else if(u&&u.length){if(u=u.slice(),f>3)for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];for(i=0,r=u.length;i<r;i++)switch(this.event=a,f){case 1:c.push(u[i].call(this));break;case 2:c.push(u[i].call(this,arguments[1]));break;case 3:c.push(u[i].call(this,arguments[1],arguments[2]));break;default:c.push(u[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(c)},D.prototype.on=function(t,e,n){return this._on(t,e,!1,n)},D.prototype.prependListener=function(t,e,n){return this._on(t,e,!0,n)},D.prototype.onAny=function(t){return this._onAny(t,!1)},D.prototype.prependAny=function(t){return this._onAny(t,!0)},D.prototype.addListener=D.prototype.on,D.prototype._onAny=function(t,e){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),e?this._all.unshift(t):this._all.push(t),this},D.prototype._on=function(t,e,n,r){if("function"==typeof t)return this._onAny(t,e),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");this._events||p.call(this);var i,o=this;return void 0!==r&&(e=(i=C.call(this,t,e,r))[0],o=i[1]),this._newListener&&this.emit("newListener",t,e),this.wildcard?(P.call(this,t,e,n),o):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),n?this._events[t].unshift(e):this._events[t].push(e),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,g.call(this,this._events[t].length,t))):this._events[t]=e,o)},D.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof t?t.split(this.delimiter):t.slice();if(!(r=k.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[t])return this;n=this._events[t],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var a=r[o];if(n=a._listeners,u(n)){for(var s=-1,c=0,l=n.length;c<l;c++)if(n[c]===e||n[c].listener&&n[c].listener===e||n[c]._origin&&n[c]._origin===e){s=c;break}if(s<0)continue;return this.wildcard?a._listeners.splice(s,1):this._events[t].splice(s,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[t]),this._removeListener&&this.emit("removeListener",t,e),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete a._listeners:delete this._events[t],this._removeListener&&this.emit("removeListener",t,e))}return this.listenerTree&&T(this.listenerTree),this},D.prototype.offAny=function(t){var e,n=0,r=0;if(t&&this._all&&this._all.length>0){for(n=0,r=(e=this._all).length;n<r;n++)if(t===e[n])return e.splice(n,1),this._removeListener&&this.emit("removeListenerAny",t),this}else{if(e=this._all,this._removeListener)for(n=0,r=e.length;n<r;n++)this.emit("removeListenerAny",e[n]);this._all=[]}return this},D.prototype.removeListener=D.prototype.off,D.prototype.removeAllListeners=function(t){if(void 0===t)return!this._events||p.call(this),this;if(this.wildcard){var e,n=k.call(this,null,t,this.listenerTree,0);if(!n)return this;for(e=0;e<n.length;e++)n[e]._listeners=null;this.listenerTree&&T(this.listenerTree)}else this._events&&(this._events[t]=null);return this},D.prototype.listeners=function(t){var e,n,r,i,o,a=this._events;if(void 0===t){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(i=(e=d(a)).length,r=[];i-- >0;)"function"==typeof(n=a[e[i]])?r.push(n):r.push.apply(r,n);return r}if(this.wildcard){if(!(o=this.listenerTree))return[];var s=[],u="string"==typeof t?t.split(this.delimiter):t.slice();return k.call(this,s,u,o,0),s}return a&&(n=a[t])?"function"==typeof n?[n]:n:[]},D.prototype.eventNames=function(t){var e=this._events;return this.wildcard?S.call(this,this.listenerTree,[],null,t):e?d(e):[]},D.prototype.listenerCount=function(t){return this.listeners(t).length},D.prototype.hasListeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return k.call(this,e,n,this.listenerTree,0),e.length>0}var r=this._events,i=this._all;return!!(i&&i.length||r&&(void 0===t?d(r).length:r[t]))},D.prototype.listenersAny=function(){return this._all?this._all:[]},D.prototype.waitFor=function(t,e){var n=this,r=typeof e;return"number"===r?e={timeout:e}:"function"===r&&(e={filter:e}),A((e=w(e,{timeout:0,filter:void 0,handleError:!1,Promise:Promise,overload:!1},{filter:O,Promise:_})).Promise,(function(r,i,o){function a(){var o=e.filter;if(!o||o.apply(n,arguments))if(n.off(t,a),e.handleError){var s=arguments[0];s?i(s):r(y.apply(null,arguments).slice(1))}else r(y.apply(null,arguments))}o((function(){n.off(t,a)})),n._on(t,a,!1)}),{timeout:e.timeout,overload:e.overload})};var I=D.prototype;Object.defineProperties(D,{defaultMaxListeners:{get:function(){return I._maxListeners},set:function(t){if("number"!=typeof t||t<0||Number.isNaN(t))throw TypeError("n must be a non-negative number");I._maxListeners=t},enumerable:!0},once:{value:function(t,e,n){return A((n=w(n,{Promise:Promise,timeout:0,overload:!1},{Promise:_})).Promise,(function(n,r,i){var o;if("function"==typeof t.addEventListener)return o=function(){n(y.apply(null,arguments))},i((function(){t.removeEventListener(e,o)})),void t.addEventListener(e,o,{once:!0});var a,s=function(){a&&t.removeListener("error",a),n(y.apply(null,arguments))};"error"!==e&&(a=function(n){t.removeListener(e,s),r(n)},t.once("error",a)),i((function(){a&&t.removeListener("error",a),t.removeListener(e,s)})),t.once(e,s)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(I,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),void 0===(o=function(){return D}.call(e,n,e,t))||(t.exports=o)}()}).call(this,n(16),n(46).setImmediate)},function(t){t.exports=JSON.parse('{"core":{"startupInstance":false},"adblockDetector":{"detection":true,"cssClasses":{"classesArray":["adsbygoogle","prebid","adocean","ado","ad","ads","advert","banner","reklama","linkSponsorowany","adsense","advertisments","reklama-top","adv_container","advert.box","advert.desktop","advert.mobile","advert.mpu","advert.skyscraper","advert__container","ins.adsbygoogle","adv-container","ad.addon","ad.bottom_article_leaderboard","ad.bottomrect","ad.box","ad.brandboard","ad.card","ad.center","ad.contentboard","ad.desktop-970x250","ad.element","ad.floater-link","ad.gallery","ad.halfpage","ad.inner","ad.item","ad.leaderboard","ad.maxiboard","ad.maxisky","ad.middlerect","ad.module","ad.monsterboard","ad.native_story_1","ad.native_story_2","ad.native_story_3","ad.netboard","ad.post-area","ad.preroll","ad.promotion","ad.rectangle","ad.rectangle_2","ad.rectangle_3","ad.rectangle_home_1","ad.section","ad.sidebar-module","ad.size-300x250","ad.skybridgeleft","ad.small-mpu","ad.small-teaser","ad.super","ad.top_article_leadeboard","ad.wideboard","ad.wideboard_tablet","ad.widget","article.ad","ads.MREC","ads.MREC1","ads.MREC2","ads.MREC3","ads.MREC4","ads.bottom","ads.box","ads.cell","ads.cta","ads.grid-layout","ads.rectangle160","ads.rectangle300","ads.skyscraper160","ads.square","ads.top","ads.widget","adsbyg","anal-post-popularne","ads-programmatic","cg3-products","reklama-rectangle","reklama_gora","reklamastoproc","single_ad_300x250","td-a-rec","trizer-bnr","adform-slot","ppa-slot","sliderads","widget-ads-content","onnetwork-video"],"count":10}},"logs":{"driver":{"remote":{"filter":"all","enable":false},"console":{"filter":"all","enable":false,"schema":"dark","schemas":{"dark":{"noImportant":"color:#444;line-height:10px;font-size:10px;","important":"color:#eee;line-height:10px;font-size:10px;font-weight:bold;","error":"color:#f00;line-height:10px;font-size:10px;","warn":"color:#ffd740;line-height:10px;font-size:10px;","notice":"color:#00c56c;line-height:10px;font-size:10px;","distinction":"color:#447bff;line-height:10px;font-size:10px;","default":"color:#aaa;line-height:10px;font-size:10px;"},"light":{"noImportant":"color:#ddd;line-height:10px;font-size:10px;","important":"color:#000;line-height:10px;font-size:10px;font-weight:bold;","error":"color:#dc3545;line-height:10px;font-size:10px;","warn":"color:#ffc107;line-height:10px;font-size:10px;","notice":"color:#28a745;line-height:10px;font-size:10px;","distinction":"color:#007bff;line-height:10px;font-size:10px;","default":"color:#666;line-height:10px;font-size:10px;"}}}},"websocket":{"endpoint":"wss://at-tools.services.tvn.pl/proxy"},"map":{"all":{"l1":["all"]},"level1":{"l1":["all","!quiet","!componentRegistered","!componentRegistering","!componentInitializing","!componentInitialized"]},"level2":{"l1":["adapterCall"]},"level3":{"l1":["warning","error"]}}}}')},function(t){t.exports=JSON.parse('{"adblockDetector":{"onStateChange":{"implementation":"external","isAsync":false},"getCurrentState":{"implementation":"internal","isAsync":true}},"ssai":{"sendReportRequest":{"implementation":"internal","isAsync":true}},"sdk":{"onReady":{"implementation":"external","isAsync":false}}}')},function(t,e){},function(t,e,n){"use strict";t.exports=n(37)},function(t,e,n){t.exports=n(52)},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,n(e,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(18);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){var r=n(11).default;function i(){"use strict";
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=i=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,o=Object.create(i.prototype),a=new R(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d={};function p(){}function v(){}function g(){}var y={};l(y,s,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(k([])));b&&b!==n&&o.call(b,s)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){var n;this._invoke=function(i,a){function s(){return new e((function(n,s){!function n(i,a,s,u){var c=h(t[i],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,u)}),(function(t){n("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,u)}))}u(c.arg)}(i,a,n,s)}))}return n=n?n.then(s,s):s()}}function O(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=h(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function k(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return v.prototype=g,l(w,"constructor",g),l(g,"constructor",v),v.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},_(E.prototype),l(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new E(f(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(w),l(w,c,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Engine=e.Operator=e.Rule=e.Fact=void 0,e.default=function(t,e){return new r.default(t,e)};var r=s(n(38)),i=s(n(14)),o=s(n(21)),a=s(n(17));function s(t){return t&&t.__esModule?t:{default:t}}e.Fact=i.default,e.Rule=o.default,e.Operator=a.default,e.Engine=r.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FINISHED=e.RUNNING=e.READY=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=f(n(14)),o=f(n(21)),a=f(n(17)),s=f(n(48)),u=f(n(23)),c=f(n(51)),l=f(n(13));function f(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var p=e.READY="READY",v=e.RUNNING="RUNNING",g=e.FINISHED="FINISHED",y=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h(this,e);var r=d(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.rules=[],r.allowUndefinedFacts=n.allowUndefinedFacts||!1,r.pathResolver=n.pathResolver,r.operators=new Map,r.facts=new Map,r.status=p,t.map((function(t){return r.addRule(t)})),c.default.map((function(t){return r.addOperator(t)})),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"addRule",value:function(t){if(!t)throw new Error("Engine: addRule() requires options");var e=void 0;if(t instanceof o.default)e=t;else{if(!Object.prototype.hasOwnProperty.call(t,"event"))throw new Error('Engine: addRule() argument requires "event" property');if(!Object.prototype.hasOwnProperty.call(t,"conditions"))throw new Error('Engine: addRule() argument requires "conditions" property');e=new o.default(t)}return e.setEngine(this),this.rules.push(e),this.prioritizedRules=null,this}},{key:"updateRule",value:function(t){var e=this.rules.findIndex((function(e){return e.name===t.name}));if(!(e>-1))throw new Error("Engine: updateRule() rule not found");this.rules.splice(e,1),this.addRule(t),this.prioritizedRules=null}},{key:"removeRule",value:function(t){var e=!1;if(t instanceof o.default){var n=this.rules.indexOf(t);n>-1&&(e=Boolean(this.rules.splice(n,1).length))}else{var r=this.rules.filter((function(e){return e.name!==t}));e=r.length!==this.rules.length,this.rules=r}return e&&(this.prioritizedRules=null),e}},{key:"addOperator",value:function(t,e){var n=void 0;n=t instanceof a.default?t:new a.default(t,e),(0,l.default)("engine::addOperator name:"+n.name),this.operators.set(n.name,n)}},{key:"removeOperator",value:function(t){var e=void 0;return e=t instanceof a.default?t.name:t,this.operators.delete(e)}},{key:"addFact",value:function(t,e,n){var r=t,o=void 0;return t instanceof i.default?(r=t.id,o=t):o=new i.default(t,e,n),(0,l.default)("engine::addFact id:"+r),this.facts.set(r,o),this}},{key:"removeFact",value:function(t){var e=void 0;return e=t instanceof i.default?t.id:t,this.facts.delete(e)}},{key:"prioritizeRules",value:function(){if(!this.prioritizedRules){var t=this.rules.reduce((function(t,e){var n=e.priority;return t[n]||(t[n]=[]),t[n].push(e),t}),{});this.prioritizedRules=Object.keys(t).sort((function(t,e){return Number(t)>Number(e)?-1:1})).map((function(e){return t[e]}))}return this.prioritizedRules}},{key:"stop",value:function(){return this.status=g,this}},{key:"getFact",value:function(t){return this.facts.get(t)}},{key:"evaluateRules",value:function(t,e){var n=this;return Promise.all(t.map((function(t){return n.status!==v?((0,l.default)("engine::run status:"+n.status+"; skipping remaining rules"),Promise.resolve()):t.evaluate(e).then((function(t){return(0,l.default)("engine::run ruleResult:"+t.result),e.addResult(t),t.result?(e.addEvent(t.event,"success"),n.emitAsync("success",t.event,e,t).then((function(){return n.emitAsync(t.event.type,t.event.params,e,t)}))):(e.addEvent(t.event,"failure"),n.emitAsync("failure",t.event,e,t))}))})))}},{key:"run",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,l.default)("engine::run started"),this.status=v;var n={allowUndefinedFacts:this.allowUndefinedFacts,pathResolver:this.pathResolver},r=new s.default(this.facts,e,n),i=this.prioritizeRules(),o=Promise.resolve();return new Promise((function(e,n){i.map((function(e){return o=o.then((function(){return t.evaluateRules(e,r)})).catch(n)})),o.then((function(){t.status=g,(0,l.default)("engine::run completed");var n=r.getResults().reduce((function(t,e){return t[e.result?"results":"failureResults"].push(e),t}),{results:[],failureResults:[]}),i=n.results,o=n.failureResults;e({almanac:r,results:i,failureResults:o,events:r.getEvents("success"),failureEvents:r.getEvents("failure")})})).catch(n)}))}}]),e}(u.default);e.default=y},function(t,e,n){(function(e){t.exports=function(){"use strict";var t=function(t,e){return t.reduce((function(t,n){var r="[object "+n+"]";return e?t[r]=n:t[n]=r,t}),{})},n=function(t){return t.reduce((function(t,e){return t[e]=!0,t}),{})},r=["Array","Arguments","Object","RegExp","Symbol","Map","Set","Date","Error","Event","Generator","Promise","WeakMap","WeakSet","DocumentFragment","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","ArrayBuffer","DataView","DocumentFragment","Window","String","Number","Boolean","Function","Undefined","GeneratorFunction","BigInt","Null"],i=t(r,!1),o=t(r,!0),a=n([i.Generator,i.Promise,i.WeakMap,i.WeakSet]),s=n([i.Map,i.Set]),u=n([i.Date,i.RegExp]),c=n(["bigint","boolean","function","number","string","undefined"]),l=n([i.Arguments,i.Array]),f=n([i.RegExp,i.Symbol]),h=n([i.Float32Array,i.Float64Array,i.Int8Array,i.Int16Array,i.Int32Array,i.Uint8Array,i.Uint8ClampedArray,i.Uint16Array,i.Uint32Array]),d=void 0!==e&&"function"==typeof e.from,p="function"==typeof Uint16Array;function v(t){return String.fromCharCode.apply(null,new Uint16Array(t))}function g(t){return e.from(t).toString("utf8")}function y(t){return""}var m=d?g:p?v:y,b=/\[object ([HTML|SVG](.*)Element)\]/,w=Object.prototype.toString,_=Object.keys;function E(t,e){return t>e}function O(t,e){return t[0]>e[0]}function x(t,e){for(var n,r,i=0;i<t.length;++i){for(r=t[i],n=i-1;~n&&e(t[n],r);--n)t[n+1]=t[n];t[n+1]=r}return t}function A(t){for(var e,n=x(_(t),E),r={},i=0;i<n.length;++i)r[e=n[i]]=t[e];return r}function R(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n+1;return 0}function k(t,e,n,r){if(!r){var u=typeof t;if(c[u])return u+"|"+t;if(null===t)return t+"|"+t}var d,p=r||w.call(t);return l[p]?t:p===i.Object?A(t):f[p]?o[p]+"|"+t.toString():s[p]?t instanceof Map?function(t,e,n){var r=[];t.forEach((function(t,i){r.push([P(i,e,n),P(t,e,n)])})),x(r,O);for(var i,o=0;o<r.length;++o)i=r[o],r[o]="["+i[0]+","+i[1]+"]";return"Map|["+r.join(",")+"]"}(t,e,n):function(t,e,n){var r=[];return t.forEach((function(t){r.push(P(t,e,n))})),x(r,E),"Set|["+r.join(",")+"]"}(t,e,n):p===i.Date?o[p]+"|"+t.getTime():p===i.Error?o[p]+"|"+t.stack:p===i.Event?{bubbles:(d=t).bubbles,cancelBubble:d.cancelBubble,cancelable:d.cancelable,composed:d.composed,currentTarget:d.currentTarget,defaultPrevented:d.defaultPrevented,eventPhase:d.eventPhase,isTrusted:d.isTrusted,returnValue:d.returnValue,target:d.target,type:d.type}:a[p]?o[p]+"|NOT_ENUMERABLE":b.test(p)?p.slice(8,-1)+"|"+t.outerHTML:p===i.DocumentFragment?o[p]+"|"+function(t){for(var e=t.children,n=[],r=0;r<e.length;++r)n.push(e[r].outerHTML);return n.join(",")}(t):h[p]?o[p]+"|"+t.join(","):p===i.ArrayBuffer?o[p]+"|"+m(t):p===i.DataView?o[p]+"|"+m(t.buffer):t}function P(t,e,n){if(!t||"object"!=typeof t)return k(t,e,n);var r=w.call(t);return u[r]?k(t,e,n,r):JSON.stringify(t,function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=[]),function(n,r){if("object"==typeof r)if(t.length){var o=R(t,this);0===o?t.push(this):(t.splice(o),e.splice(o)),e.push(n);var a=R(t,r);if(0!==a)return"[~"+(e.slice(0,a).join(".")||".")+"]";t.push(r)}else t[0]=r,e[0]=n;return n&&this[n]instanceof Date?k(this[n],t,e,i.Date):k(r,t,e)}}(e,n))}function S(t){return function(t){for(var e,n=t.length,r=5381,i=52711;n--;)r=33*r^(e=t.charCodeAt(n)),i=33*i^e;return 4096*(r>>>0)+(i>>>0)}(P(t))}function T(t,e){return S(t)===S(e)}return T.all=function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);++e)if(!T(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]))return!1;return!0},T.any=function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);++e)if(T(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]))return!0;return!1},T.not=function(t,e){return S(t)!==S(e)},S.is=T,S}()}).call(this,n(20).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),a=r[0],s=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+d]=255&a,d+=p,a/=256,c-=8);t[n+d-p]|=128*v}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=a(n(13)),o=a(n(22));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("Condition: constructor options required");var n=t.booleanOperator(e);if(Object.assign(this,e),n){var r=e[n];if(!Array.isArray(r))throw new Error('"'+n+'" must be an array');this.operator=n,this.priority=parseInt(e.priority,10)||1,this[n]=r.map((function(e){return new t(e)}))}else{if(!Object.prototype.hasOwnProperty.call(e,"fact"))throw new Error('Condition: constructor "fact" property required');if(!Object.prototype.hasOwnProperty.call(e,"operator"))throw new Error('Condition: constructor "operator" property required');if(!Object.prototype.hasOwnProperty.call(e,"value"))throw new Error('Condition: constructor "value" property required');Object.prototype.hasOwnProperty.call(e,"priority")&&(e.priority=parseInt(e.priority,10))}}return r(t,[{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n={};this.priority&&(n.priority=this.priority);var r=t.booleanOperator(this);return r?n[r]=this[r].map((function(t){return t.toJSON(e)})):(n.operator=this.operator,n.value=this.value,n.fact=this.fact,void 0!==this.factResult&&(n.factResult=this.factResult),void 0!==this.result&&(n.result=this.result),this.params&&(n.params=this.params),this.path&&(n.path=this.path)),e?JSON.stringify(n):n}},{key:"_getValue",value:function(t){var e=this.value;return(0,o.default)(e)&&Object.prototype.hasOwnProperty.call(e,"fact")?t.factValue(e.fact,e.params,e.path):Promise.resolve(e)}},{key:"evaluate",value:function(t,e){var n=this;if(!t)return Promise.reject(new Error("almanac required"));if(!e)return Promise.reject(new Error("operatorMap required"));if(this.isBooleanOperator())return Promise.reject(new Error("Cannot evaluate() a boolean condition"));var r=e.get(this.operator);return r?this._getValue(t).then((function(e){return t.factValue(n.fact,n.params,n.path).then((function(t){var o=r.evaluate(t,e);return(0,i.default)("condition::evaluate <"+JSON.stringify(t)+" "+n.operator+" "+JSON.stringify(e)+"?> ("+o+")"),{result:o,leftHandSideValue:t,rightHandSideValue:e,operator:n.operator}}))})):Promise.reject(new Error("Unknown operator: "+this.operator))}},{key:"booleanOperator",value:function(){return t.booleanOperator(this)}},{key:"isBooleanOperator",value:function(){return void 0!==t.booleanOperator(this)}}],[{key:"booleanOperator",value:function(t){return Object.prototype.hasOwnProperty.call(t,"any")?"any":Object.prototype.hasOwnProperty.call(t,"all")?"all":void 0}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(45),a=(r=o)&&r.__esModule?r:{default:r};var s=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditions=(0,a.default)(e),this.event=(0,a.default)(n),this.priority=(0,a.default)(r),this.name=(0,a.default)(i),this.result=null}return i(t,[{key:"setResult",value:function(t){this.result=t}},{key:"toJSON",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e={conditions:this.conditions.toJSON(!1),event:this.event,priority:this.priority,name:this.name,result:this.result};return t?JSON.stringify(e):e}}]),t}();e.default=s},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var n,r,i;try{n=Map}catch(t){n=function(){}}try{r=Set}catch(t){r=function(){}}try{i=Promise}catch(t){i=function(){}}function o(a,u,c,l,f){"object"==typeof u&&(c=u.depth,l=u.prototype,f=u.includeNonEnumerable,u=u.circular);var h=[],d=[],p=void 0!==e;return void 0===u&&(u=!0),void 0===c&&(c=1/0),function a(c,v){if(null===c)return null;if(0===v)return c;var g,y;if("object"!=typeof c)return c;if(t(c,n))g=new n;else if(t(c,r))g=new r;else if(t(c,i))g=new i((function(t,e){c.then((function(e){t(a(e,v-1))}),(function(t){e(a(t,v-1))}))}));else if(o.__isArray(c))g=[];else if(o.__isRegExp(c))g=new RegExp(c.source,s(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(o.__isDate(c))g=new Date(c.getTime());else{if(p&&e.isBuffer(c))return g=e.allocUnsafe?e.allocUnsafe(c.length):new e(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):void 0===l?(y=Object.getPrototypeOf(c),g=Object.create(y)):(g=Object.create(l),y=l)}if(u){var m=h.indexOf(c);if(-1!=m)return d[m];h.push(c),d.push(g)}for(var b in t(c,n)&&c.forEach((function(t,e){var n=a(e,v-1),r=a(t,v-1);g.set(n,r)})),t(c,r)&&c.forEach((function(t){var e=a(t,v-1);g.add(e)})),c){var w;y&&(w=Object.getOwnPropertyDescriptor(y,b)),w&&null==w.set||(g[b]=a(c[b],v-1))}if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(c);for(b=0;b<_.length;b++){var E=_[b];(!(x=Object.getOwnPropertyDescriptor(c,E))||x.enumerable||f)&&(g[E]=a(c[E],v-1),x.enumerable||Object.defineProperty(g,E,{enumerable:!1}))}}if(f){var O=Object.getOwnPropertyNames(c);for(b=0;b<O.length;b++){var x,A=O[b];(x=Object.getOwnPropertyDescriptor(c,A))&&x.enumerable||(g[A]=a(c[A],v-1),Object.defineProperty(g,A,{enumerable:!1}))}}return g}(a,c)}function a(t){return Object.prototype.toString.call(t)}function s(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=a,o.__isDate=function(t){return"object"==typeof t&&"[object Date]"===a(t)},o.__isArray=function(t){return"object"==typeof t&&"[object Array]"===a(t)},o.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===a(t)},o.__getRegExpFlags=s,o}();t.exports&&(t.exports=n)}).call(this,n(20).Buffer)},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(47),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(15))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,c={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},h.clearImmediate=d}function d(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(15),n(16))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=l(n(14)),a=n(49),s=l(n(13)),u=n(50),c=l(n(22));function l(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){return(0,u.JSONPath)({path:e,json:t,wrap:!1})}var d=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var a in f(this,t),this.factMap=new Map(e),this.factResultsCache=new Map,this.allowUndefinedFacts=Boolean(i.allowUndefinedFacts),this.pathResolver=i.pathResolver||h,this.events={success:[],failure:[]},this.ruleResults=[],n){var u=void 0;u=n[a]instanceof o.default?n[a]:new o.default(a,n[a]),this._addConstantFact(u),(0,s.default)("almanac::constructor initialized runtime fact:"+u.id+" with "+u.value+"<"+r(u.value)+">")}}return i(t,[{key:"addEvent",value:function(t,e){if(!e)throw new Error('outcome required: "success" | "failure"]');this.events[e].push(t)}},{key:"getEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t?this.events[t]:this.events.success.concat(this.events.failure)}},{key:"addResult",value:function(t){this.ruleResults.push(t)}},{key:"getResults",value:function(){return this.ruleResults}},{key:"_getFact",value:function(t){return this.factMap.get(t)}},{key:"_addConstantFact",value:function(t){this.factMap.set(t.id,t),this._setFactValue(t,{},t.value)}},{key:"_setFactValue",value:function(t,e,n){var r=t.getCacheKey(e),i=Promise.resolve(n);return r&&this.factResultsCache.set(r,i),i}},{key:"addRuntimeFact",value:function(t,e){(0,s.default)("almanac::addRuntimeFact id:"+t);var n=new o.default(t,e);return this._addConstantFact(n)}},{key:"factValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=void 0,u=this._getFact(t);if(void 0===u)return this.allowUndefinedFacts?Promise.resolve(void 0):Promise.reject(new a.UndefinedFactError("Undefined fact: "+t));if(u.isConstant())o=Promise.resolve(u.calculate(n,this));else{var l=u.getCacheKey(n),f=l&&this.factResultsCache.get(l);f?(o=Promise.resolve(f),(0,s.default)("almanac::factValue cache hit for fact:"+t)):((0,s.default)("almanac::factValue cache miss for fact:"+t+"; calculating"),o=this._setFactValue(u,n,u.calculate(n,this)))}return i?((0,s.default)("condition::evaluate extracting object property "+i),o.then((function(t){if((0,c.default)(t)){var n=e.pathResolver(t,i);return(0,s.default)("condition::evaluate extracting object property "+i+", received: "+JSON.stringify(n)),n}return(0,s.default)("condition::evaluate could not compute object path("+i+") of non-object: "+t+" <"+(void 0===t?"undefined":r(t))+">; continuing with "+t),t}))):o}}]),t}();e.default=d},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}Object.defineProperty(e,"__esModule",{value:!0});e.UndefinedFactError=function(t){function e(){var t;r(this,e);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=i(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o)));return s.code="UNDEFINED_FACT",s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Error),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function s(t,e,n){return(s=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function u(t){var e="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return s(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,t)})(t)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.r(e),n.d(e,"JSONPath",(function(){return y}));var d=Object.prototype.hasOwnProperty;function p(t,e){return(t=t.slice()).push(e),t}function v(t,e){return(e=e.slice()).unshift(t),e}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(s,t);var e,n,r=(e=s,n=a(),function(){var t,r=i(e);if(n){var o=i(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return c(this,t)});function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this,'JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)')).avoidNew=!0,e.value=t,e.name="NewError",e}return s}(u(Error));function y(t,e,n,i,o){if(!(this instanceof y))try{return new y(t,e,n,i,o)}catch(t){if(!t.avoidNew)throw t;return t.value}"string"==typeof t&&(o=i,i=n,n=e,e=t,t=null);var a=t&&"object"===r(t);if(t=t||{},this.json=t.json||n,this.path=t.path||e,this.resultType=t.resultType||"value",this.flatten=t.flatten||!1,this.wrap=!d.call(t,"wrap")||t.wrap,this.sandbox=t.sandbox||{},this.preventEval=t.preventEval||!1,this.parent=t.parent||null,this.parentProperty=t.parentProperty||null,this.callback=t.callback||i||null,this.otherTypeCallback=t.otherTypeCallback||o||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},!1!==t.autostart){var s={path:a?t.path:e};a?"json"in t&&(s.json=t.json):s.json=n;var u=this.evaluate(s);if(!u||"object"!==r(u))throw new g(u);return u}}y.prototype.evaluate=function(t,e,n,i){var o=this,a=this.parent,s=this.parentProperty,u=this.flatten,c=this.wrap;if(this.currResultType=this.resultType,this.currPreventEval=this.preventEval,this.currSandbox=this.sandbox,n=n||this.callback,this.currOtherTypeCallback=i||this.otherTypeCallback,e=e||this.json,(t=t||this.path)&&"object"===r(t)&&!Array.isArray(t)){if(!t.path&&""!==t.path)throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!d.call(t,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');e=t.json,u=d.call(t,"flatten")?t.flatten:u,this.currResultType=d.call(t,"resultType")?t.resultType:this.currResultType,this.currSandbox=d.call(t,"sandbox")?t.sandbox:this.currSandbox,c=d.call(t,"wrap")?t.wrap:c,this.currPreventEval=d.call(t,"preventEval")?t.preventEval:this.currPreventEval,n=d.call(t,"callback")?t.callback:n,this.currOtherTypeCallback=d.call(t,"otherTypeCallback")?t.otherTypeCallback:this.currOtherTypeCallback,a=d.call(t,"parent")?t.parent:a,s=d.call(t,"parentProperty")?t.parentProperty:s,t=t.path}if(a=a||null,s=s||null,Array.isArray(t)&&(t=y.toPathString(t)),(t||""===t)&&e){var l=y.toPathArray(t);"$"===l[0]&&l.length>1&&l.shift(),this._hasParentSelector=null;var f=this._trace(l,e,["$"],a,s,n).filter((function(t){return t&&!t.isParentSelector}));return f.length?c||1!==f.length||f[0].hasArrExpr?f.reduce((function(t,e){var n=o._getPreferredOutput(e);return u&&Array.isArray(n)?t=t.concat(n):t.push(n),t}),[]):this._getPreferredOutput(f[0]):c?[]:void 0}},y.prototype._getPreferredOutput=function(t){var e=this.currResultType;switch(e){case"all":var n=Array.isArray(t.path)?t.path:y.toPathArray(t.path);return t.pointer=y.toPointer(n),t.path="string"==typeof t.path?t.path:y.toPathString(t.path),t;case"value":case"parent":case"parentProperty":return t[e];case"path":return y.toPathString(t[e]);case"pointer":return y.toPointer(t.path);default:throw new TypeError("Unknown result type")}},y.prototype._handleCallback=function(t,e,n){if(e){var r=this._getPreferredOutput(t);t.path="string"==typeof t.path?t.path:y.toPathString(t.path),e(r,n,t)}},y.prototype._trace=function(t,e,n,i,o,a,s,u){var c,l=this;if(!t.length)return c={path:n,value:e,parent:i,parentProperty:o,hasArrExpr:s},this._handleCallback(c,a,"value"),c;var h=t[0],g=t.slice(1),y=[];function m(t){Array.isArray(t)?t.forEach((function(t){y.push(t)})):y.push(t)}if(("string"!=typeof h||u)&&e&&d.call(e,h))m(this._trace(g,e[h],p(n,h),e,h,a,s));else if("*"===h)this._walk(h,g,e,n,i,o,a,(function(t,e,n,r,i,o,a,s){m(l._trace(v(t,n),r,i,o,a,s,!0,!0))}));else if(".."===h)m(this._trace(g,e,n,i,o,a,s)),this._walk(h,g,e,n,i,o,a,(function(t,e,n,i,o,a,s,u){"object"===r(i[t])&&m(l._trace(v(e,n),i[t],p(o,t),i,t,u,!0))}));else{if("^"===h)return this._hasParentSelector=!0,{path:n.slice(0,-1),expr:g,isParentSelector:!0};if("~"===h)return c={path:p(n,h),value:o,parent:i,parentProperty:null},this._handleCallback(c,a,"property"),c;if("$"===h)m(this._trace(g,e,n,null,null,a,s));else if(/^(\x2D?[0-9]*):(\x2D?[0-9]*):?([0-9]*)$/.test(h))m(this._slice(h,g,e,n,i,o,a));else if(0===h.indexOf("?(")){if(this.currPreventEval)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");this._walk(h,g,e,n,i,o,a,(function(t,e,n,r,i,o,a,s){l._eval(e.replace(/^\?\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)\)$/,"$1"),r[t],t,i,o,a)&&m(l._trace(v(t,n),r,i,o,a,s,!0))}))}else if("("===h[0]){if(this.currPreventEval)throw new Error("Eval [(expr)] prevented in JSONPath expression.");m(this._trace(v(this._eval(h,e,n[n.length-1],n.slice(0,-1),i,o),g),e,n,i,o,a,s))}else if("@"===h[0]){var b=!1,w=h.slice(1,-2);switch(w){case"scalar":e&&["object","function"].includes(r(e))||(b=!0);break;case"boolean":case"string":case"undefined":case"function":r(e)===w&&(b=!0);break;case"integer":!Number.isFinite(e)||e%1||(b=!0);break;case"number":Number.isFinite(e)&&(b=!0);break;case"nonFinite":"number"!=typeof e||Number.isFinite(e)||(b=!0);break;case"object":e&&r(e)===w&&(b=!0);break;case"array":Array.isArray(e)&&(b=!0);break;case"other":b=this.currOtherTypeCallback(e,n,i,o);break;case"null":null===e&&(b=!0);break;default:throw new TypeError("Unknown value type "+w)}if(b)return c={path:n,value:e,parent:i,parentProperty:o},this._handleCallback(c,a,"value"),c}else if("`"===h[0]&&e&&d.call(e,h.slice(1))){var _=h.slice(1);m(this._trace(g,e[_],p(n,_),e,_,a,s,!0))}else if(h.includes(",")){var E,O=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(h.split(","));try{for(O.s();!(E=O.n()).done;){var x=E.value;m(this._trace(v(x,g),e,n,i,o,a,!0))}}catch(t){O.e(t)}finally{O.f()}}else!u&&e&&d.call(e,h)&&m(this._trace(g,e[h],p(n,h),e,h,a,s,!0))}if(this._hasParentSelector)for(var A=0;A<y.length;A++){var R=y[A];if(R&&R.isParentSelector){var k=this._trace(R.expr,e,R.path,i,o,a,s);if(Array.isArray(k)){y[A]=k[0];for(var P=k.length,S=1;S<P;S++)A++,y.splice(A,0,k[S])}else y[A]=k}}return y},y.prototype._walk=function(t,e,n,i,o,a,s,u){if(Array.isArray(n))for(var c=n.length,l=0;l<c;l++)u(l,t,e,n,i,o,a,s);else n&&"object"===r(n)&&Object.keys(n).forEach((function(r){u(r,t,e,n,i,o,a,s)}))},y.prototype._slice=function(t,e,n,r,i,o,a){if(Array.isArray(n)){var s=n.length,u=t.split(":"),c=u[2]&&Number.parseInt(u[2])||1,l=u[0]&&Number.parseInt(u[0])||0,f=u[1]&&Number.parseInt(u[1])||s;l=l<0?Math.max(0,l+s):Math.min(s,l),f=f<0?Math.max(0,f+s):Math.min(s,f);for(var h=[],d=l;d<f;d+=c){this._trace(v(d,e),n,r,i,o,a,!0).forEach((function(t){h.push(t)}))}return h}},y.prototype._eval=function(t,e,n,r,i,o){t.includes("@parentProperty")&&(this.currSandbox._$_parentProperty=o,t=t.replace(/@parentProperty/g,"_$_parentProperty")),t.includes("@parent")&&(this.currSandbox._$_parent=i,t=t.replace(/@parent/g,"_$_parent")),t.includes("@property")&&(this.currSandbox._$_property=n,t=t.replace(/@property/g,"_$_property")),t.includes("@path")&&(this.currSandbox._$_path=y.toPathString(r.concat([n])),t=t.replace(/@path/g,"_$_path")),t.includes("@root")&&(this.currSandbox._$_root=this.json,t=t.replace(/@root/g,"_$_root")),/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/.test(t)&&(this.currSandbox._$_v=e,t=t.replace(/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/g,"_$_v$1"));try{return this.vm.runInNewContext(t,this.currSandbox)}catch(e){throw console.log(e),new Error("jsonPath: "+e.message+": "+t)}},y.cache={},y.toPathString=function(t){for(var e=t,n=e.length,r="$",i=1;i<n;i++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(e[i])||(r+=/^[\*0-9]+$/.test(e[i])?"["+e[i]+"]":"['"+e[i]+"']");return r},y.toPointer=function(t){for(var e=t,n=e.length,r="",i=1;i<n;i++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(e[i])||(r+="/"+e[i].toString().replace(/~/g,"~0").replace(/\//g,"~1"));return r},y.toPathArray=function(t){var e=y.cache;if(e[t])return e[t].concat();var n=[],r=t.replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/g,";$&;").replace(/['\[](\??\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\))['\]]/g,(function(t,e){return"[#"+(n.push(e)-1)+"]"})).replace(/\[["']((?:(?!['\]])[\s\S])*)["']\]/g,(function(t,e){return"['"+e.replace(/\./g,"%@%").replace(/~/g,"%%@@%%")+"']"})).replace(/~/g,";~;").replace(/["']?\.["']?(?!(?:(?!\[)[\s\S])*\])|\[["']?/g,";").replace(/%@%/g,".").replace(/%%@@%%/g,"~").replace(/(?:;)?(\^+)(?:;)?/g,(function(t,e){return";"+e.split("").join(";")+";"})).replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").split(";").map((function(t){var e=t.match(/#([0-9]+)/);return e&&e[1]?n[e[1]]:t}));return e[t]=r,e[t].concat()};y.prototype.vm={runInNewContext:function(t,e){var n=Object.keys(e),r=[];!function(t,e,n){for(var r=t.length,i=0;i<r;i++){n(t[i])&&e.push(t.splice(i--,1)[0])}}(n,r,(function(t){return"function"==typeof e[t]}));var i=n.map((function(t,n){return e[t]})),o=r.reduce((function(t,n){var r=e[n].toString();return/function/.test(r)||(r="function "+r),"var "+n+"="+r+";"+t}),"");/(["'])use strict\1/.test(t=o+t)||n.includes("arguments")||(t="var arguments = undefined;"+t);var a=(t=t.replace(/;[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*$/,"")).lastIndexOf(";"),u=a>-1?t.slice(0,a+1)+" return "+t.slice(a+1):" return "+t;return s(Function,l(n).concat([u])).apply(void 0,l(i))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(17),o=(r=i)&&r.__esModule?r:{default:r};var a=[];function s(t){return"NaN"!==Number.parseFloat(t).toString()}a.push(new o.default("equal",(function(t,e){return t===e}))),a.push(new o.default("notEqual",(function(t,e){return t!==e}))),a.push(new o.default("in",(function(t,e){return e.indexOf(t)>-1}))),a.push(new o.default("notIn",(function(t,e){return-1===e.indexOf(t)}))),a.push(new o.default("contains",(function(t,e){return t.indexOf(e)>-1}),Array.isArray)),a.push(new o.default("doesNotContain",(function(t,e){return-1===t.indexOf(e)}),Array.isArray)),a.push(new o.default("lessThan",(function(t,e){return t<e}),s)),a.push(new o.default("lessThanInclusive",(function(t,e){return t<=e}),s)),a.push(new o.default("greaterThan",(function(t,e){return t>e}),s)),a.push(new o.default("greaterThanInclusive",(function(t,e){return t>=e}),s)),e.default=a},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"init",(function(){return vt}));var i={};n.r(i),n.d(i,"bindEvents",(function(){return gt}));var o={};n.r(o),n.d(o,"overwriteConfig",(function(){return yt}));var a={};n.r(a),n.d(a,"bindEvents",(function(){return Ot}));var s={};n.r(s),n.d(s,"init",(function(){return At}));var u={};n.r(u),n.d(u,"send",(function(){return Pt})),n.d(u,"sendToPrimary",(function(){return St})),n.d(u,"output",(function(){return Tt})),n.d(u,"input",(function(){return jt})),n.d(u,"buildAdapter",(function(){return Ct}));var c={};n.r(c),n.d(c,"bindSharedEvents",(function(){return Dt}));var l={};n.r(l),n.d(l,"privateApi",(function(){return u})),n.d(l,"eventsApi",(function(){return c}));var f={};n.r(f),n.d(f,"bindEvents",(function(){return Ut}));var h={};n.r(h),n.d(h,"bindEvents",(function(){return Yt}));var d={};n.r(d),n.d(d,"runDetection",(function(){return Ht})),n.d(d,"createElementWithClasses",(function(){return Wt})),n.d(d,"clean",(function(){return Xt}));var p={};n.r(p),n.d(p,"init",(function(){return Zt}));var v={};n.r(v),n.d(v,"bindEvents",(function(){return ne}));var g={};n.r(g),n.d(g,"runDetection",(function(){return re})),n.d(g,"loadScript",(function(){return oe}));var y={};n.r(y),n.d(y,"init",(function(){return ae}));var m={};n.r(m),n.d(m,"bindEvents",(function(){return le}));var b={};n.r(b),n.d(b,"runDetection",(function(){return fe})),n.d(b,"fetchFile",(function(){return de}));var w={};n.r(w),n.d(w,"init",(function(){return pe}));var _={};n.r(_),n.d(_,"init",(function(){return me}));var E={};n.r(E),n.d(E,"bindEvents",(function(){return Ee}));var O={};n.r(O),n.d(O,"sendSsaiReport",(function(){return Oe}));var x={};n.r(x),n.d(x,"init",(function(){return xe}));var A={};n.r(A),n.d(A,"bindEvents",(function(){return He}));var R={};n.r(R),n.d(R,"init",(function(){return Ke}));var k={};n.r(k),n.d(k,"console",(function(){return We}));var P={};n.r(P),n.d(P,"bindEvents",(function(){return kn}));var S={};n.r(S),n.d(S,"init",(function(){return Sn}));var T={};n.r(T),n.d(T,"runRulesEngine",(function(){return Cn})),n.d(T,"mergeDeep",(function(){return In})),n.d(T,"isObject",(function(){return Ln})),n.d(T,"overwriteAdRequestParams",(function(){return Fn}));var j=n(10),C=n.n(j),D=n(24),I=n(1),L=n.n(I),F=n(2),M=n.n(F),N=n(0),B=n.n(N);function U(){this.event.emit({tags:["componentInitializing","event"]}),this.garbageCollectorInterval=setInterval(this.collectGarbage,1e4),this.bindEvents(),this.event.emit({tags:["componentInitialized","event"]})}function z(){this.listenersGroups.forEach((function(t){return null==t?void 0:t.public.disableListener()})),this.emissionID=0,this.listenerID=0,this.groupID=0,this.emissions={},this.emissionsTags={},this.listenersGroups=[],this.positiveLabels={},this.negativeLabels={},this.activeEmissionsCount=0,this.resetRequested=!1}function q(){var t=this.emissionsTags.garbage;if(null!=t&&t.length){for(var e in t)delete this.emissions[t[e]];Object.values(this.emissionsTags).forEach((function(e){e.reduce((function(e,n,r){return t.includes(n)&&e.push(r),e}),[]).forEach((function(t){return delete e[t]}))})),this.emissionsTags.garbage=[]}}function Y(){var t=this;this.event.listen({prio:40,labels:{l1:["sdkDestroy"]},action:function(){t.activeEmissionsCount>0?t.resetRequested=!0:t.reset(),clearInterval(t.garbageCollectorInterval)}})}function G(t,e){var n,r=this;t.tags=Array.isArray(t.tags)?t.tags:t.tags.split(",");var i=t.ghost,o=t.async,a=(null==e?void 0:e.localPositiveLabels)||this.positiveLabels,s=t.emissionID,u=[];i||(Object.prototype.hasOwnProperty.call(t,"responses")||(t.responses=void 0),void 0===t.resolve&&(t.resolve=function(e,n){var r;null!==(r=t.responses)&&void 0!==r||(t.responses={});var i=null!=n?n:Object.keys(t.responses).length;t.responses[i]=e}),void 0===t.reject&&(t.reject=function(){}),o&&(n=new Promise((function(e,n){var r=t.resolve,i=t.reject;t.resolve=function(t){e(t),r(t)},t.reject=function(t){n(t),i(t)}})),t.promise=n),s=++this.emissionID,t.emissionID=s,this.emissions[s]=t,void 0===t.date&&(t.date=Date.now()),void 0===t.alias&&(t.alias=""+s),void 0===t.fromProxy&&t.tags.push("all"));for(var c={},l=0;l<t.tags.length;l++){var f=t.tags[l];if(i||(Object.prototype.hasOwnProperty.call(this.emissionsTags,f)||(this.emissionsTags[f]=[]),this.emissionsTags[f].push(s)),Object.prototype.hasOwnProperty.call(a,f))for(var h=0;h<a[f].length;h++){var d=a[f][h];if(void 0!==d&&(void 0===c[d.listenerID]&&(d.tmpTags=d.copyTags,c[d.listenerID]=!0),d.tmpTags>0&&void 0!==d.tags[f]&&d.tmpTags--,0===d.tmpTags)){d.tmpTags=d.copyTags;var p=!1;for(var v in d.negativeTags){for(var g in t.tags)if(t.tags[g]===d.negativeTags[v]&&(p=!0),p)break;if(p)break}if(p||!d.group)continue;if(d.group.tmpLabels[d.labelName].push(t),d.group.data.rule(d.group.tmpLabels)){var y={};for(var m in d.group.tmpLabels)y[m]=d.group.tmpLabels[m],d.group.tmpLabels[m]=[];var b=100-d.group.data.prio;Array.isArray(u[b])||(u[b]=[]),u[b].push({tagData:d,emissions:y})}}}}return this.activeEmissionsCount++,u.forEach((function(t){t.forEach((function(t){var e=t.tagData.group,n=t.emissions;t.tagData.group&&t.tagData.group.resolver({getEmissions:function(){return n},getEmission:function(){for(var t in n){var e=n[t];if(e.length>0)return e[0]}},getEmissionByAlias:function(t){for(var e in n){var r=n[e][0];if(r.alias===t)return r}},disableListener:function(){var n=e.groupID;e.enabled=!1,e.removeIndex.positive.forEach((function(t){r.positiveLabels[t.tag][t.index]=void 0})),e.removeIndex.negative.forEach((function(t){r.negativeLabels[t.tag][t.index]=void 0})),r.listenersGroups[n]=void 0,delete t.tagData.group}},t.tagData.labelName)}))})),this.activeEmissionsCount--,this.resetRequested&&0===this.activeEmissionsCount&&this.reset(),o&&!i?n:t.responses}function J(t,e){var n,r=this;void 0===e&&(e={});var i=t.disableOn,o=t.enableOn;t.disableOn=void 0,t.enableOn=void 0;var a=!1;if(void 0!==i&&(i.action=function(){var t;null===(t=e.instance)||void 0===t||t.disableListener(),a=!0},this.public.listen(i)),void 0!==o&&(o.action=function(){e.instance||r.public.listen(t,e)},this.public.listen(o),a=!0),!a){var s=++this.groupID;void 0===t.rule&&(t.rule=function(t){for(var e in t)if(t[e].length>0)return!0;return!1}),void 0===t.alias&&(t.alias=""+s);var u={public:{disableListener:function(){u.enabled=!1,u.removeIndex.positive.forEach((function(t){r.positiveLabels[t.tag][t.index]=void 0})),u.removeIndex.negative.forEach((function(t){r.negativeLabels[t.tag][t.index]=void 0})),delete e.instance}},alias:t.alias,data:t,tmpLabels:{},emissions:[],matchedEmissions:[],listeners:[],removeIndex:{positive:[],negative:[]},enabled:!0};this.listenersGroups.push(u);var c,l=t.labels,f=t.async,h=!!t.history,d={},p={},v=[];for(var g in null!==(n=t.prio)&&void 0!==n||(t.prio=50),u.groupID=s,f?(void 0===t.action&&(t.action=function(){}),c=new Promise((function(e,n){u.resolver=function(){try{t.action.apply(t,arguments),e.apply(void 0,arguments)}catch(t){n(t)}}}))):u.resolver=function(){try{t.action.apply(t,arguments)}catch(t){r.public.emit({tags:["listenerActionError","event","error"],description:"Error while executing listener action",error:t,data:u.data})}},l){var y=void 0,m=l[g],b=Array.isArray(m)?m:m.split(","),w=++this.listenerID,_={group:u,listenerID:w,labelName:g,tags:{},negativeTags:[],tmpTags:0,copyTags:0};_.group.tmpLabels[g]=[];for(var E=function(t){var e=b[t],n="!"!==e[0];if(e=n?e:e.substring(1),h&&(void 0===y?y=Object.prototype.hasOwnProperty.call(r.emissionsTags,e)?r.emissionsTags[e]:[]:y.length>0&&(y=n?y.filter((function(t){var n,i;return null===(n=null===(i=r.emissionsTags[e])||void 0===i?void 0:i.includes(t))||void 0===n||n})):y.filter((function(t){var n,i;return null===(n=!(null!==(i=r.emissionsTags[e])&&void 0!==i&&i.includes(t)))||void 0===n||n})))),n){_.tags[e]=!0,_.tmpTags++,Object.prototype.hasOwnProperty.call(r.positiveLabels,e)||(r.positiveLabels[e]=[]);var i=r.positiveLabels[e].push(_)-1;u.removeIndex.positive.push({tag:e,index:i}),h&&(Object.prototype.hasOwnProperty.call(d,e)||(d[e]=[]),d[e].push(_))}else _.negativeTags.push(e)},O=0;O<b.length;O++)E(O);if(y&&y.length){var x,A=null===(x=y)||void 0===x?void 0:x.filter((function(t){return!v.includes(t)}));v=v.concat(A||[])}_.copyTags=_.tmpTags}if(v.length>0)switch(t.history){case"all":v.sort((function(t,e){return t-e})).forEach((function(t){var e=r.emissions[t];e.ghost=!0;var n={localNegativeLabels:p,localPositiveLabels:d};r.public.emit(e,n)}));break;case"first":var R=v[0],k=this.emissions[R];k.ghost=!0;var P={localNegativeLabels:p,localPositiveLabels:d};this.public.emit(k,P);break;case"last":var S=v[v.length-1],T=this.emissions[S];T.ghost=!0;var j={localNegativeLabels:p,localPositiveLabels:d};this.public.emit(T,j)}return e.instance=u.public,f?c:void 0}}function V(t){this.listenersGroups.forEach((function(e){e.alias===t&&e.public.disableListener()}))}function $(t){return this.emissions[t]}function H(t){for(var e in this.emissions)if(this.emissions[e].alias===t)return this.emissions[e]}function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){B()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function X(t){var e=this;return{reached:function(n,r){return e.public.reached(n,r,t)}}}function Z(t,e,n){var r,i=n&&n.name?n.name:"",o=[];i&&o.push(i);var a=t.split(":");1===a.length||(o=o.concat(a[1])),(o=[a[0]].concat(o)).push("emulation"),e=(null===(r=e)||void 0===r?void 0:r.object)||e;var s=this.public.emit({async:!0,tags:o.join(","),data:e});return{cleanUp:function(){},response:{fetch:function(){return s}}}}function Q(t){var e=!!t.history&&"all",n={};if(t.disableOnOneOf){var r=t.disableOnOneOf.reduce((function(t,e,n){var r=e.replace(":",",").split(",");return t["l"+(n+1)]=r,t}),{});n.disableOn={labels:r,history:"last"}}var i=t.prio,o="";t.exclude&&t.exclude.forEach((function(t){o+=(","+t).replace(/,?:/g,",").replace(/,/g,",!")}));var a=t.events.reduce((function(t,e,n){var r=(e+o).replace(":",",").split(",");return t["l"+(n+1)]=r,t}),{}),s={};return this.public.listen(W({history:e,labels:a,action:function(e){var n,r,i,o=e.getEmissions();for(var a in o)if(i=o[a][0])break;var s=i.tags[0],u=i.tags.slice(1,i.tags.length);u.pop();var c=(null===(n=i.data)||void 0===n?void 0:n.object)||i.data;c=(null===(r=i.data)||void 0===r?void 0:r.adObject)||c;var l={eventName:s,response:{set:i.resolve},tags:u,logId:i.alias,date:new Date(i.date),extra:{string:JSON.stringify(i.data),object:c}},f={disable:e.disableListener};t.action(l,f)},prio:i},n),s),{disable:function(){var t;return null===(t=s.instance)||void 0===t?void 0:t.disableListener()}}}function tt(t){var e=!!t.history&&"all",n={};if(t.disableOnOneOf){var r=t.disableOnOneOf.reduce((function(t,e,n){var r=e.replace(":",",").split(",");return t["l"+(n+1)]=r,t}),{});n.disableOn={labels:r,history:"last"}}var i=t.prio,o="";t.exclude&&t.exclude.forEach((function(t){o+=(","+t).replace(/,?:/g,",").replace(/,/g,",!")}));var a=t.events.reduce((function(t,e,n){var r=(e+o).replace(":",",").split(",");return t["l"+(n+1)]=r,t}),{});return this.public.listen(W({history:e,labels:a,action:function(e){var n={},r=e.getEmissions();for(var i in r){var o,a=r[i][0],s=a.tags[0],u=a.tags.slice(1,a.tags.length);n[s+":"+(u=u.filter((function(t){return["emulation","all"].indexOf(t)<0}))).join()]={eventName:s,tags:u,logId:a.alias,date:new Date(a.date),extra:{string:JSON.stringify(a.data),object:(null===(o=a.data)||void 0===o?void 0:o.object)||a.data}}}var c={disable:e.disableListener};e.disableListener(),t.action(n,c)},rule:function(t){for(var e in t)if(0===t[e].length)return!1;return!0},prio:i},n))}function et(t){var e=!!t.history&&"all",n={},r="";if(Array.isArray(t.tags)&&(r=","+t.tags.join(",")),t.disableOnOneOf){var i=t.disableOnOneOf.reduce((function(t,e,n){var r=e.replace(":",",").split(",");return t["l"+(n+1)]=r,t}),{});n.disableOn={labels:i,history:"last"}}var o=t.prio,a="";t.exclude&&t.exclude.forEach((function(t){a+=(","+t).replace(/,?:/g,",").replace(/,/g,",!")}));var s={l1:"all"+r+a};return this.public.listen(W({history:e,labels:s,action:function(e){var n,r=e.getEmissions().l1[0];try{n=r.tags[0]}catch(t){e.disableListener()}var i=r.tags.slice(1,r.tags.length);i.pop();var o={eventName:n,tags:i,logId:r.alias,date:new Date(r.date),extra:{string:JSON.stringify(r.data),object:r.data}},a={disable:e.disableListener};t.action(o,a)},prio:o},n))}function nt(t,e){return{response:{set:this.emissions[e].resolve}}}var rt=L()((function t(){M()(this,t)})),it=L()((function t(e){var n=this;return M()(this,t),B()(this,"emissionID",0),B()(this,"listenerID",0),B()(this,"groupID",0),B()(this,"emissions",{}),B()(this,"emissionsTags",{}),B()(this,"listenersGroups",[]),B()(this,"positiveLabels",{}),B()(this,"negativeLabels",{}),B()(this,"activeEmissionsCount",0),B()(this,"resetRequested",!1),B()(this,"garbageCollectorInterval",void 0),B()(this,"core",void 0),B()(this,"public",{name:"event",emit:G.bind(this),listen:J.bind(this),removeListeners:V.bind(this),getEmissionByID:$.bind(this),getEmissionByAlias:H.bind(this),emiter:X.bind(this),reached:Z.bind(this),onOneOf:Q.bind(this),onSequence:tt.bind(this),onAll:et.bind(this),getOccurrenceByEventNameAndLogId:nt.bind(this)}),B()(this,"init",U.bind(this)),B()(this,"bindEvents",Y.bind(this)),B()(this,"reset",z.bind(this)),B()(this,"collectGarbage",q.bind(this)),this.public,new rt,this.core=e,this.event=this.public,this.event.listen({history:"last",labels:{l1:["componentRegistered","event"]},action:function(t){setTimeout(n.init,0),t.disableListener()}}),this.public})),ot=n(3),at=n.n(ot),st=n(7),ut=n.n(st),ct=n(5),lt=n.n(ct),ft=n(4),ht=n.n(ft),dt=L()((function t(e,n,r,i){var o=this;if(M()(this,t),B()(this,"componentName",void 0),B()(this,"core",void 0),B()(this,"event",void 0),this.constructor===t)throw new Error("Abstract classes can't be instantiated.");this.core=e,this.event=this.core.getComponent("event"),this.componentName=n,Object.values(r).forEach((function(t){return Object.entries(t).forEach((function(t){o[t[0]]=t[1].bind(o)}))}));var a=this.init;this.init=function(){var t,e;o.event.emit({tags:["componentInitializing",n]});for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];null==a||a.apply(void 0,i),null===(t=o.bindSharedEvents)||void 0===t||t.call(o),null===(e=o.bindEvents)||void 0===e||e.call(o),o.event.emit({tags:["componentInitialized",n]})},i&&this.event.emit({tags:["registerEventsMap"],data:{events:i,componentName:n}})})),pt=function(t){if("number"==typeof t){var e=t,n="",r=Math.floor(e/60/60/1e3);e=t-60*r*60*1e3;var i=Math.floor(e/60/1e3);e=Math.floor(e-60*i*1e3);var o=Math.floor(e/1e3),a=e=Math.floor(e-1e3*o);return 1===r.toString().length&&(r="0"+r),n+=r+":",1===i.toString().length&&(i="0"+i),n+=i+":",1===o.toString().length&&(o="0"+o),n+=o+"+",n+=a+"ms"}};function vt(){var t,e,n,r,i,o,a,s;this.event.emit({tags:["startedAt","core"],data:(t=new Date,e=("0"+t.getDate()).slice(-2),n=("0"+(t.getMonth()+1)).slice(-2),r=t.getFullYear(),i=t.toLocaleTimeString(),o=t.getMilliseconds(),"".concat(e,":").concat(n,":").concat(r," ").concat(i," ").concat(o,"ms"))});try{var u;a=null!==(u=JSON.parse(localStorage.getItem("forceSdkConfig")))&&void 0!==u?u:{},this.public.data=C.a.all([this.public.data,a])}catch(t){}try{var c;s=null!==(c=JSON.parse(sessionStorage.getItem("forceSdkConfig")))&&void 0!==c?c:{},this.public.data=C.a.all([this.public.data,s])}catch(t){}this.event.emit({alias:"sdkConfig",tags:["configReady","config"],data:this.public.data})}function gt(){var t=this;this.event.listen({history:"all",labels:{l1:["configOverwritingData","configModificator"]},action:function(e){var n;t.advancedConfig=null===(n=e.getEmission())||void 0===n?void 0:n.data,t.overwriteConfig(),t.event.emit({alias:"sdkConfig",tags:["finalConfigReady","config"],data:t.public.data})}}),this.event.listen({history:"all",labels:{l1:["missingRulesData","configModificator"]},action:function(){t.event.emit({alias:"sdkConfig",tags:["finalConfigReady","config"],data:t.public.data})}})}function yt(){var t,e;null!==(t=this.advancedConfig)&&void 0!==t&&t.breakConfig&&(this.public.data.break=C.a.all([this.public.data.break,this.advancedConfig.breakConfig])),null!==(e=this.advancedConfig)&&void 0!==e&&e.mainConfig&&(this.public.data=C.a.all([this.public.data,this.advancedConfig.mainConfig]))}var mt=[r,i,o];function bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var wt=function(t){ut()(n,t);var e=bt(n);function n(t,r){var i;return M()(this,n),i=e.call(this,t,r,mt),B()(at()(i),"advancedConfig",void 0),B()(at()(i),"public",{data:{}}),i.event.listen({history:"all",labels:{l1:["componentRegistered","config"],l2:["packageConfig"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(t){var e=t.getEmissions().l2[0];i.public.data=e.data,setTimeout(i.init,0),t.disableListener()}}),lt()(i,i.public)}return L()(n)}(dt),_t=n(9),Et=n.n(_t);function Ot(){var t=this;this.event.listen({history:"all",labels:{l1:["detectionState","adblockDetector"]},action:function(e){var n=e.getEmission().data;t.send({path:"adblockDetector.onStateChange",params:[n]})}}),this.event.listen({history:"all",enableOn:{labels:{l1:["componentInitialized","adblockDetector"]}},labels:{l1:["adblockDetector.getCurrentState","adapterCall"]},action:function(e){var n,r=null===(n=t.event.emit({tags:["getDetectionState","adblockDetector"]}))||void 0===n?void 0:n[0];e.getEmission().resolve(r)}}),this.event.listen({labels:{l1:["ssai.sendReportRequest","adapterCall"]},action:function(e){t.event.emit({tags:["sendReport","ssai"],data:e.getEmission().data})}})}var xt=n(25);function At(){this.map=xt,this.event.emit({alias:"initializationData",tags:["initializationData"],data:{playerData:{playRequestTime:Date.now()}}})}var Rt=n(12),kt=n.n(Rt);function Pt(t){var e=["adapterCall","output",t.path],n=t.path.split("."),r=kt()(n,2),i=r[0],o=r[1],a=this.map[i][o].isAsync,s=this.event.emit({tags:e,data:t,async:a});return a?s:s.adapterResponse}function St(t){return t.adapters=["primary"],this.send(t).primary}function Tt(t,e,n,r){var i=this;if(r||(r=Object.keys(this.adapters)),0!==Object.keys(this.adapters).length)try{var o,a,s={},u=n.split("."),c=kt()(u,2),l=c[0],f=c[1],h=null===(o=this.map[l])||void 0===o||null===(a=o[f])||void 0===a?void 0:a.allowedAdapters;return r.forEach((function(e){var n;h&&!h.includes(e)||(s[e]=(n=i.adapters[e][l])[f].apply(n,Et()(t)))})),s}catch(i){this.event.emit({tags:["errorWhileExecutingAdapterMethod"],description:"Can't execute adapter method",data:{params:t,isAsync:e,callPath:n,adapters:r},error:i})}else this.event.emit({tags:["noAdaptersFound","error"],description:"Can't execute adapter method",data:{params:t,isAsync:e,callPath:n,adapters:r}})}function jt(t,e,n,r){var i={};i.tags=["".concat(t,".").concat(e),n,"adapterCall","input"],i.description="Adapter incomming call",i.async=r,i.adapters=[n];for(var o=arguments.length,a=new Array(o>4?o-4:0),s=4;s<o;s++)a[s-4]=arguments[s];a.length>0&&(i.data=a);var u=this.event.emit(i);return r?u:null==u?void 0:u[0]}function Ct(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.entries(t).forEach((function(t){var i=kt()(t,2),o=i[0],a=i[1];Object.entries(a).forEach((function(t){var i,a,s,u=t[0],c=t[1],l=c.implementation,f=c.isAsync,h=c.allowedAdapters;if(!h||h.includes(e))switch(null!==(i=r[o])&&void 0!==i||(r[o]={}),l){case"internal":r[o][u]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.input.apply(n,[o,u,e,f].concat(r))};break;case"external":null!==(s=(a=r[o])[u])&&void 0!==s||(a[u]=function(){})}}))})),r}function Dt(){var t=this;this.event.listen({labels:{l1:["requestNewAdapter"]},action:function(e){var n=e.getEmission(),r=n.data,i=r.id,o=r.adapter;if(void 0!==i){var a=t.buildAdapter(t.map,i,o);void 0===t.adapters[i]?(t.adapters[i]=a,a.id=i,n.resolve(a),setTimeout((function(){return t.event.emit({tags:["sdk.onReady","adapterCall","output"],data:{adapters:[i],path:"sdk.onReady"}})}),0)):t.event.emit({tags:["adapterIdConflict","error"],data:i})}}}),this.event.listen({labels:{l1:["adapterCall","output"]},action:function(e){var n,r=e.getEmission(),i=r.async,o=void 0!==i&&i,a=r.data,s=a.params,u=void 0===s?[]:s,c=a.adapters,l=void 0===c?void 0:c,f=a.path,h=null!==(n=t.output(u,o,f,l))&&void 0!==n?n:{};o?Promise.all(Object.values(h)).then((function(t){return r.resolve(t,"adapterResponse")})):r.resolve(h,"adapterResponse")}}),this.event.listen({prio:60,labels:{l1:["initializationData"]},action:function(t){var e=JSON.parse(localStorage.getItem("forceSdkConfig")),n=null==e?void 0:e.vastUrl;n&&(t.getEmissionByAlias("initializationData").data.adsLoaderConfig.adServerUrl=n)}})}var It=[a,s].concat(Et()(Object.values(l)));function Lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var Ft=function(t){ut()(n,t);var e=Lt(n);function n(t,r){var i;return M()(this,n),i=e.call(this,t,r,It),B()(at()(i),"adapters",{}),B()(at()(i),"defaultId","utils"),B()(at()(i),"map",void 0),i.init(),lt()(i,void 0)}return L()(n)}(dt),Mt="pending",Nt="detected",Bt="notDetected";function Ut(){var t=this;this.event.listen({labels:{l1:["getDetectionState","adblockDetector"]},action:function(e){e.getEmission().resolve(t.state)}}),this.event.listen({labels:{l1:["detectionCompleted","cssClasses","adblockDetector"],l2:["detectionCompleted","loadScript","advert","adblockDetector"],l3:["detectionCompleted","fetchFile","gemius","adblockDetector"]},rule:function(t){return t.l1.length&&t.l2.length&&t.l3.length},action:function(e){var n=e.getEmissions();Object.values(n).map((function(t){return null==t?void 0:t[0].data})).includes(Nt)?(t.state=Nt,t.event.emit({tags:["detectionState","adblockDetector","warning","!noSentry"],data:t.state})):(t.state=Bt,t.event.emit({tags:["detectionState","adblockDetector"],data:t.state}))}})}var zt=n(26),qt=L()((function t(e,n){var r=this;if(M()(this,t),B()(this,"core",void 0),B()(this,"event",void 0),this.constructor===Object)throw new Error("Abstract classes can't be instantiated.");this.core=e,this.event=this.core.getComponent("event"),Object.values(n).forEach((function(t){return Object.entries(t).forEach((function(t){r[t[0]]=t[1].bind(r)}))}));var i=this.init;this.init=function(){for(var t,e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];null==i||i.apply(void 0,o),null===(t=r.bindSharedEvents)||void 0===t||t.call(r),null===(e=r.bindEvents)||void 0===e||e.call(r)}}));function Yt(){var t=this;this.event.listen({labels:{l1:["getDetectionState","cssClasses","adblockDetector"]},action:function(e){e.getEmission().resolve(t.state)}}),this.event.listen({labels:{l1:["sdkDestroy"]},action:function(){return t.clean()}})}var Gt=n(8),Jt=n.n(Gt),Vt=n(6),$t=n.n(Vt);function Ht(){return Kt.apply(this,arguments)}function Kt(){return(Kt=Jt()($t.a.mark((function t(){return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.createElementWithClasses();case 3:this.state=Bt,this.event.emit({tags:["detectionCompleted","cssClasses","adblockDetector"],data:Bt}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),this.state=Nt,this.event.emit({tags:["detectionCompleted","cssClasses","adblockDetector"],data:Nt});case 11:this.clean();case 12:case"end":return t.stop()}}),t,this,[[0,7]])})))).apply(this,arguments)}function Wt(){var t=this,e=this.config.data.adblockDetector.cssClasses,n=e.classesArray,r=e.count,i=Et()(n).sort((function(){return.5-Math.random()})).slice(0,r);return new Promise((function(e,n){var r;return t.baitElement=document.createElement("div"),(r=t.baitElement.classList).add.apply(r,Et()(i)),t.baitElement.style.position="absolute",t.baitElement.style.top=0,t.baitElement.style.left=0,t.baitElement.style.opacity=0,t.baitElement.style.width=0,t.baitElement.style.height=0,t.baitElement.textContent="adsbygoogle prebid adocean ado",document.body.append(t.baitElement),"none"!==window.getComputedStyle(t.baitElement).display?e():n(new Error("Adblock detected!"))}))}function Xt(){var t,e;null===(t=this.baitElement)||void 0===t||null===(e=t.parentNode)||void 0===e||e.removeChild(this.baitElement),this.baitElement=null}function Zt(){this.config=this.core.getComponent("config"),this.runDetection()}var Qt=[h,p,d];function te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var ee=function(t){ut()(n,t);var e=te(n);function n(t){var r;return M()(this,n),r=e.call(this,t,Qt),B()(at()(r),"baitElement",void 0),B()(at()(r),"config",void 0),B()(at()(r),"state",Mt),r.event.listen({history:"all",labels:{l1:["componentInitialized","config"]},action:function(){return setTimeout(r.init,0)}}),lt()(r,{})}return L()(n)}(qt);function ne(){var t=this;this.event.listen({labels:{l1:["getDetectionState","loadScript",this.identifier,"adblockDetector"]},action:function(e){e.getEmission().resolve(t.state)}})}function re(){return ie.apply(this,arguments)}function ie(){return(ie=Jt()($t.a.mark((function t(){return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.loadScript();case 3:this.state=Bt,this.event.emit({tags:["detectionCompleted","loadScript",this.identifier,"adblockDetector"],data:Bt}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),this.state=Nt,this.event.emit({tags:["detectionCompleted","loadScript",this.identifier,"adblockDetector"],data:Nt});case 11:case"end":return t.stop()}}),t,this,[[0,7]])})))).apply(this,arguments)}function oe(){var t=this;return new Promise((function(e,n){var r=document.createElement("script");document.head.appendChild(r),r.onload=function(){return e()},r.onerror=function(){return n(new Error("Adblock detected!"))},r.src=t.url}))}function ae(){this.runDetection()}var se=[v,y,g];function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var ce=function(t){ut()(n,t);var e=ue(n);function n(t,r,i){var o;return M()(this,n),o=e.call(this,t,se),B()(at()(o),"state",Mt),B()(at()(o),"identifier",void 0),B()(at()(o),"url",void 0),o.identifier=r,o.url=i,o.init(),lt()(o,{})}return L()(n)}(qt);function le(){var t=this;this.event.listen({labels:{l1:["getDetectionState","fetchFile",this.identifier,"adblockDetector"]},action:function(e){e.getEmission().resolve(t.state)}})}function fe(){return he.apply(this,arguments)}function he(){return(he=Jt()($t.a.mark((function t(){var e,n;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.fetchFile();case 3:return e=t.sent,t.next=6,e.text();case 6:n=t.sent,this.state=n===this.expectedResponse?Bt:Nt,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),this.state=Nt;case 13:this.event.emit({tags:["detectionCompleted","fetchFile",this.identifier,"adblockDetector"],data:this.state});case 14:case"end":return t.stop()}}),t,this,[[0,10]])})))).apply(this,arguments)}function de(){return this.http.fetch(this.url,{credentials:"include",mode:"no-cors"})}function pe(){this.runDetection()}var ve=[m,w,b];function ge(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var ye=function(t){ut()(n,t);var e=ge(n);function n(t,r,i,o){var a;return M()(this,n),a=e.call(this,t,ve),B()(at()(a),"state",Mt),B()(at()(a),"identifier",void 0),B()(at()(a),"url",void 0),B()(at()(a),"expectedResponse",void 0),a.identifier=r,a.url=i,a.http=t.getComponent("http"),a.expectedResponse=o,a.init(),lt()(a,{})}return L()(n)}(qt);function me(){var t=this;this.event.emit({tags:["detectionState","adblockDetector"],data:this.state});var e=this.core.getEnv().publicPath;setTimeout((function(){t.drivers.cssClasses=new ee(t.core),t.drivers.loadAdvertScript=new ce(t.core,"advert","".concat(e,"/assets/adverts_.js")),t.drivers.fetchRedotFile=new ye(t.core,"gemius","https://tvn.hit.gemius.pl/redot.gif","")}),0)}var be=[f,_,zt];function we(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var _e=function(t){ut()(n,t);var e=we(n);function n(t,r){var i;return M()(this,n),i=e.call(this,t,r,be),B()(at()(i),"drivers",{}),B()(at()(i),"state",Mt),i.event.listen({history:"all",labels:{l1:["componentRegistered",r],l2:["componentInitialized","http"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(){return setTimeout(i.init,0)}}),lt()(i,void 0)}return L()(n)}(dt);function Ee(){var t=this;this.event.listen({labels:{l1:["sendReport","ssai"]},action:function(e){t.sendSsaiReport(e)}})}function Oe(t){var e=t.getEmission().data[0].messageData;!!e||this.event.emit({tags:["lackOfMessageDataFieldValue","ssai","log","warning"],description:"Cannot find required field messageData"});var n=atob(e.replace(/-/g,"+").replace(/_/g,"/"));this.http.fetch(n,{mode:"no-cors"})}function xe(){this.http=this.core.getComponent("http")}var Ae=[E,x,O];function Re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var ke=function(t){ut()(n,t);var e=Re(n);function n(t,r){var i;return M()(this,n),i=e.call(this,t,r,Ae),B()(at()(i),"core",void 0),B()(at()(i),"http",void 0),i.core=t,i.event.listen({history:"all",labels:{l1:["componentRegistered",r]},action:function(){return setTimeout((function(){return i.init()}),0)}}),i}return L()(n)}(dt);function Pe(){this.emiter.reached("componentInitializing:http"),this.emiter.reached("componentInitialized:http")}function Se(t){if(!(null==t?void 0:t.match(/^(http[s]?:)?\/\//)))throw new Error("Http url (".concat(t,") schema error."))}var Te=function(t,e){var n="",r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";"string"==typeof e&&e.length>1&&(r=e),"number"!=typeof t&&(t=10);for(var i=0;i<t;i++)n+=r.charAt(Math.floor(Math.random()*r.length));return n};function je(t){return Ce.apply(this,arguments)}function Ce(){return(Ce=Jt()($t.a.mark((function t(e){var n,r,i,o,a,s,u,c,l,f,h,d,p,v,g=arguments;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=g.length>1&&void 0!==g[1]?g[1]:{},r=g.length>2?g[2]:void 0,i=Date.now(),o=i+Te(10),a=["request",o,"http","garbage"],s=["response",o,"http","garbage"],r&&a.splice(2,0,r),r&&s.splice(2,0,r),this.event.emit({tags:a,description:"HTTP request - ".concat(r),data:{headers:n,url:e}}),t.prev=9,this.validateUrl(e),t.next=13,window.fetch(e,n);case 13:return u=t.sent,t.next=16,u.text();case 16:return c=t.sent,l=Date.now(),f=l-i,h=c.length,this.event.emit({tags:s,description:"HTTP response - ".concat(r),data:{duration:f,responseSize:h,result:c}}),d=new Blob([c]),p={status:200},t.abrupt("return",new Response(d,p));case 26:throw t.prev=26,t.t0=t.catch(9),v=new Error("[".concat(o,"] ").concat(t.t0.message)),this.event.emit({tags:["httpError","error","http"],description:"HTTP error - ".concat(r),data:{headers:n,url:e},error:v}),t.t0;case 31:case"end":return t.stop()}}),t,this,[[9,26]])})))).apply(this,arguments)}var De=function(){function t(){M()(this,t)}var e;return L()(t,[{key:"fetch",value:(e=Jt()($t.a.mark((function t(e,n){return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,n){return e.apply(this,arguments)})}]),t}(),Ie=L()((function t(e){var n=this;return M()(this,t),B()(this,"emiter",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"config",void 0),B()(this,"public",{fetch:je.bind(this)}),B()(this,"init",Pe.bind(this)),B()(this,"validateUrl",Se.bind(this)),this.public,new De,this.core=e,this.event=this.core.getComponent("event"),this.emiter=this.event.emiter(this.public),this.event.onSequence({history:!0,events:["componentRegistered:http"],action:function(){return setTimeout(n.init,0)}}),this.public}));function Le(){var t,e,n=this;this.event.listen({history:"last",enableOn:{history:"last",labels:{l1:["componentInitialized","config"]}},labels:{l1:["enable","log"]},action:(t=Jt()($t.a.mark((function t(e){var r,i,o,a,s,u,c,l,f,h,d,p;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=n.core.getComponent("config"),c=e.getEmissions().l1[0],l=c.tags,f=l.includes("remote")?"remote":l.includes("console")?"console":"undefined",h=l.includes("forInstance")?"forInstance":l.includes("forSession")?"forSession":l.includes("permanently")?"permanently":void 0,d=u.data.logs,(p=null!==(r=d.driver[f])&&void 0!==r?r:{}).filter=null!==(i=null===(o=c.data)||void 0===o?void 0:o.filter)&&void 0!==i?i:p.filter,p.schema=null!==(a=null===(s=c.data)||void 0===s?void 0:s.schema)&&void 0!==a?a:p.schema,p.enable=!0,h){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,n.event.emit({async:!0,tags:["save",h,"storage"],data:{logs:d}});case 14:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}),this.event.listen({history:"last",enableOn:{history:"last",labels:{l1:["componentInitialized","config"]}},labels:{l1:["disable","log"]},action:(e=Jt()($t.a.mark((function t(e){var r,i,o,a,s,u,c,l,f,h;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.core.getComponent("config"),s=e.getEmissions().l1[0],u=s.tags,c=u.includes("remote")?"remote":u.includes("console")?"console":"undefined",l=u.includes("forInstance")?"forInstance":u.includes("forSession")?"forSession":u.includes("permanently")?"permanently":void 0,f=a.data.logs,(h=null!==(r=f.driver[c])&&void 0!==r?r:{}).filter=null!==(i=null===(o=s.data)||void 0===o?void 0:o.filter)&&void 0!==i?i:h.filter,h.enable=!1,l){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,n.event.emit({async:!0,tags:["save",l,"storage"],data:{logs:f}});case 13:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}),this.event.listen({history:"all",labels:{l1:["register","masterVast","vast"]},action:function(t){var e=t.getEmission().responses[0];n.detectVastLogActivator(e)}})}function Fe(t){var e,n,r=t.getAll();for(var i in r){var o=r[i].command("getAllUrls");for(var a in o)if(a.match(/__DEBUG_OFF__/)?e="disable":a.match(/__DEBUG_ALL__/)?(e="enable",n="all"):a.match(/__DEBUG_LEVEL1__/)?(e="enable",n="level1"):a.match(/__DEBUG_LEVEL2__/)&&(e="enable",n="level2"),e)break;if(e)break}e&&this.event.emit({tags:[e,"remote","forSession","log"],description:"Detected vast logging command",data:{filter:n}})}function Me(){var t,e;this.config=this.core.getComponent("config"),this.session=this.core.getComponent("session");var n=this.config.data.logs,r=null==n||null===(t=n.driver)||void 0===t?void 0:t.remote,i=null==r?void 0:r.enable,o={filter:null==r?void 0:r.filter};this.endpoint=null==n||null===(e=n.websocket)||void 0===e?void 0:e.endpoint,i&&this.event.emit({tags:["enable","remote","forInstance","log"],data:o}),this.bindEvents()}function Ne(){var t=this;this.event.listen({history:"last",labels:{l1:["initializationData"]},action:function(e){var n=e.getEmission();t.playerRequestTime=n.data.playerData.playRequestTime}}),this.event.listen({history:"all",labels:{l1:["componentInitialized","config"],l2:["enable","remote","log"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(e){var n,r,i,o,a,s,u,c=e.getEmissions().l2[0],l=t.core.getComponent("config"),f=null!==(n=null===(r=c.data)||void 0===r?void 0:r.filter)&&void 0!==n?n:null===(i=l.data.logs)||void 0===i||null===(o=i.driver)||void 0===o||null===(a=o.remote)||void 0===a?void 0:a.filter,h=null===(s=l.data.logs)||void 0===s||null===(u=s.map)||void 0===u?void 0:u[f];h&&Object.entries(h).length>0&&(t.event.listen({disableOn:{labels:{l1:["disable","remote","log"]}},prio:10,history:"all",labels:h,action:function(e){return t.cacheEvent(e.getEmission())}}),e.disableListener())}}),this.event.listen({history:"last",labels:{l1:["enable","remote","log"]},action:function(e){t.connect(),e.disableListener()}}),this.event.listen({labels:{l1:["requestReconnect","remote","log"]},action:function(){t.closeConnection(),t.connect()}}),this.event.listen({history:"all",labels:{l1:["sdkDestroy"]},action:function(){return window.clearTimeout(t.timerHandler)}})}function Be(t){this.logCache.push(t),this.send()}function Ue(){var t=this;this.reconnectionsLimit<=0?this.event.emit({tags:["connectionLimitExceeded","websocket","log","warning"],data:this.reconnectionsLimit}):(this.connection=new WebSocket(this.endpoint,"echo-protocol"),this.connection.onerror=function(e){t.event.emit({tags:["connectionError","websocket","log"],error:e}),t.requestReconnect()},this.connection.onopen=function(){t.sendMetaFrame(),t.send(),t.event.emit({tags:["opened","websocket","log"]})},this.connection.onclose=function(){t.requestReconnect(),t.event.emit({tags:["closed","websocket","log"]})},this.reconnectionsLimit--)}function ze(){var t=this.session.instanceId;this.connection.send(JSON.stringify({messageType:"meta",instanceId:t}))}function qe(){return!(!this.connection||1!==this.connection.readyState)}function Ye(){this.isConnected()&&(this.connection.close(),this.connection.onerror=function(){},this.connection.onopen=function(){},this.connection.onclose=function(){})}function Ge(){var t=this;this.timerHandler=setTimeout((function(){return t.event.emit({tags:["requestReconnect","remote","log"]})}),this.reconnectionDelay)}function Je(t){this.event.emit({tags:["webSocketConnectionError","warning"],description:"Can't connect to ".concat(this.endpoint),error:t}),this.requestReconnect()}function Ve(){if(this.isConnected()){var t=this.logCache.shift();if(t){this.packetId++;var e,n=t.date,r=t.emissionID,i=t.data,o=t.tags,a=t.description,s=n,u=this.core.getEnv().startTime,c=n-this.playerRequestTime?pt(n-this.playerRequestTime):"NA",l=n-u?pt(n-u):"NA";try{e=void 0!==i?JSON.parse(JSON.stringify(i)):i}catch(t){e="Can't stringify responses"}var f={packetId:this.packetId,startTimeOffset:l,playTimeOffset:c,timestamp:s,messageType:"data",logId:r,description:a,tags:o.join(","),data:e};this.connection.send(JSON.stringify(f)),this.send()}}}var $e=L()((function t(e){return M()(this,t),B()(this,"emiter",void 0),B()(this,"connection",void 0),B()(this,"logCache",[]),B()(this,"packetId",0),B()(this,"reconnectionsLimit",100),B()(this,"reconnectionDelay",1e3),B()(this,"packetId",0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"config",void 0),B()(this,"public",{}),B()(this,"init",Me.bind(this)),B()(this,"bindEvents",Ne.bind(this)),B()(this,"connect",Ue.bind(this)),B()(this,"closeConnection",Ye.bind(this)),B()(this,"send",Ve.bind(this)),B()(this,"sendMetaFrame",ze.bind(this)),B()(this,"cacheEvent",Be.bind(this)),B()(this,"isConnected",qe.bind(this)),B()(this,"requestReconnect",Ge.bind(this)),B()(this,"onError",Je.bind(this)),this.core=e,this.event=this.core.getComponent("event"),this.emiter=this.event.emiter(),this.event.listen({history:"all",labels:{l1:["componentInitialized","config"],l2:["componentInitialized","session"]},rule:function(t){return t.l1.length&&t.l2.length},action:this.init}),this.public}));function He(){var t=this;this.event.listen({history:"last",labels:{l1:["initializationData"]},action:function(e){var n=e.getEmission();t.playerRequestTime=n.data.playerData.playRequestTime}}),this.event.listen({history:"all",labels:{l1:["componentInitialized","config"],l2:["enable","console","log"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(e){var n,r,i,o,a,s,u,c,l,f,h,d,p=e.getEmissions().l2[0],v=t.core.getComponent("config");t.filter=null!==(n=null===(r=p.data)||void 0===r?void 0:r.filter)&&void 0!==n?n:null===(i=v.data.logs)||void 0===i||null===(o=i.driver)||void 0===o||null===(a=o.console)||void 0===a?void 0:a.filter;var g=null===(s=v.data.logs)||void 0===s||null===(u=s.map)||void 0===u?void 0:u[t.filter];t.schema=null!==(c=null===(l=p.data)||void 0===l?void 0:l.schema)&&void 0!==c?c:null===(f=v.data.logs)||void 0===f||null===(h=f.driver)||void 0===h||null===(d=h.console)||void 0===d?void 0:d.schema,g&&Object.entries(g).length>0&&(t.event.listen({disableOn:{labels:{l1:["disable","console","log"]}},prio:10,history:"all",labels:g,action:function(e){return t.console(e)}}),e.disableListener())}})}function Ke(){var t;this.config=this.core.getComponent("config"),this.session=this.core.getComponent("session");var e=this.config.data.logs,n=null==e||null===(t=e.driver)||void 0===t?void 0:t.console,r=null==n?void 0:n.enable,i={filter:null==n?void 0:n.filter};r&&this.event.emit({tags:["enable","console","forInstance","log"],data:i})}function We(t){var e,n,r,i,o={data:"",style:[]},a={data:"",style:[]},s={data:"",style:[]},u=!1,c=(null===(e=this.config.data.logs)||void 0===e||null===(n=e.driver)||void 0===n||null===(r=n.console)||void 0===r?void 0:r.schemas)[this.schema],l=t.getEmission(),f=l.date,h=l.emissionID,d=l.tags,p=l.data,v=l.description,g=l.responses,y=l.error,m=this.core.getEnv().startTime,b=f-m?pt(f-m):"NA",w=l.async?"async":"sync",_=f-this.playerRequestTime?pt(f-this.playerRequestTime):"NA";d.forEach((function(t,e){var n;switch(t){case"info":case"passed":n=c.notice;break;case"warning":case"analizerReport":case"summary":n=c.warn;break;case"error":case"failed":n=c.error;break;case"adapterCall":n=c.distinction;break;case"all":case"emulation":case"garbage":case"registered":n=c.noImportant;break;default:n=c.default}0!==e&&(o.data+=" "),o.data+="%c".concat(t),o.style.push(n)})),v&&(o.data+="%c #".concat(v),o.style.push(c.important)),a.data+="%c".concat("ATSDK"),a.style.push(c.noImportant),a.data+="%c | ".concat(h),a.style.push(c.noImportant),a.data+="%c | ".concat(w),a.style.push(c.noImportant),a.data+="%c | ".concat(b),a.style.push(c.noImportant),a.data+="%c | ".concat(_),a.style.push(c.default),a.data+="%c | ".concat(f),a.style.push(c.noImportant),a.data+="%c | ".concat(this.session.instanceId),a.style.push(c.noImportant),y&&(s.data+="\n%c".concat(y.message),s.style.push(c.error),u=!0);var E=[];E.push.apply(E,Et()(o.style)),E.push.apply(E,Et()(a.style)),u&&E.push.apply(E,Et()(s.style)),(i=window.console).log.apply(i,["".concat(o.data)+"".concat("\n"+a.data)+"".concat("")+"".concat(u?"\n"+s.data:"")].concat(E,[void 0===p?"":"\n",void 0===p?"":p,void 0===g?"":"\n",void 0===g?"":g]))}var Xe=[A,R,k];function Ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var Qe=function(t){ut()(n,t);var e=Ze(n);function n(t){var r;return M()(this,n),r=e.call(this,t,Xe),B()(at()(r),"filter",void 0),B()(at()(r),"config",void 0),B()(at()(r),"session",void 0),r.event.listen({history:"all",labels:{l1:["componentInitialized","config"],l2:["componentInitialized","session"]},rule:function(t){return t.l1.length&&t.l2.length},action:r.init}),lt()(r,void 0)}return L()(n)}(qt);function tn(){this.event.emit({tags:["componentInitializing","log"]}),this.drivers.remote=new $e(this.core),this.drivers.console=new Qe(this.core),this.bindEvents(),this.bindSharedEvents(),this.event.emit({tags:["componentInitialized","log"]})}function en(){}var nn=L()((function t(e){var n=this;return M()(this,t),B()(this,"drivers",{}),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"storage",void 0),B()(this,"public",{}),B()(this,"init",tn.bind(this)),B()(this,"bindSharedEvents",Le.bind(this)),B()(this,"bindEvents",en.bind(this)),B()(this,"detectVastLogActivator",Fe.bind(this)),this.core=e,this.event=this.core.getComponent("event"),this.event.listen({history:"all",labels:{l1:["componentRegistered","event"],l2:["componentRegistered","log"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(t){setTimeout(n.init,0),t.disableListener()}}),this.public}));function rn(t){this.setget.id=t,this.emiter.reached("newSessionId",t)}function on(){this.event.emit({description:"Instance alive report",tags:["instanceAlive","session","info"]})}function an(){this.event.emit({description:"Session alive report",tags:["sessionAlive","session","info"]})}function sn(){this.event.emit({tags:["componentInitializing","session"]}),this.event=this.core.getComponent("event"),this.emiter=this.event.emiter(this.public),this.setget.instanceId=Te(32),this.event.emit({tags:["instanceIdEstablished","session"],description:"Instance ID estabilished",data:this.setget.instanceId}),this.instanceAliveReport(),this.bindEvents(),this.event.emit({tags:["componentInitialized","session"]})}function un(){var t=this;this.event.listen({history:"all",labels:{l1:["initializationData"]},action:function(e){var n,r,i=null!==(n=null===(r=e.getEmissionByAlias("initializationData").data.sdkConfig)||void 0===r?void 0:r.sessionId)&&void 0!==n?n:"undefined";t.setget.setId(i),t.event.emit({tags:["sessionIdEstablished","session"],description:"Session ID estabilished",data:i}),t.sessionAliveReport(),e.disableListener()}})}var cn=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"setget";void 0===t[r]&&(t[r]={});var i="set"+n.charAt(0).toUpperCase()+n.slice(1),o="get"+n.charAt(0).toUpperCase()+n.slice(1);"function"!=typeof t[r][i]&&(t[r][i]=function(){throw new Error("Prohibited try to set read only property "+n)}),"function"!=typeof t[r][o]&&(t[r][o]=function(){return t[r][n]}),Object.defineProperty(e,n,{set:function(e){return t[r][i](e)},get:function(){return t[r][o]()}})},ln=L()((function t(){M()(this,t)})),fn=function(){function t(){M()(this,t)}return L()(t,[{key:"name",get:function(){}}]),t}(),hn=L()((function t(e){var n=this;return M()(this,t),B()(this,"emiter",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"public",{id:void 0,instanceId:void 0,name:void 0}),B()(this,"setget",{instanceId:void 0,setId:rn.bind(this),name:"session"}),B()(this,"init",sn.bind(this)),B()(this,"bindEvents",un.bind(this)),B()(this,"instanceAliveReport",on.bind(this)),B()(this,"sessionAliveReport",an.bind(this)),function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"setget";void 0===t[r]&&(t[r]={});var i="set"+n.charAt(0).toUpperCase()+n.slice(1),o="get"+n.charAt(0).toUpperCase()+n.slice(1);"function"!=typeof t[r][i]&&(t[r][i]=function(e){t[r][n]=e}),"function"!=typeof t[r][o]&&(t[r][o]=function(){return t[r][n]}),Object.defineProperty(e,n,{set:function(e){return t[r][i](e)},get:function(){return t[r][o]()}})}(this,this.public,"id"),cn(this,this.public,"name"),cn(this,this.public,"instanceId"),this.public,new ln,new fn,this.core=e,this.event=this.core.getComponent("event"),this.event.listen({history:"all",labels:{l1:["componentRegistered","session"]},rule:function(t){return t.l1.length},action:function(){return setTimeout(n.init,0)}}),this.public})),dn=function(){function t(){M()(this,t)}return L()(t,[{key:"useSpace",value:function(t){}},{key:"clearSpace",value:function(t){}},{key:"useHardSpace",value:function(){}},{key:"save",value:function(){}}]),t}();function pn(){var t=this;this.event.listen({history:"last",labels:{l1:["save","forSession","storage"]},action:function(e){var n=e.getEmission().data;t.saveInSession(n)}}),this.event.listen({history:"last",labels:{l1:["save","permanently","storage"]},action:function(e){var n=e.getEmission().data;t.savePermanently(n)}})}function vn(t){return this.data[t]||(this.data[t]={}),this.data[t]}function gn(t){return this.data[t]={},this.data[t]}function yn(){return this.hdd}function mn(){window.localStorage&&window.localStorage.setItem("sdkHDD",JSON.stringify(this.hdd))}var bn=n(11),wn=n.n(bn);function _n(t){var e={};try{var n;e=null!==(n=JSON.parse(sessionStorage.getItem("forceSdkConfig")))&&void 0!==n?n:{}}catch(t){this.event.emit({tags:["parseStorageDataError","inSession","warning"],description:"Error while parsing storage data",data:e,error:t})}try{e=C()(e,t);var r=JSON.stringify(e);sessionStorage.setItem("forceSdkConfig",r)}catch(t){this.event.emit({tags:["saveStorageError","inSession","warning"],description:"Error while savind data to sessionStorage",data:e,error:t})}}function En(t){var e={};try{var n;e=null!==(n=JSON.parse(localStorage.getItem("forceSdkConfig")))&&void 0!==n?n:{}}catch(t){this.event.emit({tags:["parseStorageDataError","inSession","warning"],description:"Error while parsing storage data",data:e,error:t})}try{e=C()(e,t);var r=JSON.stringify(e);localStorage.setItem("forceSdkConfig",r)}catch(t){this.event.emit({tags:["saveStorageError","inSession","warning"],description:"Error while savind data to sessionStorage",data:e,error:t})}}function On(){return xn.apply(this,arguments)}function xn(){return(xn=Jt()($t.a.mark((function t(){var e;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{window.localStorage&&(e=window.localStorage.getItem("sdkHDD"),this.hdd=JSON.parse(e),this.hdd="object"!==wn()(this.hdd)||null===this.hdd?{}:this.hdd)}catch(t){this.event.emit({tags:["loadStorageError:error"],error:t})}this.event.emit({tags:["storageDataLoaded","storage"],description:"Storage data loaded",data:this.hdd});case 2:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}function An(){this.event.emit({tags:["componentInitializing","storage"]}),this.storage=this.public,this.load(),this.bindSharedEvents(),this.event.emit({tags:["componentInitialized","storage"]})}var Rn=L()((function t(e){var n=this;return M()(this,t),B()(this,"core",void 0),B()(this,"data",{}),B()(this,"hdd",{}),B()(this,"public",{useSpace:vn.bind(this),clearSpace:gn.bind(this),useHardSpace:yn.bind(this),save:mn.bind(this),name:void 0}),B()(this,"load",On.bind(this)),B()(this,"init",An.bind(this)),B()(this,"savePermanently",En.bind(this)),B()(this,"saveInSession",_n.bind(this)),B()(this,"bindSharedEvents",pn.bind(this)),this.public,new dn,this.core=e,this.event=this.core.getComponent("event"),this.event.listen({history:"last",labels:{l1:["componentRegistered","storage"]},action:function(){return setTimeout(n.init,0)}}),this.public}));function kn(){var t=this;this.event.listen({history:"all",labels:{l1:["initializationData"],l2:["packageConfig"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(e){var n,r,i,o=e.getEmissions(),a=o.l1[0].data,s=o.l2[0].data,u=null==a||null===(n=a.adsLoaderConfig)||void 0===n?void 0:n.adServerUrl;if(u){var c=u.split("?").pop();t.breakConfig=null==s?void 0:s.break,t.mainConfig=s,t.rules=null==s?void 0:s.advConfigRules,t.adRequestOriginalParams=null==c?void 0:c.split("/").reduce((function(t,e){var n=e.split("=");return t[n[0]]=n[1],t}),{}),null===(r=t.adRequestOriginalParams)||void 0===r||delete r[""],t.duration=Math.round(function(t){if("number"==typeof t)return t/1e3}(a.videoData.duration)),t.contentType=null===(i=a.playerData)||void 0===i?void 0:i.contentType,t.rules?t.runRulesEngine():t.event.emit({tags:["missingRulesData","configModificator"]})}else t.event.emit({tags:["missingRulesData","configModificator"]})}}),this.event.listen({labels:{l1:["getConfigOverwritingData","configModificator"]},action:function(e){e.getEmission().resolve(t.resultConfig)}})}var Pn=n(27);function Sn(){this.storage=this.core.getComponent("storage"),this.engine=new Pn.Engine(void 0,{allowUndefinedFacts:!0}),this.adRequestStorage=this.storage.useSpace("adRequest"),this.referrer=document.referrer}function Tn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tn(Object(n),!0).forEach((function(e){B()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Cn(){return Dn.apply(this,arguments)}function Dn(){return(Dn=Jt()($t.a.mark((function t(){var e,n,r,i,o,a=this;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.core.getEnv(),n=e.rnd,this.rules.forEach((function(t){try{a.engine.addRule(t)}catch(e){a.event.emit({tags:["ruleAddingError","configModificator","warning"],data:{message:null==e?void 0:e.message,rule:t}})}})),r=jn(jn(jn({},this.adRequestOriginalParams),this.breakConfig),{},{mainConfig:this.mainConfig,rnd:n,duration:this.duration,contentType:this.contentType,referrer:this.referrer}),i=[],t.prev=4,t.next=7,this.engine.run(r);case 7:o=t.sent,i=o.events,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),"UNDEFINED_FACT"===(null===t.t0||void 0===t.t0?void 0:t.t0.code)?this.event.emit({tags:["undefinedFactError","configModificator","warning"],data:null===t.t0||void 0===t.t0?void 0:t.t0.message}):this.event.emit({tags:["rulesEngineError","configModificator","warning"],data:null===t.t0||void 0===t.t0?void 0:t.t0.message});case 14:i.forEach((function(t){a.resultConfig=a.mergeDeep(a.resultConfig,a.duplicatedParams,t.params)})),this.overwriteAdRequestParams(this.resultConfig.adRequest),this.event.emit({tags:["configOverwritingData","configModificator"],data:{adRequestParams:this.resultConfig.adRequest,adRequestPassbackParams:this.resultConfig.adRequestPassback,breakConfig:this.resultConfig.breakConfig,mainConfig:this.resultConfig.mainConfig}}),this.duplicatedParams.length&&this.event.emit({tags:["configParamsDuplicatedError","configModificator","warning"],data:this.duplicatedParams});case 18:case"end":return t.stop()}}),t,this,[[4,11]])})))).apply(this,arguments)}function In(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!r.length)return t;var o=r.shift();if(Ln(t)&&Ln(o))for(var a in o)Ln(o[a])?(t[a]||Object.assign(t,B()({},a,{})),In(t[a],e,o[a])):(Object.prototype.hasOwnProperty.call(t,a)&&t[a]!==o[a]&&e.push({paramName:a,targetValue:t[a],sourceValue:o[a]}),Object.assign(t,B()({},a,o[a])));return In.apply(void 0,[t,e].concat(r))}function Ln(t){return t&&"object"===wn()(t)&&!Array.isArray(t)}function Fn(t){if(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=kt()(n[e],2),i=r[0],o=r[1];this.adRequestStorage[i]=o}this.event.emit({tags:["adRequestParamsOverwritten","configModificator"]})}}var Mn=[P,S,T];function Nn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht()(t);if(e){var i=ht()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lt()(this,n)}}var Bn={packageGlobal:"utils",core:{startupInstance:!0},components:{event:{class:it,loader:"event"},config:{class:wt,loader:"2.0"},session:{class:hn,loader:"2.0"},storage:{class:Rn,loader:"2.0"},adapter:{class:Ft,loader:"2.0"},adblockDetector:{class:_e,loader:"2.0"},ssai:{class:ke,loader:"2.0"},http:{class:Ie,loader:"2.0"},log:{class:nn,loader:"2.0"},configModificator:{class:function(t){ut()(n,t);var e=Nn(n);function n(t,r){var i;return M()(this,n),i=e.call(this,t,r,Mn),B()(at()(i),"engine",void 0),B()(at()(i),"adRequestOriginalParams",{}),B()(at()(i),"breakConfig",{}),B()(at()(i),"rules",void 0),B()(at()(i),"rnd",void 0),B()(at()(i),"duration",void 0),B()(at()(i),"contentType",void 0),B()(at()(i),"duplicatedParams",[]),B()(at()(i),"adRequestStorage",void 0),B()(at()(i),"resultConfig",{}),B()(at()(i),"mainConfig",{}),B()(at()(i),"referrer",void 0),i.event.listen({history:"all",labels:{l1:["componentRegistered",r],l2:["componentInitialized","storage"]},rule:function(t){return t.l1.length&&t.l2.length},action:function(){return setTimeout(i.init,0)}}),lt()(i,{})}return L()(n)}(dt),loader:"2.0"}}};function Un(){var t=Object({host:"https://at-app.cdntvn.pl",publicPath:"https://at-app.cdntvn.pl/package/lib/utils/2.7.7",version:"2.7.7",buildTime:1706284567e3,build:"production",debugToken:"dev",buildHash:"a878efd622791f284ffb59982a6dcd6c",env:"portal",tag:"lib-utils",etag:"dbf3e080c127a8ad43f25c970933889f",dirPath:""});return t.startTime=this.startTime,t.fileLoadTime=this.constructor.fileLoadTime,t.rnd=this.rnd,t}function zn(t){return this.componentsLoader.getComponent(t)}function qn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"console",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"level2",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"forInstance",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dark",o=t?"enable":"disable";this.event.emit({tags:[o,e,r,"log"],data:{filter:n,schema:i}})}function Yn(){this.event.emit({tags:["testPanelConnection","enabled"]})}function Gn(t,e){var n;return null===(n=this.event.emit({tags:["requestNewAdapter"],data:{adapter:t,id:e}}))||void 0===n?void 0:n[0]}function Jn(){return!!this.alive}function Vn(){var t=this;this.event.listen({prio:30,labels:{l1:["sdkDestroy"]},action:function(){t.alive=!1}})}function $n(){var t=this;this.event.listen({history:"all",labels:{l1:["componentInitialized"]},action:function(e){var n=e.getEmission().tags[1];t.registeredComponents[n]?(t.registeredComponents[n].registered||t.event.emit({tags:["componentInitializedBeforeRegistration","warning","noSentry"],data:n}),t.registeredComponents[n].initialized=!0,!t.getNoInitializedComponents().length&&(t.endInitializing=new Date,setTimeout((function(){return t.event.emit({tags:["allComponentsInitialized"],data:{initTime:t.getInitializationTime()}})}),0))):t.event.emit({tags:["unknownComponentInitialization","error"],data:n})}}),this.event.listen({prio:40,labels:{l1:["sdkDestroy"]},action:function(){t.registeredComponents={}}})}function Hn(t){var e,n=this;this.startRegistering=new Date,this.registeredComponents=null!==(e=Object.entries(t).reduce((function(t,e){var n,r=null===(n=e[1].enabled)||void 0===n||n,i=e[0];return r&&(t[i]={instance:null,name:i,initialized:!1,registered:!1}),t}),{}))&&void 0!==e?e:{},Object.entries(t).forEach((function(t){var e,r=t[1].class,i=t[0],o=t[1].loader,a=null===(e=t[1].enabled)||void 0===e||e,s=t[1].postAction;try{a&&n.loadComponent(r,i,o,s)}catch(t){n.event.emit({tags:["loadComponentError","error",i],data:{error:t}})}})),this.endRegistering=new Date;var r=!!Object.keys(this.registeredComponents).length,i=this.getNoRegisteredComponents();r&&0===i.length?this.event.emit({tags:["allComponentsRegistered","core"],description:"All components registered",data:{registrationTime:this.getRegistrationTime()}}):r?this.event.emit({tags:["noAllComponentsRegistered","error"],data:i}):this.event.emit({tags:["noAvailableComponents"]})}function Kn(t){var e;return null===(e=this.registeredComponents[t])||void 0===e?void 0:e.instance}function Wn(t){var e;return null===(e=this.registeredComponents[t])||void 0===e?void 0:e.metadata}function Xn(){var t=this;Object.values(this.registeredComponents).forEach((function(e){var n=e.instance;"function"==typeof n.reset&&(n.reset(),delete t.registeredComponents[n.name]),t.registeredComponents={}}))}function Zn(){this.event=this.core.getComponent("event")}function Qn(){}function tr(t,e){return this.event.emit({tags:["componentRegistering",e]}),new t(this.core,e)}var er=L()((function t(){M()(this,t)})),nr=L()((function t(e){return M()(this,t),B()(this,"emiter",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"public",{load:tr.bind(this)}),B()(this,"init",Zn.bind(this)),B()(this,"bindEvents",Qn.bind(this)),this.core=e,this.public,new er,this.init(),this.public}));function rr(){this.event=this.core.getComponent("event"),this.emiter=this.event.emiter(this.public)}function ir(){}function or(t,e){this.event.emit({tags:["componentRegistering",e]});var n=new t;return n.build(this.core),n}var ar=L()((function t(e){return M()(this,t),B()(this,"emiter",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"public",{load:or.bind(this)}),B()(this,"init",rr.bind(this)),B()(this,"bindEvents",ir.bind(this)),this.core=e,this.public,new er,this.init(),this.public}));function sr(){}function ur(){}function cr(t,e){var n=new t(this.core);return n.emit({tags:["componentRegistering",e]}),n}var lr=L()((function t(e){return M()(this,t),B()(this,"emiter",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"public",{load:cr.bind(this)}),B()(this,"init",sr.bind(this)),B()(this,"bindEvents",ur.bind(this)),this.core=e,this.public,new er,this.init(),this.public}));function fr(){return Object.values(this.registeredComponents).reduce((function(t,e){return e.initialized||t.push(e.name),t}),[])}function hr(){return Object.values(this.registeredComponents).reduce((function(t,e){return e.registered||t.push(e.name),t}),[])}function dr(){return Object.entries(this.registeredComponents).map((function(t){return t[0]}))}function pr(){return this.endRegistering.getTime()-this.startRegistering.getTime()}function vr(){return this.endInitializing.getTime()-this.endRegistering.getTime()}function gr(t,e,n,r){var i;switch(n){case"2.0":this.loaders.loader20=this.loaders.loader20||new nr(this.core),i=this.loaders.loader20.load(t,e);break;case"1.0":this.loaders.loader10=this.loaders.loader10||new ar(this.core),i=this.loaders.loader10.load(t,e);break;case"event":this.loaders.loaderEvent=this.loaders.loaderEvent||new lr(this.core),i=this.loaders.loaderEvent.load(t,e),this.event=i,this.bindEvents()}this.registeredComponents[e].instance=i,this.registeredComponents[e].registered=!0,this.event.emit({tags:["componentRegistered",e]}),"function"==typeof r&&r()}var yr=L()((function t(){M()(this,t)})),mr=L()((function t(e){return M()(this,t),B()(this,"emiter",void 0),B()(this,"registeredComponents",{}),B()(this,"loaders",{}),B()(this,"startRegistering",void 0),B()(this,"endRegistering",void 0),B()(this,"endInitializing",void 0),B()(this,"core",void 0),B()(this,"event",void 0),B()(this,"public",{load:Hn.bind(this),destroyComponents:Xn.bind(this),getComponent:Kn.bind(this),getComponentMeta:Wn.bind(this)}),B()(this,"bindEvents",$n.bind(this)),B()(this,"getNoInitializedComponents",fr.bind(this)),B()(this,"getRegistrationTime",pr.bind(this)),B()(this,"getInitializationTime",vr.bind(this)),B()(this,"loadComponent",gr.bind(this)),B()(this,"getRegisteredComponentsList",dr.bind(this)),B()(this,"getNoRegisteredComponents",hr.bind(this)),this.core=e,this.public,new yr,this.public})),br=function(t,e){var n="",r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";"string"==typeof e&&e.length>1&&(r=e),"number"!=typeof t&&(t=10);for(var i=0;i<t;i++)n+=r.charAt(Math.floor(Math.random()*r.length));return n};function wr(){var t,e;this.startTime=Date.now(),this.rnd=(t=0,e=100,Math.floor(Math.random()*(e-t+1))+t),this.componentsLoader=new mr(this.public),this.componentsLoader.load(this.sdk.config.components),this.event=this.public.getComponent("event"),this.event.emit({tags:["packageConfig"],data:this.sdk.config}),this.bindEvents()}var _r=L()((function t(e,n){return M()(this,t),B()(this,"componentsLoader",void 0),B()(this,"sdk",void 0),B()(this,"alias",void 0),B()(this,"startTime",void 0),B()(this,"alive",!0),B()(this,"public",{logs:qn.bind(this),connectToTestPanel:Yn.bind(this),getEnv:Un.bind(this),getComponent:zn.bind(this),allocateNewAdapter:Gn.bind(this),isAlive:Jn.bind(this)}),B()(this,"bindEvents",Vn.bind(this)),B()(this,"init",wr.bind(this)),this.sdk=e,this.alias=n,this.init(),this.public}));function Er(){try{var t,e=this.detectRequestUrl(),n=this.detectPath(e);if(this.publishSdk(n),null!==(t=this.config.core)&&void 0!==t&&t.startupInstance){var r=new _r(this,this.config.packageGlobal);this.instance.push(r)}this.bindEvents(),this.coreResolve()}catch(t){var i;throw null===(i=this.coreReject)||void 0===i||i.call(this,t),t}}function Or(){var t=this;window.addEventListener("message",(function(e){var n,r,i;e.origin===location.origin&&"publicCore"===(null===(n=e.data)||void 0===n?void 0:n.sdkCommand)&&(null!==(i=(r=window).ATSDKDEBUG)&&void 0!==i||(r.ATSDKDEBUG={}),window.ATSDKDEBUG[t.config.packageGlobal]?console.error("debugObjectConflictDetected",t.config.packageGlobal):window.ATSDKDEBUG[t.config.packageGlobal]=t)}))}function xr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.adapter,n=t.newSdkInstance,r=t.id,i=void 0===r?br(10):r,o=this.instance.find((function(t){return t.isAlive()}));return o&&!n||(o=new _r(this,this.config.packageGlobal),this.instance.push(o)),o.allocateNewAdapter(e,i)}function Ar(t){var e,n,r,i,o,a,s,u,c=null!==(e=null==t?void 0:t.split("_"))&&void 0!==e?e:[],l=this.config.packageGlobal;c[0]=null!==(n=c[0])&&void 0!==n&&n.length?c[0]:"atsdk",c[1]=null!==(r=c[1])&&void 0!==r&&r.length?c[1]:l;var f=null!==(a=(i=window)[o=c[0]])&&void 0!==a?a:i[o]={},h=null!==(u=f[s=c[1]])&&void 0!==u?u:f[s]={};if(h.onLoad&&(!h.resolve||!h.reject))throw new Error("Trying to load the same sdk multiple times");h.onLoad||(h.onLoad=new Promise((function(t,e){h.resolve=t,h.reject=e}))),this.coreResolve=h.resolve,this.coreReject=h.reject,delete h.resolve,delete h.reject,h=this.sdkGlobal=Object.assign(h,this.public)}function Rr(){try{var t,e=Object({host:"https://at-app.cdntvn.pl",publicPath:"https://at-app.cdntvn.pl/package/lib/utils/2.7.7",version:"2.7.7",buildTime:1706284567e3,build:"production",debugToken:"dev",buildHash:"a878efd622791f284ffb59982a6dcd6c",env:"portal",tag:"lib-utils",etag:"dbf3e080c127a8ad43f25c970933889f",dirPath:""});return null===(t=performance.getEntriesByType("resource").reverse().find((function(t){return"script"===t.initiatorType&&t.name.includes(e.publicPath)})))||void 0===t?void 0:t.name}catch(t){console.error("sdkScriptUrlDetectionFail",t)}}function kr(t){if(t)try{return new URL(t).searchParams.get("ns")}catch(t){console.error("sdkNameSpacePathDetectionFail",t)}}var Pr,Sr=L()((function t(e){M()(this,t),B()(this,"startTime",void 0),B()(this,"config",void 0),B()(this,"instance",[]),B()(this,"sdkGlobal",void 0),B()(this,"coreReject",void 0),B()(this,"coreResolve",void 0),B()(this,"public",{id:"ATSDK_".concat("lib-utils","_").concat("2.7.7"),version:"2.7.7",package:"lib-utils",buildTime:1706284567e3,allocateNewAdapter:xr.bind(this)}),B()(this,"init",Er.bind(this)),B()(this,"bindEvents",Or.bind(this)),B()(this,"detectRequestUrl",Rr.bind(this)),B()(this,"publishSdk",Ar.bind(this)),B()(this,"detectPath",kr.bind(this)),this.startTime=Date.now(),this.config=e,this.init()}));try{Pr=__AT_SDK_EXTERNAL_CONFIG__}catch(t){Pr={}}new Sr(C.a.all([D,Bn,Pr]))}]);
//# sourceMappingURL=app.js.map