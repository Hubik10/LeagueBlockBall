(()=>{var qo=Object.create;var Je=Object.defineProperty,Bo=Object.defineProperties,Wo=Object.getOwnPropertyDescriptor,Ko=Object.getOwnPropertyDescriptors,Vo=Object.getOwnPropertyNames,Tr=Object.getOwnPropertySymbols,Go=Object.getPrototypeOf,Er=Object.prototype.hasOwnProperty,$o=Object.prototype.propertyIsEnumerable;var Ir=(e,r,t)=>r in e?Je(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,R=(e,r)=>{for(var t in r||(r={}))Er.call(r,t)&&Ir(e,t,r[t]);if(Tr)for(var t of Tr(r))$o.call(r,t)&&Ir(e,t,r[t]);return e},Ue=(e,r)=>Bo(e,Ko(r));var k=(e,r)=>()=>(e&&(r=e(e=0)),r);var G=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Ar=(e,r)=>{for(var t in r)Je(e,t,{get:r[t],enumerable:!0})},Pr=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Vo(r))!Er.call(e,o)&&o!==t&&Je(e,o,{get:()=>r[o],enumerable:!(n=Wo(r,o))||n.enumerable});return e};var Lt=(e,r,t)=>(t=e!=null?qo(Go(e)):{},Pr(r||!e||!e.__esModule?Je(t,"default",{value:e,enumerable:!0}):t,e)),Cr=e=>Pr(Je({},"__esModule",{value:!0}),e);var Fe,st=k(()=>{Fe={name:"@turnercode/cdp-psm-core",version:"4.4.0",description:"Prism core functions",private:!0,main:"dist/psm.legacy.min.umd.cjs",module:"dist/psm.legacy.min.umd.mjs",exports:{".":{import:"./dist/psm.legacy.min.umd.mjs",require:"./dist/psm.legacy.min.umd.cjs"},"./web":{import:"./dist/psm.legacy.min.umd.mjs",require:"./dist/psm.legacy.min.umd.cjs"},"./rn":{import:"./dist/psm-rn.mjs",require:"./dist/psm-rn.cjs"},"./src/*":"./src/*","./package.json":"./package.json"},repository:{type:"git",url:"https://github.com/turnercode/cdp.git",directory:"packages/psm-core"},author:"The CDP Development Team <CDP-TECH-TEAM@warnermedia.com>",license:"UNLICENSED",scripts:{build:"tsup --minify && webpack --config webpack.es5.config.js","build:modern":"tsup --minify","build:es5":"webpack --config webpack.es5.config.js","test:es5":"pnpm build:es5 && pnpm exec es-check es5 dist/psm.es5.min.umd.js",clean:"rm -rf .turbo && rm -rf node_modules && rm -rf dist",lint:"TIMING=1 eslint src --fix",test:"jest"},devDependencies:{"@babel/core":"^7.23.0","@babel/plugin-transform-runtime":"^7.23.0","@babel/preset-env":"^7.23.0","@babel/preset-typescript":"^7.23.0","@babel/runtime":"^7.23.0","@iabtcf/cmpapi":"^1.5.3","@iabtcf/core":"^1.5.3","@segment/localstorage-retry":"^1.3.0","@turnercode/cdp-cookie":"workspace:*","@turnercode/cdp-feature-flag-client":"workspace:*","@turnercode/cdp-prism-module-telemetry":"workspace:*","@turnercode/eslint-config-cdp":"workspace:*","@turnercode/scripts":"workspace:*","@turnercode/tsconfig":"workspace:*","@turnercode/types":"workspace:*","babel-loader":"^9.1.3","core-js":"^3.23.4","es-check":"^7.1.2","terser-webpack-plugin":"^5.3.14",tsup:"^6.1.3",uuid:"^8.3.2",webpack:"^5.89.0","webpack-cli":"^5.1.4"},jest:{preset:"@turnercode/scripts/jest/node",testEnvironment:"jsdom"}}});var Or,$,it,jr,kr,xr,Rr,at,de=k(()=>{Or="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuZXR3b3JrIjoiYWxsIiwicHJvZHVjdCI6InByaXNtIiwicGxhdGZvcm0iOiJ3ZWIiLCJhcHBJZCI6ImFsbC1wcmlzbS13ZWItNzI4aGtyIn0.4Fk4E28ffoFgCIcgNSG8xX5TP2n3PIU6c3jadumKULo",$={lightningOrigin:"https://lightning.warnermediacdn.com",iFramePath:{DEV:"/cdptest/psmtk/getcdpid.html",TEST:"/cdptest/psmtk/getcdpid.html",PROD:"/cdp/psmtk/getcdpid.html",INTEGRATION:"/cdptest/psmtk/getcdpid.html",AUTOMATED_TEST:"/cdptest/psmtk/getcdpid.html"},thirdPartyCookie:"/cdp/psmtk/start.html",carouselScript:"/cdp/psm/assets/swiper/swiper-bundle.min.js",carouselStyles:"/cdp/psm/assets/swiper/swiper-bundle.min.css",locate:"https://geo.ngtv.io/locate",locateV2:"https://atlas.ngtv.io/v2/locate",featureFlag:{DEV:"https://wmff.warnermediacdn.com/psm_2_dev_full.json",TEST:"https://wmff.warnermediacdn.com/psm_2_qa_full.json",PROD:"https://wmff.warnermediacdn.com/psm_2_prod_full.json",INTEGRATION:"https://wmff.warnermediacdn.com/psm_2_brand_integration_full.json",AUTOMATED_TEST:"https://wmff.warnermediacdn.com/psm_2_automated_test_full.json"},identity:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},logs:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},authSvc:{DEV:"https://dev.token.wmcdp.io/v1/token",TEST:"https://test.token.wmcdp.io/v1/token",PROD:"https://token.wmcdp.io/v1/token",INTEGRATION:"https://test.token.wmcdp.io/v1/token",AUTOMATED_TEST:"https://test.token.wmcdp.io/v1/token"}},it=["","US","GU","AS","PR","VI","MH","UM","MP"],jr=["AF","AX","AL","DZ","AD","AO","AM","AT","AZ","BH","BE","BJ","BA","BW","BV","BG","BF","BI","CM","CV","CF","TD","KM","CD","CG","CI","HR","CY","CZ","DK","DJ","EG","GQ","ER","EE","ET","FK","FO","FI","FR","GA","GM","GE","DE","GH","GI","GR","GL","GG","GN","GW","VA","HU","IS","IQ","IE","IM","IL","IT","JE","JO","KZ","KE","KW","LV","LB","LS","LR","LY","LI","LT","LU","MK","MG","MW","ML","MT","MR","MU","YT","MD","MC","ME","MA","MZ","NA","NL","NE","NG","NO","OM","PS","PL","PT","QA","RE","RO","RW","SH","SM","ST","SA","SN","RS","SC","SL","SK","SI","SO","ZA","GS","SS","ES","SD","SJ","SZ","SE","CH","SY","TZ","TG","TN","TR","UG","UA","AE","GB","EH","YE","ZM","ZW"],kr=["AI","AG","AR","AW","BS","BB","BZ","BO","BR","KY","CL","CO","CR","CW","DM","DO","EC","SV","GD","GT","GY","HT","HN","JM","MX","MS","NI","PA","PY","PE","KN","LC","VC","SR","TT","TC","UY","VE","VI","VG"],xr=["portkeygames.com","harrypotter.com"],Rr={"auth-service":!1,"doppler-identity-onstart":!0,"doppler-identity-oncomplete":!0,"doppler-session":!0,"doppler-privacy":!0,"doppler-telemetry":!0,"doppler-consent-update":!0,"doppler-pubsub-event":!1,"outside-us-location-check":!1,"doppler-send-logs":!0,"doppler-send-token-event":!1,"enable-spa-navigation-tracking":!0,sendAuthToken:!1,isInAuthTokenExperiment:!1,sendWMSegs:!1,"test-enabled":!0,"test-disabled":!1},at={minRetryDelay:3e4,maxRetryDelay:12e4,maxItems:5,maxAttempts:10,backoffFactor:2,backoffJitter:0}});function ut(e,r,t){switch(arguments.length){case 3:case 2:return us(e,r,t);case 1:return ds(e);default:return Br()}}function us(e,r,t){t=t||{};let n=Lr(e)+"="+Lr(r);t.encode===!1&&(n=e+"="+r),r==null&&(t.maxage=-1),t.maxage&&!t.expires&&(t.expires=new Date(+new Date+t.maxage)),t.path&&(n+="; Path="+t.path),t.domain&&(n+="; Domain="+t.domain),t.expires&&(n+="; Expires="+t.expires.toUTCString()),t.samesite&&(n+="; SameSite="+t.samesite),t.secure&&(n+="; Secure"),Pe("[COOKIE]: cookie.helper.set()",n,t),document.cookie=n}function Br(){let e;try{e=document.cookie}catch(r){return typeof console<"u"&&typeof console.error=="function"&&console.error(r.stack||r),{}}return ls(e)}function ds(e){let r=Br()[e];return Pe(`[COOKIE]: helper.get() - getting ${e} cookie value ${r}`),r}function ls(e){let r={},t=e.split(/ *; */),n;if(t[0]=="")return r;for(let o=0;o<t.length;++o){let s=t[o].substr(0,t[o].indexOf("=")),i=t[o].substr(t[o].indexOf("=")+1);r[Nr(s)]=Nr(i)}return r}function Lr(e){try{return encodeURIComponent(e)}catch(r){}}function Nr(e){try{return decodeURIComponent(e)}catch(r){}}var Jo,Nt,zo,Yo,Qo,Ur,Dr,Zo,Fr,Xo,Mr,ct,es,qe,ts,rs,ns,os,ss,is,as,cs,qr,Pe,ps,S,dt,ye=k(()=>{Jo=Object.create,Nt=Object.defineProperty,zo=Object.defineProperties,Yo=Object.getOwnPropertyDescriptor,Qo=Object.getOwnPropertyDescriptors,Ur=Object.getOwnPropertyNames,Dr=Object.getOwnPropertySymbols,Zo=Object.getPrototypeOf,Fr=Object.prototype.hasOwnProperty,Xo=Object.prototype.propertyIsEnumerable,Mr=(e,r,t)=>r in e?Nt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ct=(e,r)=>{for(var t in r||(r={}))Fr.call(r,t)&&Mr(e,t,r[t]);if(Dr)for(var t of Dr(r))Xo.call(r,t)&&Mr(e,t,r[t]);return e},es=(e,r)=>zo(e,Qo(r)),qe=(e,r)=>function(){return r||(0,e[Ur(e)[0]])((r={exports:{}}).exports,r),r.exports},ts=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Ur(r))!Fr.call(e,o)&&o!==t&&Nt(e,o,{get:()=>r[o],enumerable:!(n=Yo(r,o))||n.enumerable});return e},rs=(e,r,t)=>(t=e!=null?Jo(Zo(e)):{},ts(r||!e||!e.__esModule?Nt(t,"default",{value:e,enumerable:!0}):t,e)),ns=qe({"../../node_modules/.pnpm/component-url@0.2.1/node_modules/component-url/index.js"(e){e.parse=function(t){var n=document.createElement("a");return n.href=t,{href:n.href,host:n.host||location.host,port:n.port==="0"||n.port===""?r(n.protocol):n.port,hash:n.hash,hostname:n.hostname||location.hostname,pathname:n.pathname.charAt(0)!="/"?"/"+n.pathname:n.pathname,protocol:!n.protocol||n.protocol==":"?location.protocol:n.protocol,search:n.search,query:n.search.slice(1)}},e.isAbsolute=function(t){return t.indexOf("//")==0||!!~t.indexOf("://")},e.isRelative=function(t){return!e.isAbsolute(t)},e.isCrossDomain=function(t){t=e.parse(t);var n=e.parse(window.location.href);return t.hostname!==n.hostname||t.port!==n.port||t.protocol!==n.protocol};function r(t){switch(t){case"http:":return 80;case"https:":return 443;default:return location.port}}}}),os=qe({"../../node_modules/.pnpm/ms@2.0.0/node_modules/ms/index.js"(e,r){var t=1e3,n=t*60,o=n*60,s=o*24,i=s*365.25;r.exports=function(d,p){p=p||{};var f=typeof d;if(f==="string"&&d.length>0)return c(d);if(f==="number"&&isNaN(d)===!1)return p.long?u(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function c(d){if(d=String(d),!(d.length>100)){var p=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(d);if(p){var f=parseFloat(p[1]),g=(p[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return f*i;case"days":case"day":case"d":return f*s;case"hours":case"hour":case"hrs":case"hr":case"h":return f*o;case"minutes":case"minute":case"mins":case"min":case"m":return f*n;case"seconds":case"second":case"secs":case"sec":case"s":return f*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function a(d){return d>=s?Math.round(d/s)+"d":d>=o?Math.round(d/o)+"h":d>=n?Math.round(d/n)+"m":d>=t?Math.round(d/t)+"s":d+"ms"}function u(d){return l(d,s,"day")||l(d,o,"hour")||l(d,n,"minute")||l(d,t,"second")||d+" ms"}function l(d,p,f){if(!(d<p))return d<p*1.5?Math.floor(d/p)+" "+f:Math.ceil(d/p)+" "+f+"s"}}}),ss=qe({"../../node_modules/.pnpm/debug@2.6.9/node_modules/debug/src/debug.js"(e,r){e=r.exports=o.debug=o.default=o,e.coerce=a,e.disable=i,e.enable=s,e.enabled=c,e.humanize=os(),e.names=[],e.skips=[],e.formatters={};var t;function n(u){var l=0,d;for(d in u)l=(l<<5)-l+u.charCodeAt(d),l|=0;return e.colors[Math.abs(l)%e.colors.length]}function o(u){function l(){if(l.enabled){var d=l,p=+new Date,f=p-(t||p);d.diff=f,d.prev=t,d.curr=p,t=p;for(var g=new Array(arguments.length),h=0;h<g.length;h++)g[h]=arguments[h];g[0]=e.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var y=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(w,b){if(w==="%%")return w;y++;var v=e.formatters[b];if(typeof v=="function"){var I=g[y];w=v.call(d,I),g.splice(y,1),y--}return w}),e.formatArgs.call(d,g);var T=l.log||e.log||console.log.bind(console);T.apply(d,g)}}return l.namespace=u,l.enabled=e.enabled(u),l.useColors=e.useColors(),l.color=n(u),typeof e.init=="function"&&e.init(l),l}function s(u){e.save(u),e.names=[],e.skips=[];for(var l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length,p=0;p<d;p++)l[p]&&(u=l[p].replace(/\*/g,".*?"),u[0]==="-"?e.skips.push(new RegExp("^"+u.substr(1)+"$")):e.names.push(new RegExp("^"+u+"$")))}function i(){e.enable("")}function c(u){var l,d;for(l=0,d=e.skips.length;l<d;l++)if(e.skips[l].test(u))return!1;for(l=0,d=e.names.length;l<d;l++)if(e.names[l].test(u))return!0;return!1}function a(u){return u instanceof Error?u.stack||u.message:u}}}),is=qe({"../../node_modules/.pnpm/debug@2.6.9/node_modules/debug/src/browser.js"(e,r){e=r.exports=ss(),e.log=o,e.formatArgs=n,e.save=s,e.load=i,e.useColors=t,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function t(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(a){try{return JSON.stringify(a)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}};function n(a){var u=this.useColors;if(a[0]=(u?"%c":"")+this.namespace+(u?" %c":" ")+a[0]+(u?"%c ":" ")+"+"+e.humanize(this.diff),!!u){var l="color: "+this.color;a.splice(1,0,l,"color: inherit");var d=0,p=0;a[0].replace(/%[a-zA-Z%]/g,function(f){f!=="%%"&&(d++,f==="%c"&&(p=d))}),a.splice(p,0,l)}}function o(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(a){try{a==null?e.storage.removeItem("debug"):e.storage.debug=a}catch(u){}}function i(){var a;try{a=e.storage.debug}catch(u){}return!a&&typeof process<"u"&&"env"in process&&(a=process.env.DEBUG),a}e.enable(i());function c(){try{return window.localStorage}catch(a){}}}}),as=qe({"../../node_modules/.pnpm/component-cookie@1.1.5/node_modules/component-cookie/index.js"(e,r){var t=is()("cookie");r.exports=function(u,l,d){switch(arguments.length){case 3:case 2:return n(u,l,d);case 1:return s(u);default:return o()}};function n(u,l,d){d=d||{};var p=c(u)+"="+c(l);l==null&&(d.maxage=-1),d.maxage&&(d.expires=new Date(+new Date+d.maxage)),d.path&&(p+="; path="+d.path),d.domain&&(p+="; domain="+d.domain),d.expires&&(p+="; expires="+d.expires.toUTCString()),d.secure&&(p+="; secure"),document.cookie=p}function o(){var u;try{u=document.cookie}catch(l){return typeof console<"u"&&typeof console.error=="function"&&console.error(l.stack||l),{}}return i(u)}function s(u){return o()[u]}function i(u){var l={},d=u.split(/ *; */),p;if(d[0]=="")return l;for(var f=0;f<d.length;++f)p=d[f].split("="),l[a(p[0])]=a(p[1]);return l}function c(u){try{return encodeURIComponent(u)}catch(l){t("error `encode(%o)` - %o",u,l)}}function a(u){try{return decodeURIComponent(u)}catch(l){t("error `decode(%o)` - %o",u,l)}}}}),cs=qe({"../../node_modules/.pnpm/@segment+top-domain@3.0.1/node_modules/@segment/top-domain/lib/index.js"(e,r){"use strict";var t=ns().parse,n=as();function o(s){for(var i=e.cookie,c=e.levels(s),a=0;a<c.length;++a){var u="__tld__",l=c[a],d={domain:"."+l};if(i(u,1,d),i(u))return i(u,null,d),l}return""}o.levels=function(s){var i=t(s).hostname,c=i.split("."),a=c[c.length-1],u=[];if(c.length===4&&a===parseInt(a,10)||c.length<=1)return u;for(var l=c.length-2;l>=0;--l)u.push(c.slice(l).join("."));return u},o.cookie=n,e=r.exports=o}}),qr=rs(cs()),Pe=(...e)=>{window.location.search.search(/[?&]wmpsm_debug=[1t]/)!==-1&&console.info(...e)};ps=class{constructor(e){this._options={},this.options=this.options.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.remove=this.remove.bind(this),this.options(e)}options(e){if(arguments.length===0)return this._options;e=e||{};let r=e.domain||`.${(0,qr.default)(window.location.href)}`;if(r==="."&&(r=null),this._options=es(ct({maxage:31536e6,path:"/",samesite:"Lax",encode:!0},e),{domain:r}),this.set("psm:test",!0,this._options),!this.get("psm:test")){Pe("[Cookie]: psm:test cookie could not be set at domain: ",this._options.domain);let t=new RegExp(document.location.hostname,"g");document.referrer!==""&&document.referrer.search(t)===-1?this._options.samesite="None":this._options.domain=null}this.remove("psm:test"),Pe("[COOKIE]: this._options",this._options)}set(e,r,t={}){let n=ct(ct({},this._options),t);Pe("[COOKIE]: this.set() options",n);try{return typeof r!="string"&&(r=JSON.stringify(r)),ut(e,r==="null"?null:r,n),!0}catch(o){return Pe("[COOKIE]: this.set() encountered an error",o),!1}}get(e){let r=ut(e);try{return JSON.parse(r)}catch(t){return r||null}}getAll(){return ut()}remove(e){try{return ut(e,null,ct({},this._options)),!0}catch(r){return Pe("[COOKIE]: this.remove() encountered an error",r),!1}}},S=new ps,dt=qr.default});function ze(){if(!lt&&(lt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!lt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return lt(fs)}var lt,fs,Ft=k(()=>{fs=new Uint8Array(16)});var Vr,Gr=k(()=>{Vr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function gs(e){return typeof e=="string"&&Vr.test(e)}var _e,Ye=k(()=>{Gr();_e=gs});function hs(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(L[e[r+0]]+L[e[r+1]]+L[e[r+2]]+L[e[r+3]]+"-"+L[e[r+4]]+L[e[r+5]]+"-"+L[e[r+6]]+L[e[r+7]]+"-"+L[e[r+8]]+L[e[r+9]]+"-"+L[e[r+10]]+L[e[r+11]]+L[e[r+12]]+L[e[r+13]]+L[e[r+14]]+L[e[r+15]]).toLowerCase();if(!_e(t))throw TypeError("Stringified UUID is invalid");return t}var L,pt,Se,Qe=k(()=>{Ye();L=[];for(pt=0;pt<256;++pt)L.push((pt+256).toString(16).substr(1));Se=hs});function ms(e,r,t){var n=r&&t||0,o=r||new Array(16);e=e||{};var s=e.node||$r,i=e.clockseq!==void 0?e.clockseq:qt;if(s==null||i==null){var c=e.random||(e.rng||ze)();s==null&&(s=$r=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),i==null&&(i=qt=(c[6]<<8|c[7])&16383)}var a=e.msecs!==void 0?e.msecs:Date.now(),u=e.nsecs!==void 0?e.nsecs:Wt+1,l=a-Bt+(u-Wt)/1e4;if(l<0&&e.clockseq===void 0&&(i=i+1&16383),(l<0||a>Bt)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Bt=a,Wt=u,qt=i,a+=122192928e5;var d=((a&268435455)*1e4+u)%4294967296;o[n++]=d>>>24&255,o[n++]=d>>>16&255,o[n++]=d>>>8&255,o[n++]=d&255;var p=a/4294967296*1e4&268435455;o[n++]=p>>>8&255,o[n++]=p&255,o[n++]=p>>>24&15|16,o[n++]=p>>>16&255,o[n++]=i>>>8|128,o[n++]=i&255;for(var f=0;f<6;++f)o[n+f]=s[f];return r||Se(o)}var $r,qt,Bt,Wt,Hr,Jr=k(()=>{Ft();Qe();Bt=0,Wt=0;Hr=ms});function vs(e){if(!_e(e))throw TypeError("Invalid UUID");var r,t=new Uint8Array(16);return t[0]=(r=parseInt(e.slice(0,8),16))>>>24,t[1]=r>>>16&255,t[2]=r>>>8&255,t[3]=r&255,t[4]=(r=parseInt(e.slice(9,13),16))>>>8,t[5]=r&255,t[6]=(r=parseInt(e.slice(14,18),16))>>>8,t[7]=r&255,t[8]=(r=parseInt(e.slice(19,23),16))>>>8,t[9]=r&255,t[10]=(r=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=r/4294967296&255,t[12]=r>>>24&255,t[13]=r>>>16&255,t[14]=r>>>8&255,t[15]=r&255,t}var ft,Kt=k(()=>{Ye();ft=vs});function ys(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}function gt(e,r,t){function n(o,s,i,c){if(typeof o=="string"&&(o=ys(o)),typeof s=="string"&&(s=ft(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+o.length);if(a.set(s),a.set(o,s.length),a=t(a),a[6]=a[6]&15|r,a[8]=a[8]&63|128,i){c=c||0;for(var u=0;u<16;++u)i[c+u]=a[u];return i}return Se(a)}try{n.name=e}catch(o){}return n.DNS=_s,n.URL=Ss,n}var _s,Ss,Vt=k(()=>{Qe();Kt();_s="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ss="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});function ws(e){if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=new Uint8Array(r.length);for(var t=0;t<r.length;++t)e[t]=r.charCodeAt(t)}return bs(Ts(Is(e),e.length*8))}function bs(e){for(var r=[],t=e.length*32,n="0123456789abcdef",o=0;o<t;o+=8){var s=e[o>>5]>>>o%32&255,i=parseInt(n.charAt(s>>>4&15)+n.charAt(s&15),16);r.push(i)}return r}function zr(e){return(e+64>>>9<<4)+14+1}function Ts(e,r){e[r>>5]|=128<<r%32,e[zr(r)-1]=r;for(var t=1732584193,n=-271733879,o=-1732584194,s=271733878,i=0;i<e.length;i+=16){var c=t,a=n,u=o,l=s;t=U(t,n,o,s,e[i],7,-680876936),s=U(s,t,n,o,e[i+1],12,-389564586),o=U(o,s,t,n,e[i+2],17,606105819),n=U(n,o,s,t,e[i+3],22,-1044525330),t=U(t,n,o,s,e[i+4],7,-176418897),s=U(s,t,n,o,e[i+5],12,1200080426),o=U(o,s,t,n,e[i+6],17,-1473231341),n=U(n,o,s,t,e[i+7],22,-45705983),t=U(t,n,o,s,e[i+8],7,1770035416),s=U(s,t,n,o,e[i+9],12,-1958414417),o=U(o,s,t,n,e[i+10],17,-42063),n=U(n,o,s,t,e[i+11],22,-1990404162),t=U(t,n,o,s,e[i+12],7,1804603682),s=U(s,t,n,o,e[i+13],12,-40341101),o=U(o,s,t,n,e[i+14],17,-1502002290),n=U(n,o,s,t,e[i+15],22,1236535329),t=F(t,n,o,s,e[i+1],5,-165796510),s=F(s,t,n,o,e[i+6],9,-1069501632),o=F(o,s,t,n,e[i+11],14,643717713),n=F(n,o,s,t,e[i],20,-373897302),t=F(t,n,o,s,e[i+5],5,-701558691),s=F(s,t,n,o,e[i+10],9,38016083),o=F(o,s,t,n,e[i+15],14,-660478335),n=F(n,o,s,t,e[i+4],20,-405537848),t=F(t,n,o,s,e[i+9],5,568446438),s=F(s,t,n,o,e[i+14],9,-1019803690),o=F(o,s,t,n,e[i+3],14,-187363961),n=F(n,o,s,t,e[i+8],20,1163531501),t=F(t,n,o,s,e[i+13],5,-1444681467),s=F(s,t,n,o,e[i+2],9,-51403784),o=F(o,s,t,n,e[i+7],14,1735328473),n=F(n,o,s,t,e[i+12],20,-1926607734),t=q(t,n,o,s,e[i+5],4,-378558),s=q(s,t,n,o,e[i+8],11,-2022574463),o=q(o,s,t,n,e[i+11],16,1839030562),n=q(n,o,s,t,e[i+14],23,-35309556),t=q(t,n,o,s,e[i+1],4,-1530992060),s=q(s,t,n,o,e[i+4],11,1272893353),o=q(o,s,t,n,e[i+7],16,-155497632),n=q(n,o,s,t,e[i+10],23,-1094730640),t=q(t,n,o,s,e[i+13],4,681279174),s=q(s,t,n,o,e[i],11,-358537222),o=q(o,s,t,n,e[i+3],16,-722521979),n=q(n,o,s,t,e[i+6],23,76029189),t=q(t,n,o,s,e[i+9],4,-640364487),s=q(s,t,n,o,e[i+12],11,-421815835),o=q(o,s,t,n,e[i+15],16,530742520),n=q(n,o,s,t,e[i+2],23,-995338651),t=B(t,n,o,s,e[i],6,-198630844),s=B(s,t,n,o,e[i+7],10,1126891415),o=B(o,s,t,n,e[i+14],15,-1416354905),n=B(n,o,s,t,e[i+5],21,-57434055),t=B(t,n,o,s,e[i+12],6,1700485571),s=B(s,t,n,o,e[i+3],10,-1894986606),o=B(o,s,t,n,e[i+10],15,-1051523),n=B(n,o,s,t,e[i+1],21,-2054922799),t=B(t,n,o,s,e[i+8],6,1873313359),s=B(s,t,n,o,e[i+15],10,-30611744),o=B(o,s,t,n,e[i+6],15,-1560198380),n=B(n,o,s,t,e[i+13],21,1309151649),t=B(t,n,o,s,e[i+4],6,-145523070),s=B(s,t,n,o,e[i+11],10,-1120210379),o=B(o,s,t,n,e[i+2],15,718787259),n=B(n,o,s,t,e[i+9],21,-343485551),t=we(t,c),n=we(n,a),o=we(o,u),s=we(s,l)}return[t,n,o,s]}function Is(e){if(e.length===0)return[];for(var r=e.length*8,t=new Uint32Array(zr(r)),n=0;n<r;n+=8)t[n>>5]|=(e[n/8]&255)<<n%32;return t}function we(e,r){var t=(e&65535)+(r&65535),n=(e>>16)+(r>>16)+(t>>16);return n<<16|t&65535}function Es(e,r){return e<<r|e>>>32-r}function ht(e,r,t,n,o,s){return we(Es(we(we(r,e),we(n,s)),o),t)}function U(e,r,t,n,o,s,i){return ht(r&t|~r&n,e,r,o,s,i)}function F(e,r,t,n,o,s,i){return ht(r&n|t&~n,e,r,o,s,i)}function q(e,r,t,n,o,s,i){return ht(r^t^n,e,r,o,s,i)}function B(e,r,t,n,o,s,i){return ht(t^(r|~n),e,r,o,s,i)}var Yr,Qr=k(()=>{Yr=ws});var As,Zr,Xr=k(()=>{Vt();Qr();As=gt("v3",48,Yr),Zr=As});function Ps(e,r,t){e=e||{};var n=e.random||(e.rng||ze)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var o=0;o<16;++o)r[t+o]=n[o];return r}return Se(n)}var be,en=k(()=>{Ft();Qe();be=Ps});function Cs(e,r,t,n){switch(e){case 0:return r&t^~r&n;case 1:return r^t^n;case 2:return r&t^r&n^t&n;case 3:return r^t^n}}function Gt(e,r){return e<<r|e>>>32-r}function Os(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var n=unescape(encodeURIComponent(e));e=[];for(var o=0;o<n.length;++o)e.push(n.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,i=Math.ceil(s/16),c=new Array(i),a=0;a<i;++a){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=e[a*64+l*4]<<24|e[a*64+l*4+1]<<16|e[a*64+l*4+2]<<8|e[a*64+l*4+3];c[a]=u}c[i-1][14]=(e.length-1)*8/Math.pow(2,32),c[i-1][14]=Math.floor(c[i-1][14]),c[i-1][15]=(e.length-1)*8&4294967295;for(var d=0;d<i;++d){for(var p=new Uint32Array(80),f=0;f<16;++f)p[f]=c[d][f];for(var g=16;g<80;++g)p[g]=Gt(p[g-3]^p[g-8]^p[g-14]^p[g-16],1);for(var h=t[0],y=t[1],T=t[2],w=t[3],b=t[4],v=0;v<80;++v){var I=Math.floor(v/20),E=Gt(h,5)+Cs(I,y,T,w)+b+r[I]+p[v]>>>0;b=w,w=T,T=Gt(y,30)>>>0,y=h,h=E}t[0]=t[0]+h>>>0,t[1]=t[1]+y>>>0,t[2]=t[2]+T>>>0,t[3]=t[3]+w>>>0,t[4]=t[4]+b>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var tn,rn=k(()=>{tn=Os});var js,nn,on=k(()=>{Vt();rn();js=gt("v5",80,tn),nn=js});var sn,an=k(()=>{sn="00000000-0000-0000-0000-000000000000"});function ks(e){if(!_e(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var cn,un=k(()=>{Ye();cn=ks});var dn={};Ar(dn,{NIL:()=>sn,parse:()=>ft,stringify:()=>Se,v1:()=>Hr,v3:()=>Zr,v4:()=>be,v5:()=>nn,validate:()=>_e,version:()=>cn});var Ze=k(()=>{Jr();Xr();en();on();an();un();Ye();Qe();Kt()});function Z(){try{document.cookie="cookietest=1; SameSite=Strict;";let e=document.cookie.split(";").some(r=>r.trim().startsWith("cookietest="));return document.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}function $t(){try{return!!window.localStorage}catch(e){return!0}}function Xe(){let e="__psm_test__";if(!$t())return!1;try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(r){return!1}}function ln(){let e=window,r="inner";"innerWidth"in window||(r="client",e=document.documentElement||document.body);let t=e[r+"Width"],n=e[r+"Height"];return t>=0&&n>=0?t+"x"+n:null}function pn(){let e=document.documentElement,r=document.body,t=r?Math.max(r.offsetHeight,r.scrollHeight):0,n=Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth),o=Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight,t);return isNaN(n)||isNaN(o)?[0,0]:[n,o]}function fn(){return window.screen.width+"x"+window.screen.height}function mt(e){let r="";if(e)return e;try{r=window.top.document.referrer}catch(t){if(window.parent)try{r=window.parent.document.referrer}catch(n){r=""}}return r===""&&(r=document.referrer),r}function gn(){let e=window.navigator.userAgent,r=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1&&e.indexOf("Chromium")===-1&&e.indexOf("CriOS")===-1&&e.indexOf("EdgiOS")===-1&&e.indexOf("FxiOS")===-1,t=(e.indexOf("Firefox")>-1||e.indexOf("FxiOS")>-1)&&e.indexOf("Seamonkey")===-1,n=(e.indexOf("Chrome")>-1||e.indexOf("CriOS")>-1)&&e.indexOf("Chromium")===-1&&e.indexOf("Edg")===-1&&e.indexOf("OPR")===-1,o=e.indexOf("Edg")>-1;switch(!0){case r:return"safari";case t:return"firefox";case n:return"chrome";case o:return"edge";default:return"unknown"}}function Be(e,r){let t=new RegExp("^[^#]*[?&]"+e+"=([^&#]*)").exec(r);return t?decodeURIComponent(t[1].replace(/\+/g," ")):null}var We=k(()=>{});var mn=G(hn=>{var Ce=256,yt=[],vt;for(;Ce--;)yt[Ce]=(Ce+256).toString(16).substring(1);function xs(){var e=0,r,t="";if(!vt||Ce+16>256){for(vt=Array(e=256);e--;)vt[e]=256*Math.random()|0;e=Ce=0}for(;e<16;e++)r=vt[Ce+e],e==6?t+=yt[r&15|64]:e==8?t+=yt[r&63|128]:t+=yt[r],e&1&&e>1&&e<11&&(t+="-");return Ce++,t}hn.v4=xs});var _t=G((Dc,yn)=>{"use strict";var Rs=Object.prototype.hasOwnProperty,Ds=String.prototype.charAt,Ms=Object.prototype.toString,Ls=function(e,r){return Ds.call(e,r)},Ht=function(r,t){return Rs.call(r,t)},Ns=function(r){return Ms.call(r)==="[object String]"},Us=function(r){return r!=null&&typeof r!="function"&&typeof r.length=="number"},vn=function(r,t){t=t||Ht;for(var n=[],o=0,s=r.length;o<s;o+=1)t(r,o)&&n.push(String(o));return n},Fs=function(r,t){t=t||Ht;var n=[];for(var o in r)t(r,o)&&n.push(String(o));return n},qs=function(r){return r==null?[]:Ns(r)?vn(r,Ls):Us(r)?vn(r,Ht):Fs(r)};yn.exports=qs});var Yt=G((Mc,zt)=>{"use strict";var Jt=_t(),Bs=(Ze(),Cr(dn)).v4,_n={_data:{},length:0,setItem:function(e,r){return this._data[e]=r,this.length=Jt(this._data).length,r},getItem:function(e){return e in this._data?this._data[e]:null},removeItem:function(e){return e in this._data&&delete this._data[e],this.length=Jt(this._data).length,null},clear:function(){this._data={},this.length=0},key:function(e){return Jt(this._data)[e]}};function Ws(){try{if(!window.localStorage)return!1;var e=Bs();window.localStorage.setItem(e,"test_value");var r=window.localStorage.getItem(e);return window.localStorage.removeItem(e),r==="test_value"}catch(t){return!1}}function Ks(){return Ws()?window.localStorage:_n}zt.exports.defaultEngine=Ks();zt.exports.inMemoryEngine=_n});var St=G((Lc,wn)=>{"use strict";var Vs=_t(),Sn=Object.prototype.toString,Gs=function(r){var t=typeof r;return t==="number"||t==="object"&&Sn.call(r)==="[object Number]"},$s=typeof Array.isArray=="function"?Array.isArray:function(r){return Sn.call(r)==="[object Array]"},Hs=function(r){return r!=null&&($s(r)||r!=="function"&&Gs(r.length))},Js=function(r,t){for(var n=0;n<t.length&&r(t[n],n,t)!==!1;n+=1);},zs=function(r,t){for(var n=Vs(t),o=0;o<n.length&&r(t[n[o]],n[o],t)!==!1;o+=1);},Ys=function(r,t){return(Hs(t)?Js:zs).call(this,r,t)};wn.exports=Ys});var An=G((Nc,En)=>{"use strict";var Qs=Yt().defaultEngine,bn=Yt().inMemoryEngine,Tn=St(),Zs=_t(),In=JSON;function Oe(e,r,t,n){this.id=r,this.name=e,this.keys=t||{},this.engine=n||Qs,this.originalEngine=this.engine}Oe.prototype.set=function(e,r){var t=this._createValidKey(e);if(t)try{this.engine.setItem(t,In.stringify(r))}catch(n){Xs(n)&&(this._swapEngine(),this.set(e,r))}};Oe.prototype.get=function(e){try{var r=this.engine.getItem(this._createValidKey(e));return r===null?null:In.parse(r)}catch(t){return null}};Oe.prototype.getOriginalEngine=function(){return this.originalEngine};Oe.prototype.remove=function(e){this.engine.removeItem(this._createValidKey(e))};Oe.prototype._createValidKey=function(e){var r=this.name,t=this.id;if(!Zs(this.keys).length)return[r,t,e].join(".");var n;return Tn(function(o){o===e&&(n=[r,t,e].join("."))},this.keys),n};Oe.prototype._swapEngine=function(){var e=this;Tn(function(r){var t=e.get(r);bn.setItem([e.name,e.id,r].join("."),t),e.remove(r)},this.keys),this.engine=bn};En.exports=Oe;function Xs(e){var r=!1;if(e.code)switch(e.code){case 22:r=!0;break;case 1014:e.name==="NS_ERROR_DOM_QUOTA_REACHED"&&(r=!0);break;default:break}else e.number===-2147024882&&(r=!0);return r}});var On=G((Uc,Cn)=>{"use strict";var ei=St(),ti=2,Pn={setTimeout:function(e,r){return window.setTimeout(e,r)},clearTimeout:function(e){return window.clearTimeout(e)},Date:window.Date},Ke=Pn,wt={ASAP:1,RESCHEDULE:2,ABANDON:3};function le(){this.tasks={},this.nextId=1}le.prototype.now=function(){return+new Ke.Date};le.prototype.run=function(e,r,t){var n=this.nextId++;return this.tasks[n]=Ke.setTimeout(this._handle(n,e,r,t||wt.ASAP),r),n};le.prototype.cancel=function(e){this.tasks[e]&&(Ke.clearTimeout(this.tasks[e]),delete this.tasks[e])};le.prototype.cancelAll=function(){ei(Ke.clearTimeout,this.tasks),this.tasks={}};le.prototype._handle=function(e,r,t,n){var o=this,s=o.now();return function(){if(delete o.tasks[e],n>=wt.RESCHEDULE&&s+t*ti<o.now()){n===wt.RESCHEDULE&&o.run(r,t,n);return}return r()}};le.setClock=function(e){Ke=e};le.resetClock=function(){Ke=Pn};le.Modes=wt;Cn.exports=le});var kn=G((Fc,jn)=>{jn.exports=D;function D(e){return D.enabled(e)?function(r){r=ri(r);var t=new Date,n=t-(D[e]||t);D[e]=t,r=e+" "+r+" +"+D.humanize(n),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}D.names=[];D.skips=[];D.enable=function(e){try{localStorage.debug=e}catch(o){}for(var r=(e||"").split(/[\s,]+/),t=r.length,n=0;n<t;n++)e=r[n].replace("*",".*?"),e[0]==="-"?D.skips.push(new RegExp("^"+e.substr(1)+"$")):D.names.push(new RegExp("^"+e+"$"))};D.disable=function(){D.enable("")};D.humanize=function(e){var r=1e3,t=60*1e3,n=60*t;return e>=n?(e/n).toFixed(1)+"h":e>=t?(e/t).toFixed(1)+"m":e>=r?(e/r|0)+"s":e+"ms"};D.enabled=function(e){for(var r=0,t=D.skips.length;r<t;r++)if(D.skips[r].test(e))return!1;for(var r=0,t=D.names.length;r<t;r++)if(D.names[r].test(e))return!0;return!1};function ri(e){return e instanceof Error?e.stack||e.message:e}try{window.localStorage&&D.enable(localStorage.debug)}catch(e){}});var xn=G((qc,Qt)=>{typeof Qt<"u"&&(Qt.exports=H);function H(e){if(e)return ni(e)}function ni(e){for(var r in H.prototype)e[r]=H.prototype[r];return e}H.prototype.on=H.prototype.addEventListener=function(e,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(r),this};H.prototype.once=function(e,r){function t(){this.off(e,t),r.apply(this,arguments)}return t.fn=r,this.on(e,t),this};H.prototype.off=H.prototype.removeListener=H.prototype.removeAllListeners=H.prototype.removeEventListener=function(e,r){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+e];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,o=0;o<t.length;o++)if(n=t[o],n===r||n.fn===r){t.splice(o,1);break}return t.length===0&&delete this._callbacks["$"+e],this};H.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var r=new Array(arguments.length-1),t=this._callbacks["$"+e],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,o=t.length;n<o;++n)t[n].apply(this,r)}return this};H.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};H.prototype.hasListeners=function(e){return!!this.listeners(e).length}});var tr=G((Bc,Rn)=>{"use strict";var et=mn().v4,Xt=An(),er=St(),Ve=On(),oi=kn()("localstorage-retry"),si=xn();function Zt(e,r){return function(){return e.apply(r,arguments)}}function J(e,r,t){typeof r=="function"&&(t=r),this.name=e,this.id=et(),this.fn=t,this.maxItems=r.maxItems||1/0,this.maxAttempts=r.maxAttempts||1/0,this.backoff={MIN_RETRY_DELAY:r.minRetryDelay||1e3,MAX_RETRY_DELAY:r.maxRetryDelay||3e4,FACTOR:r.backoffFactor||2,JITTER:r.backoffJitter||0},this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500},this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack"},this._schedule=new Ve,this._processId=0,this._store=new Xt(this.name,this.id,this.keys),this._store.set(this.keys.IN_PROGRESS,{}),this._store.set(this.keys.QUEUE,[]),this._ack=Zt(this._ack,this),this._checkReclaim=Zt(this._checkReclaim,this),this._processHead=Zt(this._processHead,this),this._running=!1}si(J.prototype);J.prototype.start=function(){this._running&&this.stop(),this._running=!0,this._ack(),this._checkReclaim(),this._processHead()};J.prototype.stop=function(){this._schedule.cancelAll(),this._running=!1};J.prototype.shouldRetry=function(e,r){return!(r>this.maxAttempts)};J.prototype.getDelay=function(e){var r=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,e);if(this.backoff.JITTER){var t=Math.random(),n=Math.floor(t*this.backoff.JITTER*r);Math.floor(t*10)<5?r-=n:r+=n}return Number(Math.min(r,this.backoff.MAX_RETRY_DELAY).toPrecision(1))};J.prototype.addItem=function(e){this._enqueue({item:e,attemptNumber:0,time:this._schedule.now(),id:et()})};J.prototype.requeue=function(e,r,t,n){this.shouldRetry(e,r,t)?this._enqueue({item:e,attemptNumber:r,time:this._schedule.now()+this.getDelay(r),id:n||et()}):this.emit("discard",e,r)};J.prototype._enqueue=function(e){var r=this._store.get(this.keys.QUEUE)||[];r=r.slice(-(this.maxItems-1)),r.push(e),r=r.sort(function(t,n){return t.time-n.time}),this._store.set(this.keys.QUEUE,r),this._running&&this._processHead()};J.prototype._processHead=function(){var e=this,r=this._store;this._schedule.cancel(this._processId);var t=r.get(this.keys.QUEUE)||[],n=r.get(this.keys.IN_PROGRESS)||{},o=this._schedule.now(),s=[];function i(l,d){s.push({item:l.item,done:function(f,g){var h=r.get(e.keys.IN_PROGRESS)||{};delete h[d],r.set(e.keys.IN_PROGRESS,h),e.emit("processed",f,g,l.item),f&&e.requeue(l.item,l.attemptNumber+1,f,l.id)}})}for(var c=Object.keys(n).length;t.length&&t[0].time<=o&&c++<e.maxItems;){var a=t.shift(),u=et();n[u]={item:a.item,attemptNumber:a.attemptNumber,time:e._schedule.now()},i(a,u)}r.set(this.keys.QUEUE,t),r.set(this.keys.IN_PROGRESS,n),er(function(l){try{e.fn(l.item,l.done)}catch(d){oi("Process function threw error: "+d)}},s),t=r.get(this.keys.QUEUE)||[],this._schedule.cancel(this._processId),t.length>0&&(this._processId=this._schedule.run(this._processHead,t[0].time-o,Ve.Modes.ASAP))};J.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now()),this._store.set(this.keys.RECLAIM_START,null),this._store.set(this.keys.RECLAIM_END,null),this._schedule.run(this._ack,this.timeouts.ACK_TIMER,Ve.Modes.ASAP)};J.prototype._checkReclaim=function(){var e=this;function r(n){n.set(e.keys.RECLAIM_START,e.id),n.set(e.keys.ACK,e._schedule.now()),e._schedule.run(function(){n.get(e.keys.RECLAIM_START)===e.id&&(n.set(e.keys.RECLAIM_END,e.id),e._schedule.run(function(){n.get(e.keys.RECLAIM_END)===e.id&&n.get(e.keys.RECLAIM_START)===e.id&&e._reclaim(n.id)},e.timeouts.RECLAIM_WAIT,Ve.Modes.ABANDON))},e.timeouts.RECLAIM_WAIT,Ve.Modes.ABANDON)}function t(n){for(var o=[],s=e._store.getOriginalEngine(),i=0;i<s.length;i++){var c=s.key(i),a=c.split(".");a.length===3&&a[0]===n&&a[2]==="ack"&&o.push(new Xt(n,a[1],e.keys))}return o}er(function(n){n.id!==e.id&&(e._schedule.now()-n.get(e.keys.ACK)<e.timeouts.RECLAIM_TIMEOUT||r(n))},t(this.name)),this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER,Ve.Modes.RESCHEDULE)};J.prototype._reclaim=function(e){var r=this,t=new Xt(this.name,e,this.keys),n={queue:this._store.get(this.keys.QUEUE)||[]},o={inProgress:t.get(this.keys.IN_PROGRESS)||{},queue:t.get(this.keys.QUEUE)||[]},s=[],i=function(c,a){er(function(u){var l=u.id||et();s.indexOf(l)>=0?r.emit("duplication",u.item,u.attemptNumber):(n.queue.push({item:u.item,attemptNumber:u.attemptNumber+a,time:r._schedule.now(),id:l}),s.push(l))},c)};i(o.queue,0),i(o.inProgress,1),n.queue=n.queue.sort(function(c,a){return c.time-a.time}),this._store.set(this.keys.QUEUE,n.queue),t.remove(this.keys.IN_PROGRESS),t.remove(this.keys.QUEUE),t.remove(this.keys.RECLAIM_START),t.remove(this.keys.RECLAIM_END),t.remove(this.keys.ACK),this._processHead()};Rn.exports=J});var Hn={};Ar(Hn,{getAdsGUID:()=>li,getAdsTransactionId:()=>di,getAttUuid:()=>xe,getCnnUid:()=>Te,getContentMetadata:()=>sr,getConvivaId:()=>De,getEcid:()=>Re,getEurosportUser:()=>Gn,getKruxId:()=>ke,getMParticleId:()=>Vn,getMetadataPropValue:()=>or,getOptanonConsentCookie:()=>It,getPermutiveId:()=>$n,getZionId:()=>Me,hydratePayload:()=>Ie});function di(){return typeof window.turner_getTransactionId=="function"?window.turner_getTransactionId():null}function li(){return Z()?S.get("ug"):null}function Vn(){var e,r;return Z()&&((r=(e=window==null?void 0:window.mParticle)==null?void 0:e.Identity)==null?void 0:r.getCurrentUser().getMPID())||null}function Gn(){if(Z()){let e=S.get("eurosport_user");if(!e)return null;let r=e.profileId||null,t=e.userId||null;return{eurosport_user:e,profileId:r,userId:t}}return null}function $n(){return Xe()?localStorage.getItem("permutive-id"):null}function ke(){return Xe()?window.localStorage.getItem("kxkuid"):Z()?S.get("kxkuid"):null}function xe(){if(Z()){let e=S.get("firstpartyuid");return e&&typeof e=="object"&&"id"in e?e.id:null}return null}function It(){let e=null;return Z()&&(e=S.get("OptanonConsent")),e}function pi(e){let r=S.get("AMCV_7FF852E2556756057F000101@AdobeOrg");if(r){let t=r.split("|"),n=t.indexOf(e);if(n!=-1){let o=n+1;return t[o]}}return null}function Re(){let e=S.get("s_ecid"),r=S.get("s_vi");return e||r||pi("MCMID")}function Te(){let e=null,r=null;if(Xe()&&(r=window.localStorage.getItem("zion.cnn_uid"),r))try{r=JSON.parse(r),e=r.id}catch(t){window.location.search.includes("wmpsm_debug")}return e}function De(){if(Xe()){let e=["Conviva/sdkConfig","Conviva.sdkConfig","top-player::Conviva.sdkConfig"],r=null;for(let t=0;t<e.length;t++)if(r=window.localStorage.getItem(e[t]),r)try{return JSON.parse(r).clId}catch(n){window.location.search.includes("wmpsm_debug")}}return null}function Me(){let e=null;if(window.ZionMessageBus){let t=window.ZionMessageBus.getInstance().watching.id_found.messageQueue;if(t&&t instanceof Array){let n=t.find(o=>{var i;let s=(i=o.message)==null?void 0:i.type;if(typeof s=="string")return s.toLowerCase()==="zaid"});e=n?n.message.value:null}}return e}function or(e,r){let t=null;if(e)for(let n of e){if(typeof n!="string")continue;r&&(n=n.replace(/^data/,r));let o=n.match(/[^.[\]()]+/g);for(let s=0;s<o.length;s++)if(s===0&&(t=window),t=t[o[s]],typeof t=="function"&&(t=t()),typeof t>"u"){t=null;break}if(t)return t}return t}function sr(e,r){let t={};return e&&e[r]&&e[r].forEach(n=>{let o=or(n.staticLocations);o||(o=or(n.dynamicLocations,"psmPubSubData."+r)),t[n.name]=o}),t}var Ie,Et=k(()=>{ye();We();st();de();Ie=(e,r)=>{let t=Gn(),{eurosport_user:n,profileId:o,userId:s}=t||{},i=pn(),c=e.coppaPrivacyMode==="ALL_ID"?{attuuid:xe(),cdpid:e.getCDPID(),cnnuid:Te(),convivaid:De(),ecid:Re(),eurosport_user:n,kruxid:ke(),liverampatsid:S.get("tok_lr"),mpid:Vn(),["permutive-id"]:$n(),profileId:o,tradedeskuid:S.get("tok_ttuid"),userId:s,wminid:S.get("wminid"),zionid:Me()}:{};r.setPlatform(e.config.platform),r.addEntry("companyName","WarnerMedia"),r.setBrand(e.config.brand),r.setSubBrand(e.config.subBrand),r.setProductName(e.config.productName),r.setLibrary({name:"PrismJS",version:Fe.version,initConfig:e.config}),r.setDevice({type:window.navigator.platform,userAgent:window.navigator.userAgent,totalWidth:i[0],totalHeight:i[1],screenResolution:fn(),viewportSize:ln()}),r.setNavigationProperties({url:window.location.href,rootDomain:dt(window.location.href),referrer:mt(),path:window.location.pathname,search:window.location.search,title:window.document.title}),r.setClientResolvedIp(e.location.ip_address),r.setLocation({city:e.location.states[0].cities[0],state:e.location.states[0].state,country:e.location.country,zip:e.location.states[0].zipcodes[0],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||null,locale:window.navigator.language,language:window.navigator.language.split("-")[0]||null}),r.setConsentProperties({uspString:S.get("usprivacy"),consentRule:e.consentRule,optanonConsent:It(),psmPrivacyMode:e.coppaPrivacyMode}),r.setIABCategories({consentCategories:e.consentCategories}),r.setWMUKID(e.wmukid),r.setEventProperties({cookiesEnabled:Z(),doNotTrack:!!(window.navigator.doNotTrack||window.doNotTrack),featureFlagValues:e.getFlags(),cookies:S.getAll(),automatedTest:e.config.psmEnvironment==="AUTOMATED_TEST"}),r.setSessionProperties(e.session),r.setThirdPartyIds(c),r.setContentMetadata({page:sr(e.config.contentMetadata,"page"),video:sr(e.config.contentMetadata,"video")})}});var Eo=G(x=>{"use strict";x.__esModule=!0;x.COPPAPrivacyModesEnum=x.BrandsEnum=x.EnvNames=x.PlayerMediaStates=x.ResponseHandlers=x.ResponseStatusCodes=void 0;var Oa;(function(e){e[e.Code201Created=201]="Code201Created",e[e.Code400BadRequest=400]="Code400BadRequest",e[e.Code999Test=999]="Code999Test"})(Oa=x.ResponseStatusCodes||(x.ResponseStatusCodes={}));var ja;(function(e){e.Success="Success",e.Failure="Failure",e.Retry="Retry"})(ja=x.ResponseHandlers||(x.ResponseHandlers={}));var ka;(function(e){e.PLAYING="playing",e.PENDING="pending"})(ka=x.PlayerMediaStates||(x.PlayerMediaStates={}));var xa;(function(e){e.PROD="PROD",e.DEV="DEV",e.INTEGRATION="INTEGRATION",e.QA="TEST"})(xa=x.EnvNames||(x.EnvNames={}));var Ra;(function(e){e.TBS="TBS",e.CNN="CNN",e.CartoonNetwork="CartoonNetwork",e.AdultSwim="AdultSwim",e.TNT="TNT",e.truTV="truTV",e.TCM="TCM",e.BR="BR",e.NCAA="NCAA",e.WMInternalEvents="WMInternalEvents",e.MML="MML",e.WMSpecialEvents="WMSpecialEvents",e.psmInvalidType="psmInvalidType"})(Ra=x.BrandsEnum||(x.BrandsEnum={}));var Da;(function(e){e.ALL_ID="ALL_ID",e.ZERO_ID="ZERO_ID"})(Da=x.COPPAPrivacyModesEnum||(x.COPPAPrivacyModesEnum={}))});var Po=G(Ao=>{"use strict";Ao.__esModule=!0});var Oo=G(Co=>{"use strict";Co.__esModule=!0});var ko=G(jo=>{"use strict";jo.__esModule=!0});var xo=G(se=>{"use strict";var Ma=se&&se.__createBinding||(Object.create?function(e,r,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);(!o||("get"in o?!r.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){n===void 0&&(n=t),e[n]=r[t]}),Rt=se&&se.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&Ma(r,e,t)};se.__esModule=!0;Rt(Eo(),se);Rt(Po(),se);Rt(Oo(),se);Rt(ko(),se)});st();de();ye();var Ut=class{constructor(){this.ready=!1;this.config={appId:Or,platform:"web",brand:"",psmBrandToken:"",subBrand:"",productName:"",psmEnvironment:void 0,psmPlatform:"",psmTelEnabled:!0};this.consentRule="Other";this.flags=[];this.location={asn:{id:"",name:""},continent:"",continentName:"",country:"",country_alpha2:"",country_alpha3:"",ip_address:"",lat:"",lon:"",proxy:null,states:[{cities:[],counties:[],state:"",zipcodes:[]}]};this.timezone=null;this.wmukid="Unknown";this.cdpid=null}getVersion(){return Fe.version}getConfig(){return this.config}getBrand(){return this.config.brand}getBrandToken(){return this.config.psmBrandToken}getSubBrand(){return this.config.subBrand}getCoppaPrivacyMode(){return this.coppaPrivacyMode}setCoppaPrivacyMode(r){this.coppaPrivacyMode=r,S.set("PsmCoppaPrivacyMode",r,{secure:!0}),window.WM.PSM.initPsm(this.config)}getCoreWMUKID(){return this.wmukid}setCoreWMUKID(r){this.wmukid=r}getSessionProperties(){return this.session}validateConfig(r){let t=[];if(this.hasProperty("psmEnvironment",r)||t.push("Please specify your psmEnvironment."),this.hasProperty("brand",r)||t.push("Please specify your brand."),t.length)throw new Error(["[PSM]: Invalid configuration provided."].concat(t).join(`
`))}hasProperty(r,t){return Object.prototype.hasOwnProperty.call(t,r)}getLocationProperties(){return{city:this.location.states[0].cities[0],state:this.location.states[0].state,country:this.location.country,zip:this.location.states[0].zipcodes[0],timezone:this.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone,locale:"locale",language:"language"}}initCoppaPrivacyMode(){let r="ALL_ID";xr.includes(this.config.subBrand)&&(r="ZERO_ID");let t=S.get("PsmCoppaPrivacyMode");t!=="ALL_ID"&&t!=="ZERO_ID"&&(t=null,S.remove("PsmCoppaPrivacyMode")),this.coppaPrivacyMode=t!=null?t:r}},Kr=Ut;Ze();ye();We();de();var Dn=Lt(tr());de();We();var bt=class extends Error{constructor(t){let{request:n,url:o,opts:s}=t,i=n.responseText?n.responseText:"network failure";super(i);this.context={url:o,code:n.status,headers:s.headers,method:s.method}}};function pe(e,r={}){return new Promise((t,n)=>{let o=new XMLHttpRequest;o.open(r.method||"get",e),o.onload=()=>{if((o.status/100|0)==2)try{t(JSON.parse(o.responseText))}catch(s){t(o.responseText)}else n(new bt({request:o,url:e,opts:r}))},o.onerror=()=>{n(new bt({request:o,url:e,opts:r}))};for(let s in r.headers)o.setRequestHeader(s,r.headers[s]);o.send(r.body||null)})}st();var rr,$e,Ge;function Mn(e){$e=e.config.psmEnvironment?e.config.psmEnvironment.toUpperCase():"PROD",Ge=e,rr=new Dn.default("logger",at,(r,t)=>{if(/bot|crawl|spider/i.test(window.navigator.userAgent))return t(null,{});r.ts=new Date().toISOString(),pe($.logs[$e],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(n=>t(null,n)).catch(n=>t(n))}),rr.start()}function nr(e,r){let t,n,o;e.err?(t=e.err.toString(),n=e.err.stack,o=e.err.context||{}):(t=e.message,o=e.context);let s={brand:Ge.config.brand,device:{type:window.navigator.platform,userAgent:window.navigator.userAgent},eventName:r,eventProperties:{logMessage:t,method:e.methodName,featureFlagValues:Ge.getFlags(),stackTrace:n},eventType:"log",eventTimestamp:new Date().toISOString(),library:{name:"PrismJS",version:Fe.version,initConfig:Ge.config},platform:"web",session:Ge.session,wmukid:Ge.wmukid},i=$t()&&window.localStorage.getItem("wmpsm_debug")=="true",c=window.location.search.includes("wmpsm_debug");return r!=="debug"&&(i||c||$e==="AUTOMATED_TEST"?$e==="AUTOMATED_TEST"?console[r](`[PSM]: ${r}:`,JSON.stringify(s.eventProperties)):console[r](`[PSM]: ${r}:`,s):s.eventProperties.featureFlagValues["doppler-send-logs"]&&rr.addItem(s)),s}function je(e){return nr(e,"info")}function P(e){return nr(e,"debug")}function Ln(e){return nr(e,"warn")}ye();var ii=/^[1][nNyY-][nNyY-][nNyY-]$/,Tt=class{constructor(){this.version=1,this.baseString=null}getUSPrivacyString(){return this.baseString}getVersion(){return this.version}setUSPrivacyString(r){let t=!1;if(ii.test(r)){this.baseString=r,this.version=Number(r[0]);let n={version:Number(r[0]),uspString:r};S.set("usprivacy",r),S.set("uspData",n),t=!0}return t}};de();ye();var Xc=new Tt;function Nn(e){let r=null,t;for(t=window;t;t=t.parent){try{if(t.frames&&t.frames[e]){r=t;break}}catch(n){throw new Error(n)}if(t===window.top)break}return r}function Un(e){return new Promise(r=>{var t,n;try{let s=R({},{1:"data-store",2:"ads-contextual",3:"ads-person-prof",4:"ads-person",5:"content-person-prof",6:"consent-person",7:"measure-ads",8:"measure-content",9:"measure-market",10:"product-develop"});if(e==="Bleacher Report"&&(delete s[5],delete s[6],delete s[8]),typeof(window==null?void 0:window.__tcfapi)=="function"){window.__tcfapi("getTCData",2,(i,c)=>{if(c&&"purpose"in i&&"legitimateInterests"in i.purpose){let a=R(R({},i.purpose.legitimateInterests||{}),i.purpose.consents||{}),u=[],l=!0;Object.entries(s).forEach(([d,p])=>{a[d]?u.push({[p]:a[d]}):(u.push({[p]:!1}),l=!1)}),r({shouldLoad:l,categories:u.concat([{"special-purpose-1":!0},{"special-purpose-2":!0},{"feature-1":!0},{"feature-2":!0},{"feature-3":!0}])})}else r({shouldLoad:!1,categories:[]})});return}if(typeof((n=(t=window==null?void 0:window.WBD)==null?void 0:t.UserConsent)==null?void 0:n.inUserConsentState)=="function"){let i=Ue(R({},s),{11:"targeting",12:"3p-targeting",13:"performance",14:"functional"}),c=Object.values(i),a=Object.values(i).map(l=>({[l]:!0})),u=window.WBD.UserConsent.inUserConsentState(c)===!0;r({shouldLoad:u,categories:u?a:[]});return}if(typeof(window==null?void 0:window.OnetrustActiveGroups)=="string"){let i=["tc","fc","pf"],c=["tc","fc","pc"],a=["tc","ftc","pfc"],u=["C0002","C0003","C0004"],l=[{Targeting:!0},{Functional:!0},{Performance:!0}],d=window.OnetrustActiveGroups.trim()?window.OnetrustActiveGroups.trim().split(","):[],p=i.every(f=>d.includes(f))||c.every(f=>d.includes(f))||a.every(f=>d.includes(f))||u.every(f=>d.includes(f));r({shouldLoad:p,categories:p?l:[]});return}r({shouldLoad:!1,categories:[]})}catch(o){console.log("[PSM]: Error encountered during consent check",o),r({shouldLoad:!1,categories:[]})}})}de();var X="",O="",W="";function ai(e){switch(e){case"Samsung TV":return!1;case"Vizio TV":return!1;case"LG TV":return!1;default:return!0}}function Bn(e){return/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)}function ci(){let e=Be("utm_term",window.location.href),r=new RegExp(/cdpid_([0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12})/i).exec(e),t=null;return r&&(t=r[1]),t}function Fn(e,r){Bn(e)?(W=ci()||e,S.set("CDPID",JSON.stringify({cdpId:W,wmukId:r}),{samesite:"None",secure:!0,encode:!1})):P({message:`CDPID value ${JSON.stringify(W)} is invalid. Returning without updating`,methodName:"updateCdpData",eventType:"cdpid"})}function ui(e,r){let t=document.createElement("iframe");t.setAttribute("id",e),t.setAttribute("style","display:none"),t.setAttribute("src",r),document.body.appendChild(t)}var qn=e=>e.split(";").map(r=>r.split("=")).reduce((r,t)=>(r[decodeURIComponent(t[0].trim())]=decodeURIComponent(t[1].trim()),r),{});function Wn(e,r,t){return Z()?(X=r?qn(document.cookie).WMUKID:S.get("WMUKID"),O=r?qn(document.cookie).WMUKID_STABLE:S.get("WMUKID_STABLE"),P({message:`[PSM]: Cookies enabled. Retrieving ID values
    WMUKID: ${JSON.stringify(X)}
    WMUKID_STABLE: ${O}
    `,methodName:"initIdentity",eventType:"identity"}),O==null&&(X==null?(O=be(),P({message:`WMUKID and WMUKID_STABLE cookies not found. Generating WMUKID_STABLE value: ${O}`,methodName:"initIdentity",eventType:"identity"})):typeof X=="object"&&"id"in X?(O=X.id,P({message:`Legacy WMUKID value ${X.id} found. Setting WMUKID_STABLE value: ${O}`,methodName:"initIdentity",eventType:"identity"})):(O=X,P({message:`WMUKID string value ${X} found. Setting WMUKID_STABLE value: ${O}`,methodName:"initIdentity",eventType:"identity"}))),P({message:`Setting WMUKID_STABLE cookie to ${O}. Cookie options: ${JSON.stringify(S.options())}`,methodName:"initIdentity",eventType:"identity"}),e==="ZERO_ID"?r?(document.cookie=`WMUKID_STABLE=${O}; max-age=0; SameSite=None; Secure`,document.cookie=`dateid=${X}; max-age=0; SameSite=None; Secure`):(S.set("WMUKID_STABLE",O,S.options({maxage:0,secure:t!=="AUTOMATED_TEST"})),S.set("datid",O,S.options({maxage:0,secure:t!=="AUTOMATED_TEST"}))):r?(document.cookie=`WMUKID_STABLE=${O}; SameSite=None; Secure`,document.cookie=`dateid=${X}; SameSite=None; Secure`):(S.set("WMUKID_STABLE",O,S.options({secure:t!=="AUTOMATED_TEST"})),S.set("datid",O,S.options({secure:t!=="AUTOMATED_TEST"}))),O):""}function Kn(e,r){return new Promise(t=>{if(window==null||window.addEventListener("message",n=>{n.origin===$.lightningOrigin&&(P({message:`Updating CDPID from iFrame value: ${JSON.stringify(n.data)}`,methodName:"initIdentity",eventType:"message"}),Fn(n.data,O),t(n.data))},!1),Z()){W=S.get("CDPID");let n=W&&typeof W=="object"&&"cdpId"in W&&Bn(W.cdpId);if(P({message:`[PSM]: Cookies enabled. Retrieving ID values
    CDPID: ${JSON.stringify(W)}
    `,methodName:"initIdentity",eventType:"identity"}),W===null||!n)Nn("prism_toolkit")===null&&(ai(r)?ui("prism_toolkit",$.lightningOrigin+$.iFramePath[e]):t(""));else if(typeof W=="object"&&"cdpId"in W&&"wmukId"in W&&n){let o=W.cdpId,s=W.wmukId;O!==s?(P({message:`Updating CDPID value ${o} with WMUKID: ${O}`,methodName:"initIdentity",eventType:"cdpid"}),Fn(o,O)):P({message:`CDPID cookie has already been set to value ${JSON.stringify(W)}. To start a new test, delete the CDPID cookie on this domain and lightning.warnermediacdn.com.`,methodName:"initIdentity",eventType:"cdpid"}),t(o)}}})}ye();de();Et();We();var fi=e=>e.split(";").map(r=>r.split("=")).reduce((r,t)=>(r[decodeURIComponent(t[0].trim())]=decodeURIComponent(t[1].trim()),r),{}),Jn=e=>{let r=window;return r.WM=r.WM||{},r.WM.PSM=r.WM.PSM||{},{psmObject:r.WM.PSM,initWMUKID:Wn,initCDPID:Kn,getWMUKID:n=>n?fi(document.cookie).WMUKID_STABLE||"Unknown":S.get("WMUKID_STABLE")||"Unknown",getCDPID:()=>{let n=S.get("CDPID");return n&&typeof n=="object"&&"cdpId"in n&&"wmukId"in n?n.cdpId:n||"Unknown"},getConsentProperties:()=>({uspString:S.get("usprivacy"),consentRule:e.consentRule,optanonConsent:It()||"",psmPrivacyMode:e.coppaPrivacyMode}),resolveAuthTokens:async(n,o,s)=>{if(!s.queryFlag("auth-service"))return P({message:"[PSM]: auth-service flag is disabled",methodName:"resolveAuthTokens",eventType:"authService"}),!1;let i=!0,c=!1;if(!o.get("usprivacy"))return!1;let u=o.get("resolveAuthTimestamp"),l=!0;if(u){let C=new Date(u),A=(Date.now()-C.getTime())/1e3/60/60;A<24&&(je({message:`Resolve Auth Token lifespan, ${A}, less than 24 hours`,methodName:"resolveAuthTokens",eventType:"authService"}),l=!1)}let d=o.get("resolveDisplayTimestamp"),p=!0;if(d){let C=new Date(d),A=(Date.now()-C.getTime())/1e3/60/60;A<24&&(je({message:`Resolve Display Token lifespan, ${A}, less than 24 hours`,methodName:"resolveAuthTokens",eventType:"authService"}),p=!1)}let f,g,h,y,T,w=o.get("tok_lr"),b=o.get("glp_ggw"),v=o.get("tok_lr2");v&&(f={provider:"Liveramp ATS",details:{id:v}},i=!1,c=!0);let I=Be("bt_ts",window.location.href),E=Be("utm_term",window.location.href);if(I&&E){let C=(Date.now()-parseInt(I))/1e3/60/60;if(C>24)return je({message:`bt_ts Parameter lifespan, ${C}, greater than 24 hours`,methodName:"resolveAuthTokens",eventType:"authService"}),!1;g={provider:"zeta",details:{id:E}}}let j=Be("primo",window.location.href);j&&(h={provider:"braze",details:{id:j}});let ie=Te();if(ie&&(y={provider:"cnnAuthentication",details:{id:ie}}),b&&(T={provider:"tradedesk",details:{id:b}}),w&&o.remove("tok_lr"),(!l||l&&!v&&(!E||!I)&&!j&&!ie)&&!p)return P({message:"[PSM]: No token information present",methodName:"resolveAuthTokens",eventType:"authService"}),!1;let Y=[];if(f!=null&&f.provider&&Y.push(f),g!=null&&g.provider&&Y.push(g),h!=null&&h.provider&&Y.push(h),y!=null&&y.provider&&Y.push(y),T!=null&&T.provider&&Y.push(T),l&&Y.length>0){let C={wmukid:s.getWMUKID(),brand:s.config.brand,ids:{attuuid:xe(),cdpid:s.getCDPID(),convivaid:De(),ecid:Re(),kruxid:ke(),wminid:o.get("wminid"),zionid:Me(),cnnuid:Te()},location:s.getLocationProperties(),consentProperties:{usp:o.get("usprivacy")},authentication:Y};try{let A=await pe($.authSvc[s.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),{tokens:V}=A,M=V.filter(re=>re.provider==="liveramp")[0];M&&(o.set("tok_lr",M.token,{expires:new Date(M.expiration)}),o.set("tok_lr2",M.token,{expires:new Date(M.expiration)}));let ae=V.filter(re=>re.provider==="tradedesk")[0];ae&&o.set("glp_ggw",ae.token,{expires:new Date(ae.expiration)}),o.set("resolveAuthTimestamp",new Date)}catch(A){P({err:A,eventType:"authService",methodName:"resolveAuthTokens"})}}if(p){let C={provider:"wmukid",details:{id:s.getWMUKID()}},A={wmukid:s.getWMUKID(),brand:s.config.brand,ids:{attuuid:xe(),cdpid:s.getCDPID(),convivaid:De(),ecid:Re(),kruxid:ke(),wminid:o.get("wminid"),zionid:Me(),cnnuid:Te()},location:s.getLocationProperties(),consentProperties:{usp:o.get("usprivacy")},authentication:[C]};try{let V=await pe($.authSvc[s.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),{tokens:M}=V,ae=M.filter(me=>me.provider==="liveramp")[0];ae&&o.set("tok_lr3",ae.token,{expires:new Date(ae.expiration)});let re=M.filter(me=>me.provider==="tradedesk")[0];re&&o.set("glp_ggw2",re.token,{expires:new Date(re.expiration)});let ce=M.filter(me=>me.provider==="pairId")[0];ce&&(o.set("pairId",ce.token,{expires:new Date(ce.expiration)}),P({message:`[PSM]: pairID token saved as cookie with value: ${ce.token}`,methodName:"resolveAuthTokens",eventType:"pairID"}))}catch(V){P({err:V,eventType:"authService",methodName:"resolveAuthTokens (new request)"})}o.set("resolveDisplayTimestamp",new Date)}return s.setSessionProperties(),Ie(s,n),i&&n.trackTokenEvent("new token",new Date().toISOString(),C=>{s.queryFlag("doppler-send-token-event")&&(s.requestQueue.addItem(C),s.resetNewSessionFields())}),c&&n.trackTokenEvent("token updated",new Date().toISOString(),C=>{s.queryFlag("doppler-send-token-event")&&(s.requestQueue.addItem(C),s.resetNewSessionFields())}),!0},platform:window.navigator.platform}};ye();Ze();var gi=Object.create,eo=Object.defineProperty,hi=Object.getOwnPropertyDescriptor,to=Object.getOwnPropertyNames,mi=Object.getPrototypeOf,vi=Object.prototype.hasOwnProperty,m=(e,r)=>function(){return r||(0,e[to(e)[0]])((r={exports:{}}).exports,r),r.exports},yi=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of to(r))!vi.call(e,o)&&o!==t&&eo(e,o,{get:()=>r[o],enumerable:!(n=hi(r,o))||n.enumerable});return e},_i=(e,r,t)=>(t=e!=null?gi(mi(e)):{},yi(r||!e||!e.__esModule?eo(t,"default",{value:e,enumerable:!0}):t,e)),ne=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/fails.js"(e,r){"use strict";r.exports=function(t){try{return!!t()}catch(n){return!0}}}}),ro=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/function-bind-native.js"(e,r){"use strict";var t=ne();r.exports=!t(function(){var n=function(){}.bind();return typeof n!="function"||n.hasOwnProperty("prototype")})}}),oe=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/function-uncurry-this.js"(e,r){"use strict";var t=ro(),n=Function.prototype,o=n.call,s=t&&n.bind.bind(o,o);r.exports=t?s:function(i){return function(){return o.apply(i,arguments)}}}}),Si=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/classof-raw.js"(e,r){"use strict";var t=oe(),n=t({}.toString),o=t("".slice);r.exports=function(s){return o(n(s),8,-1)}}}),wi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/indexed-object.js"(e,r){"use strict";var t=oe(),n=ne(),o=Si(),s=Object,i=t("".split);r.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(c){return o(c)==="String"?i(c,""):s(c)}:s}}),no=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-null-or-undefined.js"(e,r){"use strict";r.exports=function(t){return t==null}}}),ur=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/require-object-coercible.js"(e,r){"use strict";var t=no(),n=TypeError;r.exports=function(o){if(t(o))throw new n("Can't call method on "+o);return o}}}),rt=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-indexed-object.js"(e,r){"use strict";var t=wi(),n=ur();r.exports=function(o){return t(n(o))}}}),te=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/global-this.js"(e,r){"use strict";var t=function(n){return n&&n.Math===Math&&n};r.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof e=="object"&&e)||function(){return this}()||Function("return this")()}}),jt=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-pure.js"(e,r){"use strict";r.exports=!1}}),dr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/define-global-property.js"(e,r){"use strict";var t=te(),n=Object.defineProperty;r.exports=function(o,s){try{n(t,o,{value:s,configurable:!0,writable:!0})}catch(i){t[o]=s}return s}}}),lr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/shared-store.js"(e,r){"use strict";var t=jt(),n=te(),o=dr(),s="__core-js_shared__",i=r.exports=n[s]||o(s,{});(i.versions||(i.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:"\xA9 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})}}),oo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/shared.js"(e,r){"use strict";var t=lr();r.exports=function(n,o){return t[n]||(t[n]=o||{})}}}),so=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-object.js"(e,r){"use strict";var t=ur(),n=Object;r.exports=function(o){return n(t(o))}}}),fe=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/has-own-property.js"(e,r){"use strict";var t=oe(),n=so(),o=t({}.hasOwnProperty);r.exports=Object.hasOwn||function(i,c){return o(n(i),c)}}}),io=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/uid.js"(e,r){"use strict";var t=oe(),n=0,o=Math.random(),s=t(1.1.toString);r.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+s(++n+o,36)}}}),bi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/environment-user-agent.js"(e,r){"use strict";var t=te(),n=t.navigator,o=n&&n.userAgent;r.exports=o?String(o):""}}),Ti=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/environment-v8-version.js"(e,r){"use strict";var t=te(),n=bi(),o=t.process,s=t.Deno,i=o&&o.versions||s&&s.version,c=i&&i.v8,a,u;c&&(a=c.split("."),u=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!u&&n&&(a=n.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=n.match(/Chrome\/(\d+)/),a&&(u=+a[1]))),r.exports=u}}),ao=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/symbol-constructor-detection.js"(e,r){"use strict";var t=Ti(),n=ne(),o=te(),s=o.String;r.exports=!!Object.getOwnPropertySymbols&&!n(function(){var i=Symbol("symbol detection");return!s(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41})}}),co=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/use-symbol-as-uid.js"(e,r){"use strict";var t=ao();r.exports=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}),nt=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/well-known-symbol.js"(e,r){"use strict";var t=te(),n=oo(),o=fe(),s=io(),i=ao(),c=co(),a=t.Symbol,u=n("wks"),l=c?a.for||a:a&&a.withoutSetter||s;r.exports=function(d){return o(u,d)||(u[d]=i&&o(a,d)?a[d]:l("Symbol."+d)),u[d]}}}),z=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-callable.js"(e,r){"use strict";var t=typeof document=="object"&&document.all;r.exports=typeof t>"u"&&t!==void 0?function(n){return typeof n=="function"||n===t}:function(n){return typeof n=="function"}}}),Ee=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-object.js"(e,r){"use strict";var t=z();r.exports=function(n){return typeof n=="object"?n!==null:t(n)}}}),kt=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/an-object.js"(e,r){"use strict";var t=Ee(),n=String,o=TypeError;r.exports=function(s){if(t(s))return s;throw new o(n(s)+" is not an object")}}}),ge=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/descriptors.js"(e,r){"use strict";var t=ne();r.exports=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}}),uo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/v8-prototype-define-bug.js"(e,r){"use strict";var t=ge(),n=ne();r.exports=t&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}}),lo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/document-create-element.js"(e,r){"use strict";var t=te(),n=Ee(),o=t.document,s=n(o)&&n(o.createElement);r.exports=function(i){return s?o.createElement(i):{}}}}),po=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/ie8-dom-define.js"(e,r){"use strict";var t=ge(),n=ne(),o=lo();r.exports=!t&&!n(function(){return Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a!==7})}}),xt=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/function-call.js"(e,r){"use strict";var t=ro(),n=Function.prototype.call;r.exports=t?n.bind(n):function(){return n.apply(n,arguments)}}}),pr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/get-built-in.js"(e,r){"use strict";var t=te(),n=z(),o=function(s){return n(s)?s:void 0};r.exports=function(s,i){return arguments.length<2?o(t[s]):t[s]&&t[s][i]}}}),Ii=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-is-prototype-of.js"(e,r){"use strict";var t=oe();r.exports=t({}.isPrototypeOf)}}),fo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-symbol.js"(e,r){"use strict";var t=pr(),n=z(),o=Ii(),s=co(),i=Object;r.exports=s?function(c){return typeof c=="symbol"}:function(c){var a=t("Symbol");return n(a)&&o(a.prototype,i(c))}}}),Ei=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/try-to-string.js"(e,r){"use strict";var t=String;r.exports=function(n){try{return t(n)}catch(o){return"Object"}}}}),go=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/a-callable.js"(e,r){"use strict";var t=z(),n=Ei(),o=TypeError;r.exports=function(s){if(t(s))return s;throw new o(n(s)+" is not a function")}}}),Ai=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/get-method.js"(e,r){"use strict";var t=go(),n=no();r.exports=function(o,s){var i=o[s];return n(i)?void 0:t(i)}}}),Pi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/ordinary-to-primitive.js"(e,r){"use strict";var t=xt(),n=z(),o=Ee(),s=TypeError;r.exports=function(i,c){var a,u;if(c==="string"&&n(a=i.toString)&&!o(u=t(a,i))||n(a=i.valueOf)&&!o(u=t(a,i))||c!=="string"&&n(a=i.toString)&&!o(u=t(a,i)))return u;throw new s("Can't convert object to primitive value")}}}),Ci=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-primitive.js"(e,r){"use strict";var t=xt(),n=Ee(),o=fo(),s=Ai(),i=Pi(),c=nt(),a=TypeError,u=c("toPrimitive");r.exports=function(l,d){if(!n(l)||o(l))return l;var p=s(l,u),f;if(p){if(d===void 0&&(d="default"),f=t(p,l,d),!n(f)||o(f))return f;throw new a("Can't convert object to primitive value")}return d===void 0&&(d="number"),i(l,d)}}}),ho=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-property-key.js"(e,r){"use strict";var t=Ci(),n=fo();r.exports=function(o){var s=t(o,"string");return n(s)?s:s+""}}}),Le=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-define-property.js"(e){"use strict";var r=ge(),t=po(),n=uo(),o=kt(),s=ho(),i=TypeError,c=Object.defineProperty,a=Object.getOwnPropertyDescriptor,u="enumerable",l="configurable",d="writable";e.f=r?n?function(f,g,h){if(o(f),g=s(g),o(h),typeof f=="function"&&g==="prototype"&&"value"in h&&d in h&&!h[d]){var y=a(f,g);y&&y[d]&&(f[g]=h.value,h={configurable:l in h?h[l]:y[l],enumerable:u in h?h[u]:y[u],writable:!1})}return c(f,g,h)}:c:function(f,g,h){if(o(f),g=s(g),o(h),t)try{return c(f,g,h)}catch(y){}if("get"in h||"set"in h)throw new i("Accessors not supported");return"value"in h&&(f[g]=h.value),f}}}),Oi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/math-trunc.js"(e,r){"use strict";var t=Math.ceil,n=Math.floor;r.exports=Math.trunc||function(s){var i=+s;return(i>0?n:t)(i)}}}),mo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-integer-or-infinity.js"(e,r){"use strict";var t=Oi();r.exports=function(n){var o=+n;return o!==o||o===0?0:t(o)}}}),ji=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-absolute-index.js"(e,r){"use strict";var t=mo(),n=Math.max,o=Math.min;r.exports=function(s,i){var c=t(s);return c<0?n(c+i,0):o(c,i)}}}),ki=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/to-length.js"(e,r){"use strict";var t=mo(),n=Math.min;r.exports=function(o){var s=t(o);return s>0?n(s,9007199254740991):0}}}),xi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/length-of-array-like.js"(e,r){"use strict";var t=ki();r.exports=function(n){return t(n.length)}}}),Ri=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/array-includes.js"(e,r){"use strict";var t=rt(),n=ji(),o=xi(),s=function(i){return function(c,a,u){var l=t(c),d=o(l);if(d===0)return!i&&-1;var p=n(u,d),f;if(i&&a!==a){for(;d>p;)if(f=l[p++],f!==f)return!0}else for(;d>p;p++)if((i||p in l)&&l[p]===a)return i||p||0;return!i&&-1}};r.exports={includes:s(!0),indexOf:s(!1)}}}),fr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/hidden-keys.js"(e,r){"use strict";r.exports={}}}),vo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-keys-internal.js"(e,r){"use strict";var t=oe(),n=fe(),o=rt(),s=Ri().indexOf,i=fr(),c=t([].push);r.exports=function(a,u){var l=o(a),d=0,p=[],f;for(f in l)!n(i,f)&&n(l,f)&&c(p,f);for(;u.length>d;)n(l,f=u[d++])&&(~s(p,f)||c(p,f));return p}}}),gr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/enum-bug-keys.js"(e,r){"use strict";r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}}),Di=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-keys.js"(e,r){"use strict";var t=vo(),n=gr();r.exports=Object.keys||function(s){return t(s,n)}}}),Mi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-define-properties.js"(e){"use strict";var r=ge(),t=uo(),n=Le(),o=kt(),s=rt(),i=Di();e.f=r&&!t?Object.defineProperties:function(a,u){o(a);for(var l=s(u),d=i(u),p=d.length,f=0,g;p>f;)n.f(a,g=d[f++],l[g]);return a}}}),Li=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/html.js"(e,r){"use strict";var t=pr();r.exports=t("document","documentElement")}}),hr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/shared-key.js"(e,r){"use strict";var t=oo(),n=io(),o=t("keys");r.exports=function(s){return o[s]||(o[s]=n(s))}}}),mr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-create.js"(e,r){"use strict";var t=kt(),n=Mi(),o=gr(),s=fr(),i=Li(),c=lo(),a=hr(),u=">",l="<",d="prototype",p="script",f=a("IE_PROTO"),g=function(){},h=function(v){return l+p+u+v+l+"/"+p+u},y=function(v){v.write(h("")),v.close();var I=v.parentWindow.Object;return v=null,I},T=function(){var v=c("iframe"),I="java"+p+":",E;return v.style.display="none",i.appendChild(v),v.src=String(I),E=v.contentWindow.document,E.open(),E.write(h("document.F=Object")),E.close(),E.F},w,b=function(){try{w=new ActiveXObject("htmlfile")}catch(I){}b=typeof document<"u"?document.domain&&w?y(w):T():y(w);for(var v=o.length;v--;)delete b[d][o[v]];return b()};s[f]=!0,r.exports=Object.create||function(I,E){var j;return I!==null?(g[d]=t(I),j=new g,g[d]=null,j[f]=I):j=b(),E===void 0?j:n.f(j,E)}}}),Ni=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/add-to-unscopables.js"(e,r){"use strict";var t=nt(),n=mr(),o=Le().f,s=t("unscopables"),i=Array.prototype;i[s]===void 0&&o(i,s,{configurable:!0,value:n(null)}),r.exports=function(c){i[s][c]=!0}}}),vr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/iterators.js"(e,r){"use strict";r.exports={}}}),Ui=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/weak-map-basic-detection.js"(e,r){"use strict";var t=te(),n=z(),o=t.WeakMap;r.exports=n(o)&&/native code/.test(String(o))}}),yr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/create-property-descriptor.js"(e,r){"use strict";r.exports=function(t,n){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:n}}}}),_r=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/create-non-enumerable-property.js"(e,r){"use strict";var t=ge(),n=Le(),o=yr();r.exports=t?function(s,i,c){return n.f(s,i,o(1,c))}:function(s,i,c){return s[i]=c,s}}}),yo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/internal-state.js"(e,r){"use strict";var t=Ui(),n=te(),o=Ee(),s=_r(),i=fe(),c=lr(),a=hr(),u=fr(),l="Object already initialized",d=n.TypeError,p=n.WeakMap,f,g,h,y=function(v){return h(v)?g(v):f(v,{})},T=function(v){return function(I){var E;if(!o(I)||(E=g(I)).type!==v)throw new d("Incompatible receiver, "+v+" required");return E}};t||c.state?(w=c.state||(c.state=new p),w.get=w.get,w.has=w.has,w.set=w.set,f=function(v,I){if(w.has(v))throw new d(l);return I.facade=v,w.set(v,I),I},g=function(v){return w.get(v)||{}},h=function(v){return w.has(v)}):(b=a("state"),u[b]=!0,f=function(v,I){if(i(v,b))throw new d(l);return I.facade=v,s(v,b,I),I},g=function(v){return i(v,b)?v[b]:{}},h=function(v){return i(v,b)});var w,b;r.exports={set:f,get:g,has:h,enforce:y,getterFor:T}}}),Fi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-property-is-enumerable.js"(e){"use strict";var r={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,n=t&&!r.call({1:2},1);e.f=n?function(s){var i=t(this,s);return!!i&&i.enumerable}:r}}),_o=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-get-own-property-descriptor.js"(e){"use strict";var r=ge(),t=xt(),n=Fi(),o=yr(),s=rt(),i=ho(),c=fe(),a=po(),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(d,p){if(d=s(d),p=i(p),a)try{return u(d,p)}catch(f){}if(c(d,p))return o(!t(n.f,d,p),d[p])}}}),So=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/function-name.js"(e,r){"use strict";var t=ge(),n=fe(),o=Function.prototype,s=t&&Object.getOwnPropertyDescriptor,i=n(o,"name"),c=i&&function(){}.name==="something",a=i&&(!t||t&&s(o,"name").configurable);r.exports={EXISTS:i,PROPER:c,CONFIGURABLE:a}}}),qi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/inspect-source.js"(e,r){"use strict";var t=oe(),n=z(),o=lr(),s=t(Function.toString);n(o.inspectSource)||(o.inspectSource=function(i){return s(i)}),r.exports=o.inspectSource}}),Bi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/make-built-in.js"(e,r){"use strict";var t=oe(),n=ne(),o=z(),s=fe(),i=ge(),c=So().CONFIGURABLE,a=qi(),u=yo(),l=u.enforce,d=u.get,p=String,f=Object.defineProperty,g=t("".slice),h=t("".replace),y=t([].join),T=i&&!n(function(){return f(function(){},"length",{value:8}).length!==8}),w=String(String).split("String"),b=r.exports=function(v,I,E){g(p(I),0,7)==="Symbol("&&(I="["+h(p(I),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),E&&E.getter&&(I="get "+I),E&&E.setter&&(I="set "+I),(!s(v,"name")||c&&v.name!==I)&&(i?f(v,"name",{value:I,configurable:!0}):v.name=I),T&&E&&s(E,"arity")&&v.length!==E.arity&&f(v,"length",{value:E.arity});try{E&&s(E,"constructor")&&E.constructor?i&&f(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch(ie){}var j=l(v);return s(j,"source")||(j.source=y(w,typeof I=="string"?I:"")),v};Function.prototype.toString=b(function(){return o(this)&&d(this).source||a(this)},"toString")}}),Sr=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/define-built-in.js"(e,r){"use strict";var t=z(),n=Le(),o=Bi(),s=dr();r.exports=function(i,c,a,u){u||(u={});var l=u.enumerable,d=u.name!==void 0?u.name:c;if(t(a)&&o(a,d,u),u.global)l?i[c]=a:s(c,a);else{try{u.unsafe?i[c]&&(l=!0):delete i[c]}catch(p){}l?i[c]=a:n.f(i,c,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return i}}}),Wi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-get-own-property-names.js"(e){"use strict";var r=vo(),t=gr(),n=t.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(s){return r(s,n)}}}),Ki=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-get-own-property-symbols.js"(e){"use strict";e.f=Object.getOwnPropertySymbols}}),Vi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/own-keys.js"(e,r){"use strict";var t=pr(),n=oe(),o=Wi(),s=Ki(),i=kt(),c=n([].concat);r.exports=t("Reflect","ownKeys")||function(u){var l=o.f(i(u)),d=s.f;return d?c(l,d(u)):l}}}),Gi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/copy-constructor-properties.js"(e,r){"use strict";var t=fe(),n=Vi(),o=_o(),s=Le();r.exports=function(i,c,a){for(var u=n(c),l=s.f,d=o.f,p=0;p<u.length;p++){var f=u[p];!t(i,f)&&!(a&&t(a,f))&&l(i,f,d(c,f))}}}}),$i=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-forced.js"(e,r){"use strict";var t=ne(),n=z(),o=/#|\.prototype\./,s=function(l,d){var p=c[i(l)];return p===u?!0:p===a?!1:n(d)?t(d):!!d},i=s.normalize=function(l){return String(l).replace(o,".").toLowerCase()},c=s.data={},a=s.NATIVE="N",u=s.POLYFILL="P";r.exports=s}}),Hi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/export.js"(e,r){"use strict";var t=te(),n=_o().f,o=_r(),s=Sr(),i=dr(),c=Gi(),a=$i();r.exports=function(u,l){var d=u.target,p=u.global,f=u.stat,g,h,y,T,w,b;if(p?h=t:f?h=t[d]||i(d,{}):h=t[d]&&t[d].prototype,h)for(y in l){if(w=l[y],u.dontCallGetSet?(b=n(h,y),T=b&&b.value):T=h[y],g=a(p?y:d+(f?".":"#")+y,u.forced),!g&&T!==void 0){if(typeof w==typeof T)continue;c(w,T)}(u.sham||T&&T.sham)&&o(w,"sham",!0),s(h,y,w,u)}}}}),Ji=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/correct-prototype-getter.js"(e,r){"use strict";var t=ne();r.exports=!t(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})}}),wo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-get-prototype-of.js"(e,r){"use strict";var t=fe(),n=z(),o=so(),s=hr(),i=Ji(),c=s("IE_PROTO"),a=Object,u=a.prototype;r.exports=i?a.getPrototypeOf:function(l){var d=o(l);if(t(d,c))return d[c];var p=d.constructor;return n(p)&&d instanceof p?p.prototype:d instanceof a?u:null}}}),bo=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/iterators-core.js"(e,r){"use strict";var t=ne(),n=z(),o=Ee(),s=mr(),i=wo(),c=Sr(),a=nt(),u=jt(),l=a("iterator"),d=!1,p,f,g;[].keys&&(g=[].keys(),"next"in g?(f=i(i(g)),f!==Object.prototype&&(p=f)):d=!0);var h=!o(p)||t(function(){var y={};return p[l].call(y)!==y});h?p={}:u&&(p=s(p)),n(p[l])||c(p,l,function(){return this}),r.exports={IteratorPrototype:p,BUGGY_SAFARI_ITERATORS:d}}}),To=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/set-to-string-tag.js"(e,r){"use strict";var t=Le().f,n=fe(),o=nt(),s=o("toStringTag");r.exports=function(i,c,a){i&&!a&&(i=i.prototype),i&&!n(i,s)&&t(i,s,{configurable:!0,value:c})}}}),zi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/iterator-create-constructor.js"(e,r){"use strict";var t=bo().IteratorPrototype,n=mr(),o=yr(),s=To(),i=vr(),c=function(){return this};r.exports=function(a,u,l,d){var p=u+" Iterator";return a.prototype=n(t,{next:o(+!d,l)}),s(a,p,!1,!0),i[p]=c,a}}}),Yi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/function-uncurry-this-accessor.js"(e,r){"use strict";var t=oe(),n=go();r.exports=function(o,s,i){try{return t(n(Object.getOwnPropertyDescriptor(o,s)[i]))}catch(c){}}}}),Qi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/is-possible-prototype.js"(e,r){"use strict";var t=Ee();r.exports=function(n){return t(n)||n===null}}}),Zi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/a-possible-prototype.js"(e,r){"use strict";var t=Qi(),n=String,o=TypeError;r.exports=function(s){if(t(s))return s;throw new o("Can't set "+n(s)+" as a prototype")}}}),Xi=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/object-set-prototype-of.js"(e,r){"use strict";var t=Yi(),n=Ee(),o=ur(),s=Zi();r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,c={},a;try{a=t(Object.prototype,"__proto__","set"),a(c,[]),i=c instanceof Array}catch(u){}return function(l,d){return o(l),s(d),n(l)&&(i?a(l,d):l.__proto__=d),l}}():void 0)}}),ea=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/iterator-define.js"(e,r){"use strict";var t=Hi(),n=xt(),o=jt(),s=So(),i=z(),c=zi(),a=wo(),u=Xi(),l=To(),d=_r(),p=Sr(),f=nt(),g=vr(),h=bo(),y=s.PROPER,T=s.CONFIGURABLE,w=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,v=f("iterator"),I="keys",E="values",j="entries",ie=function(){return this};r.exports=function(Y,C,A,V,M,ae,re){c(A,C,V);var ce=function(ue){if(ue===M&&Ae)return Ae;if(!b&&ue&&ue in Q)return Q[ue];switch(ue){case I:return function(){return new A(this,ue)};case E:return function(){return new A(this,ue)};case j:return function(){return new A(this,ue)}}return function(){return new A(this)}},me=C+" Iterator",Mt=!1,Q=Y.prototype,Ne=Q[v]||Q["@@iterator"]||M&&Q[M],Ae=!b&&Ne||ce(M),wr=C==="Array"&&Q.entries||Ne,ve,He,ot;if(wr&&(ve=a(wr.call(new Y)),ve!==Object.prototype&&ve.next&&(!o&&a(ve)!==w&&(u?u(ve,w):i(ve[v])||p(ve,v,ie)),l(ve,me,!0,!0),o&&(g[me]=ie))),y&&M===E&&Ne&&Ne.name!==E&&(!o&&T?d(Q,"name",E):(Mt=!0,Ae=function(){return n(Ne,this)})),M)if(He={values:ce(E),keys:ae?Ae:ce(I),entries:ce(j)},re)for(ot in He)(b||Mt||!(ot in Q))&&p(Q,ot,He[ot]);else t({target:C,proto:!0,forced:b||Mt},He);return(!o||re)&&Q[v]!==Ae&&p(Q,v,Ae,{name:M}),g[C]=Ae,He}}}),ta=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/internals/create-iter-result-object.js"(e,r){"use strict";r.exports=function(t,n){return{value:t,done:n}}}}),ra=m({"../../node_modules/.pnpm/core-js@3.47.0/node_modules/core-js/modules/es.array.iterator.js"(e,r){"use strict";var t=rt(),n=Ni(),o=vr(),s=yo(),i=Le().f,c=ea(),a=ta(),u=jt(),l=ge(),d="Array Iterator",p=s.set,f=s.getterFor(d);r.exports=c(Array,"Array",function(h,y){p(this,{type:d,target:t(h),index:0,kind:y})},function(){var h=f(this),y=h.target,T=h.index++;if(!y||T>=y.length)return h.target=null,a(void 0,!0);switch(h.kind){case"keys":return a(T,!1);case"values":return a(y[T],!1)}return a([T,y[T]],!1)},"values");var g=o.Arguments=o.Array;if(n("keys"),n("values"),n("entries"),!u&&l&&g.name!=="values")try{i(g,"name",{value:"values"})}catch(h){}}});function na(e,r){return r=r||{},new Promise(function(t,n){var o=new XMLHttpRequest,s=[],i=[],c={},a=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:a,headers:{keys:function(){return s},entries:function(){return i},get:function(l){return c[l.toLowerCase()]},has:function(l){return l.toLowerCase()in c}}}};for(var u in o.open(r.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(l,d,p){s.push(d=d.toLowerCase()),i.push([d,p]),c[d]=c[d]?c[d]+","+p:p}),t(a())},o.onerror=n,o.withCredentials=r.credentials=="include",r.headers)o.setRequestHeader(u,r.headers[u]);o.send(r.body||null)})}async function oa(e){let r=R({"Content-Type":"application/json"},e.headers),t=await na(e.url,{method:e.method,headers:r,body:sa(e)});if(t.ok)return ia(t);let n=new Error(t.statusText);return n.response=t,Promise.reject(n)}function sa(e){return typeof e.payload=="string"?e.payload:e.payload instanceof String?e.payload.valueOf():JSON.stringify(e.payload)}async function ia(e){let r="";e.headers&&e.headers.entries().forEach(n=>r+=`${n[0]}: ${n[1]}\r
`);let t={status:e.status,statusText:e.statusText,headers:r,data:""};try{let n=await e.json();t.data=n}catch(n){new Error(`response.payload cannot be parsed. Failed with error:
 ${n}`)}return t}var At,aa=new Uint8Array(16);function ca(){if(!At&&(At=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!At))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return At(aa)}var ua=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function da(e){return typeof e=="string"&&ua.test(e)}var la=da,N=[];for(Pt=0;Pt<256;++Pt)N.push((Pt+256).toString(16).substr(1));var Pt;function pa(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(N[e[r+0]]+N[e[r+1]]+N[e[r+2]]+N[e[r+3]]+"-"+N[e[r+4]]+N[e[r+5]]+"-"+N[e[r+6]]+N[e[r+7]]+"-"+N[e[r+8]]+N[e[r+9]]+"-"+N[e[r+10]]+N[e[r+11]]+N[e[r+12]]+N[e[r+13]]+N[e[r+14]]+N[e[r+15]]).toLowerCase();if(!la(t))throw TypeError("Stringified UUID is invalid");return t}var fa=pa;function ga(e,r,t){e=e||{};var n=e.random||(e.rng||ca)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var o=0;o<16;++o)r[t+o]=n[o];return r}return fa(n)}var ha=ga;function ma(){return ha()}var ir={ffLibraryVersionCode:1,ffLibraryVersionName:"1.0.2-beta",ffLibraryLanguage:"Javascript",minimumPollFrequencySeconds:60},zn="wmAppUserId",Ct="wmFeatureFlagConfig",Yn="wmFeatureFlagUserId",Qn="wmFeatureFlagConfigEtag",ar="wmFeatureFlagResults",Zn="wmConfigCacheStart",Xn="Cache was used due to remote loading failing.",va="Fallback used because remote config loading failed.",ya="Fallback or cache used because remote config loading failed.",_a="Fallback used because a requested flag was present in it and not the remote.",Sa="Remote config used because a fallback config is not present.",wa="There was a problem reading the config object from storage, possibly due to invalid config JSON.",tt="Unable to access localStorage",ba="Unable to access sessionStorage",Ta="A clientId must be provided for multiple instance support.",Ia=class{constructor(e,r){if(this.storageType=e,this.clientId=r,this.warnings=[],!this.clientId){let t={code:"MULTIPLE_INSTANCES_SUPPORT",message:`${Ta}`};this.warnings.push(t)}switch(this.storageType){case"localStorage":try{this.storage=localStorage}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${tt}: ${t}`};this.warnings.push(n)}break;case"sessionStorage":try{this.storage=sessionStorage}catch(t){let n={code:"UNABLE_TO_ACCESS_SESSION_STORAGE",message:`${ba}: ${t}`};this.warnings.push(n)}break;case"inMemory":default:try{this.storage=localStorage;break}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${tt}: ${t}`};this.warnings.push(n)}}}get(e){let r;if(typeof Storage>"u")return;let t=e;this.clientId&&(t=`${t}-${this.clientId}`);try{r=this.storage.getItem(t)}catch(n){let o={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${tt}: ${n}`};this.warnings.push(o)}return r}set(e,r){if(typeof Storage>"u")return;let t=e;this.clientId&&(t=`${t}-${this.clientId}`);try{this.storage.setItem(t,r)}catch(n){let o={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${tt}: ${n}`};this.warnings.push(o)}}delete(e){if(typeof Storage>"u")return;let r=e;this.clientId&&(r=`${r}-${this.clientId}`);try{this.storage.deleteItem(r)}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${tt}: ${t}`};this.warnings.push(n)}}},bu=_i(ra()),Ea=()=>{Object.entries||(Object.entries=function(e){let r=Object.keys(e),t=r.length,n=new Array(t);for(;t--;)n[t]=[r[t],e[r[t]]];return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null)throw TypeError('"this" is null or not defined');let r=Object(this),t=r.length>>>0;if(typeof e!="function")throw TypeError("predicate must be a function");let n=arguments[1],o=0;for(;o<t;){let s=r[o];if(e.call(n,s,o,r))return s;o++}},configurable:!0,writable:!0})},Aa=Ea,cr="input is invalid type",_="0123456789abcdef".split(""),Pa=[-2147483648,8388608,32768,128],ee=[24,16,8,0],Ot=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ca=class{constructor(){this.blocks=[],this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}create(){return this}update(e){if(this.finalized)return;let r,t=typeof e;if(t!=="string"){if(t==="object"){if(e===null)throw new Error(cr);if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error(cr)}else throw new Error(cr);r=!0}let n,o=0,s,i=e.length,c=this.blocks;for(;o<i;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),r)for(s=this.start;o<i&&s<64;++o)c[s>>2]|=e[o]<<ee[s++&3];else for(s=this.start;o<i&&s<64;++o)n=e.charCodeAt(o),n<128?c[s>>2]|=n<<ee[s++&3]:n<2048?(c[s>>2]|=(192|n>>6)<<ee[s++&3],c[s>>2]|=(128|n&63)<<ee[s++&3]):n<55296||n>=57344?(c[s>>2]|=(224|n>>12)<<ee[s++&3],c[s>>2]|=(128|n>>6&63)<<ee[s++&3],c[s>>2]|=(128|n&63)<<ee[s++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++o)&1023),c[s>>2]|=(240|n>>18)<<ee[s++&3],c[s>>2]|=(128|n>>12&63)<<ee[s++&3],c[s>>2]|=(128|n>>6&63)<<ee[s++&3],c[s>>2]|=(128|n&63)<<ee[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=c[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}finalize(){if(this.finalized)return;this.finalized=!0;let e=this.blocks,r=this.lastByteIndex;e[16]=this.block,e[r>>2]|=Pa[r&3],this.block=e[16],r>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}hash(){let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,s=this.h5,i=this.h6,c=this.h7,a,u,l,d,p,f,g,h,y,T,w,b=this.blocks;for(a=16;a<64;++a)p=b[a-15],u=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,p=b[a-2],l=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,b[a]=b[a-16]+u+b[a-7]+l<<0;for(w=r&t,a=0;a<64;a+=4)this.first?(h=704751109,p=b[0]-210244248,c=p-1521486534<<0,n=p+143694565<<0,this.first=!1):(u=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),l=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),h=e&r,d=h^e&t^w,g=o&s^~o&i,p=c+l+g+Ot[a]+b[a],f=u+d,c=n+p<<0,n=p+f<<0),u=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),l=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),y=n&e,d=y^n&r^h,g=c&o^~c&s,p=i+l+g+Ot[a+1]+b[a+1],f=u+d,i=t+p<<0,t=p+f<<0,u=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),l=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),T=t&n,d=T^t&e^y,g=i&c^~i&o,p=s+l+g+Ot[a+2]+b[a+2],f=u+d,s=r+p<<0,r=p+f<<0,u=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),l=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),w=r&t,d=w^r&n^T,g=s&i^~s&c,p=o+l+g+Ot[a+3]+b[a+3],f=u+d,o=e+p<<0,e=p+f<<0;this.h0=this.h0+e<<0,this.h1=this.h1+r<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+o<<0,this.h5=this.h5+s<<0,this.h6=this.h6+i<<0,this.h7=this.h7+c<<0}hex(){this.finalize();let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,s=this.h5,i=this.h6,c=this.h7,a=_[e>>28&15]+_[e>>24&15]+_[e>>20&15]+_[e>>16&15]+_[e>>12&15]+_[e>>8&15]+_[e>>4&15]+_[e&15]+_[r>>28&15]+_[r>>24&15]+_[r>>20&15]+_[r>>16&15]+_[r>>12&15]+_[r>>8&15]+_[r>>4&15]+_[r&15]+_[t>>28&15]+_[t>>24&15]+_[t>>20&15]+_[t>>16&15]+_[t>>12&15]+_[t>>8&15]+_[t>>4&15]+_[t&15]+_[n>>28&15]+_[n>>24&15]+_[n>>20&15]+_[n>>16&15]+_[n>>12&15]+_[n>>8&15]+_[n>>4&15]+_[n&15]+_[o>>28&15]+_[o>>24&15]+_[o>>20&15]+_[o>>16&15]+_[o>>12&15]+_[o>>8&15]+_[o>>4&15]+_[o&15]+_[s>>28&15]+_[s>>24&15]+_[s>>20&15]+_[s>>16&15]+_[s>>12&15]+_[s>>8&15]+_[s>>4&15]+_[s&15]+_[i>>28&15]+_[i>>24&15]+_[i>>20&15]+_[i>>16&15]+_[i>>12&15]+_[i>>8&15]+_[i>>4&15]+_[i&15];return a+=_[c>>28&15]+_[c>>24&15]+_[c>>20&15]+_[c>>16&15]+_[c>>12&15]+_[c>>8&15]+_[c>>4&15]+_[c&15],a}toString(){return this.hex()}digest(){this.finalize();let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,s=this.h5,i=this.h6,c=this.h7,a=[e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,o>>24&255,o>>16&255,o>>8&255,o&255,s>>24&255,s>>16&255,s>>8&255,s&255,i>>24&255,i>>16&255,i>>8&255,i&255];return a.push(c>>24&255,c>>16&255,c>>8&255,c&255),a}array(){return this.digest()}arrayBuffer(){this.finalize();let e=new ArrayBuffer(32),r=new DataView(e);return r.setUint32(0,this.h0),r.setUint32(4,this.h1),r.setUint32(8,this.h2),r.setUint32(12,this.h3),r.setUint32(16,this.h4),r.setUint32(20,this.h5),r.setUint32(24,this.h6),r.setUint32(28,this.h7),e}};Aa();var Io=class{constructor(e,r,t=!1){if(this.addStorageWarnings=()=>{let o=[];return this.storage.warnings&&this.storage.warnings.length>0&&this.storage.warnings.map(s=>{o.push(s)}),o},this.targetingPropsToLowerCase=o=>Object.entries(o).reduce((s,[i,c])=>{let a;return typeof c=="string"&&(a=c.toLowerCase()),Array.isArray(c)&&(a=c.map(u=>u.toLowerCase())),s[i.toLowerCase()]=a,s},{}),!e)throw new Error("Please provide a context object to the constructor.");if(!e.configUrl&&!r)throw new Error("Please provide either a config url or a valid config object.");this.config=void 0,this.configRefreshIntervalDefault=ir.minimumPollFrequencySeconds,this.context=e,this.fallbackConfig=r,this.featureFlagUserId="",this.libraryLanguage=ir.ffLibraryLanguage,this.initialized=!1,this.quickInit=t;let n=e&&e.storageType?e.storageType:"";this.storage=new Ia(n,e.clientId),this.globalWarnings=[]}createHash(e,r){let n=new Ca().create();return n.update(`${e}${r}`),n.hex()}createUserId(){return ma()}getUserFeatureIndex(e){return parseInt(e.substring(0,10),16).toString().slice(-2)}async init(){let e=[],{config:r,fallbackConfig:t,initialized:n,featureFlagUserId:o,libraryLanguage:s,storage:i,configRefreshIntervalDefault:c,quickInit:a}=this,{configUrl:u,userId:l,configRefreshInterval:d}=this.context,p=typeof d<"u"?d:c,f=this.checkConfigCacheExpiry(p);if(!r||f){let g=i.get(Ct);try{g&&(this.config=JSON.parse(g))}catch(h){let y={code:"FAILED_TO_READ_CONFIG_FROM_STORAGE",message:wa};e.push(y)}if(!g||f)if(u){!f&&t&&this.updateConfig(t);let h=i.get(Qn)||"-1";h=g?h:"-1";try{if(a&&t)return g||this.updateConfig(t),this.loadAndSetRemoteConfig(u,h),e;if(a&&!t){let y={code:"REMOTE_CONFIG_USED_NO_FALLBACK_PRESENT",message:Sa};e.push(y)}await this.loadAndSetRemoteConfig(u,h)}catch(y){if(g||t)this.setNoNewConfigWarning();else throw new Error(`Failed to load config file - no config url or default config provided. ${y}`)}}else{if(!t)throw new Error("Failed to load config file - no config url or default config provided.");this.updateConfig(t)}}if(n)return e;if(l)i.set(zn,l);else{let g=i.get(zn);g&&(this.context.userId=g)}if(!o){let g=i.get(Yn);g&&(this.featureFlagUserId=g),g||(this.featureFlagUserId=this.createUserId(),i.set(Yn,this.featureFlagUserId))}if(!this.context.userTargetingProperties||this.context.userTargetingProperties&&!this.context.userTargetingProperties.ffLibraryLanguage){let g={ffLibraryLanguage:s};this.updateContext(void 0,g)}return this.initialized=!0,e}checkConfigCacheExpiry(e){let{storage:r}=this,t=new Date,n=!1,o=a=>r.set(Zn,a),s=r.get(Zn);s||o(JSON.stringify(new Date().getTime()));let i=s?JSON.parse(s):t.getTime();return n=t.getTime()-i>e,n===!0&&o(JSON.stringify(new Date().getTime())),n}async isFeatureEnabled(e){return(await this.queryFeatureFlag(e)).enabled}setNoNewConfigWarning(){let{fallbackConfig:e,storage:r}=this,t=r.get(Ct);if(t){let n={code:"CACHE_USED",message:Xn};this.globalWarnings.push(n)}else!t&&e&&(this.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:Xn}),this.updateConfig(e))}parseHeaders(e){return e.split(`\r
`).reduce(function(t,n){let o=n.split(": ");return t[o[0]]=o[1],t},{})}async loadAndSetRemoteConfig(e,r){try{let t=await this.loadConfig(e,r);if(t){this.config=t.data?t.data:this.config,t.data||this.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:va});let n=t.headers&&t.headers.etag?t.headers.etag:"";t.headers&&typeof t.headers=="string"&&(n=this.parseHeaders(t.headers).etag),n&&this.storage.set(Qn,n),this.storage.set(Ct,JSON.stringify(this.config))}}catch(t){this.globalWarnings.push({code:"FALLBACK_OR_CACHE_USED_REMOTE_LOAD_FAILED",message:ya}),this.setNoNewConfigWarning()}}async loadConfig(e,r="-1"){let t,n=`${e}?version=${ir.ffLibraryVersionCode}`,o={"If-None-Match":r},s={headers:o};try{t=await oa({url:n,method:"GET",headers:o})}catch(i){throw new Error(`Failed to fetch config file: ${i}`)}return t}updateConfig(e){this.config=e,this.storage.set(Ct,JSON.stringify(e))}updateContext(e,r,t){let n=R({},this.context);if(e&&(n.userId=e),t)n.userTargetingProperties=r;else{let o=R(R({},n.userTargetingProperties),r);n.userTargetingProperties=o}this.context=n}getCohortConfig(e,r){let n={rolloutValue:"-1",cohortPriority:1,stickinessProperty:e.userId?"appUserId":"ffUserId"},o=[...r];o.sort((c,a)=>c.cohortPriority>a.cohortPriority?1:-1);let s=this.targetingPropsToLowerCase(e.userTargetingProperties),i=o.find(c=>{let a=!1;if(!e.userId&&c.stickinessProperty==="appUserId")return!1;if(!c.cohortCriteria||c.cohortCriteria.length<1)return!0;let u=c.cohortCriteria;for(let l=0;l<u.length;l++){let{requiredFieldName:d}=u[l],{requiredFieldValues:p}=u[l];if(d=d.toLowerCase(),a=p.some(g=>{if(g=g.toLowerCase(),!s.hasOwnProperty(d)&&g==="")return!0;if(typeof s[d]=="string")return s[d]===g;if(Array.isArray(s[d]))return s[d].some(h=>h===g)}),!a)break}return a});return i&&(n=R({},i)),n}cacheFlagResults(e){let{storage:r}=this,t=[],n=[],o=[];Array.isArray(e)?o=e?[...e]:[]:o.push(e);let s=r.get(ar);t=[...s?JSON.parse(s):[]],t.length>0&&(n=t.reduce((a,u)=>o.find(l=>l.flagId===u.flagId)?a:[...a,u],[]));let c=[...n,...o];return r.set(ar,JSON.stringify(c)),c}checkIfFlagUpdated(e){let{storage:r}=this,t=r.get(ar),n=t?JSON.parse(t):[];if(n.length<1)return!0;let o=n.find(i=>i.flagId===e.flagId);return o?o.enabled!==e.enabled:!0}async queryFeatureFlag(e,r=!1){let{context:t,fallbackConfig:n}=this,o=!1,s,i,c,a,u,l="appUserId",d=[],p=T=>{let w=r?[]:this.globalWarnings;return d.concat(T,w)},f=(T,w)=>T.flags.find(b=>b.id===w),g=(T,w)=>{if(s=f(T,w),s){let b=this.addStorageWarnings();d=p(b);let v={clientId:t.clientId,flagId:s.id,flagName:s.name?s.name:void 0,enabled:s.defaultValue,updatedSinceLastQuery:!0,warnings:d};return v.updatedSinceLastQuery=this.checkIfFlagUpdated(v),this.cacheFlagResults(v),v}};try{if(d=(await this.init()).concat(d),a=this.context.userId?this.context.userId:void 0,!this.config||!this.config.flags)throw new Error("Operation failed - no config file or invalid config file detected.");if(s=f(this.config,e),!s){if(n){let A=g(n,e);if(A){let V={code:"FALLBACK_USED_FLAG_NOT_IN_REMOTE",message:_a};return d.push(V),A}}throw new Error("Flag not found")}let{cohorts:w,defaultValue:b,name:v,type:I}=s;if(I&&I.toLowerCase()!=="boolean"&&!r)throw new Error("Flag not found");if(!w||w.length<1){let A=this.addStorageWarnings();d=p(A);let V={clientId:t.clientId,flagId:s.id,flagName:v,enabled:s.defaultValue,updatedSinceLastQuery:!0,warnings:d};return V.updatedSinceLastQuery=this.checkIfFlagUpdated(V),this.cacheFlagResults(V),V}i=v;let E=this.getCohortConfig(t,w),{rolloutValue:j}=E,{stickinessProperty:ie}=E;j=j||"0";let Y=s.id;c=this.context.userId?this.context.userId:void 0,ie==="ffUserId"&&(a=this.featureFlagUserId,l="ffUserId",c=a);let C=c?this.createHash(c,Y):void 0;if(u=C?this.getUserFeatureIndex(C):"-1",o=parseInt(u,10)<parseInt(j,10),parseInt(j,10)<0||parseInt(u,10)<0||parseInt(u,10)>99){if(typeof b>"u"){if(n){let A=g(n,e);if(A)return A;throw new Error("Flag not found")}throw new Error("Unable to determine flag default value")}o=b}}catch(T){throw new Error(`Failed to query feature flag: ${T}`)}let h=this.addStorageWarnings();d=p(h);let y={flagId:e,flagName:i,enabled:o,updatedSinceLastQuery:!0,clientId:t.clientId,userId:a,userIdType:l,warnings:d};return y.updatedSinceLastQuery=this.checkIfFlagUpdated(y),this.cacheFlagResults(y),y}async queryAllFeatureFlags(){await this.init();let{config:e}=this;if(!e||!e.flags)throw new Error("No config file or invalid config file detected.");let r={anyFlagsUpdatedSinceLastQuery:!1,globalWarnings:this.globalWarnings,results:[]},t=e.flags.map(async n=>{let o=await this.queryFeatureFlag(n.id,!0);o.updatedSinceLastQuery===!0&&(r.anyFlagsUpdatedSinceLastQuery=!0),r.results.push(o)});return Promise.all(t).then(()=>r)}};var Uo=Lt(tr()),Fo=Lt(xo());Ze();function La(e){let r=e;return typeof r<"u"&&r!==null&&(r.constructor==={}.constructor||r.constructor===[].constructor)}function Na(e){if(!La(e))return!1;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!0;return!1}function he(){let e={},r=(s,i)=>{i!=null&&i!==""&&(e[s]=i)};return{add:r,addMap:s=>{for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&r(i,s[i])},addJson:(s,i)=>{if(i&&Na(i)){let c=JSON.stringify(i);r(s,c)}},build:()=>e}}function Ua(e){return e==null||e==null?new Date().toISOString():new Date(e).toISOString()}var Ro=e=>{let r={};return Array.isArray(e)?e:(Object.entries(e).forEach(([t,n])=>{n===Object(n)?r[t]=Ro(n):n!=null&&(r[t]=e[t])}),r)};function Do(e){let r={},t=(o,s)=>{r[o]=s},n=(o,s,i)=>{o.addMap(Ro(r)),o.add("eventTimestamp",Ua(s)),o.add("eventId",be()),typeof e=="function"&&e(o);try{i&&i(o.build())}catch(c){console.warn("[PSM]: error running custom callback")}return o};return{addEntry:t,setPlatform(o){t("platform",o)},setBrand(o){t("brand",o)},setSubBrand(o){t("subBrand",o)},setProductName(o){t("productName",o)},setWMUKID(o){t("wmukid",o)},setThirdPartyIds(o){t("ids",o)},setDevice(o){t("device",o)},setNavigationProperties(o){t("navigationProperties",o)},setClientResolvedIp(o){t("clientResolvedIp",o)},setLocation(o){t("location",o)},setConsentProperties(o){t("consentProperties",o)},setIABCategories(o){t("iabConsentCategories",o)},setLibrary(o){let i=window.WM,c=i==null?void 0:i.UserConsent,a=null;c&&(a={version:c.getVersion(),usingPsm:c.usingPSM(),initConfig:i.UserConsentConfig}),t("library",R({wmucLibrary:a},o))},setEventProperties(o){t("eventProperties",o)},setSessionProperties(o){t("session",o)},setContentMetadata(o){t("contentMetadata",o)},trackAppLoad(o,s){let i=he();return i.add("eventType","telemetry"),i.add("eventName","appLoad"),n(i,o,s)},trackPubSub(o,s,i){let c=he(),a={eventTrigger:"pubsub"};return c.add("eventType","telemetry"),c.add("eventName",o),t("eventProperties",a),n(c,s,i)},trackIdentityRegistration(o,s,i){let c=he();return c.add("eventType","identity"),c.add("eventName",o),n(c,s,i)},trackTokenEvent(o,s,i){let c=he();return c.add("eventType","token"),c.add("eventName",o),n(c,s,i)},trackConsentUpdated(o,s,i,c){let a=he(),u={eventTrigger:o,uspString:s==null?void 0:s.usp,region:s==null?void 0:s.region};return a.add("eventType","privacy"),a.add("eventName","consent update"),t("eventProperties",u),n(a,i,c)},trackConsentGranted(o,s){let i=he();return i.add("eventType","privacy"),i.add("eventName","ccpaShareData"),n(i,o,s)},trackConsentWithdrawn(o,s){let i=he();return i.add("eventType","privacy"),i.add("eventName","ccpaShareData"),n(i,o,s)},trackPageExit(o,s,i){let c=he();return c.add("eventType","telemetry"),c.add("eventName","pageExit"),c.add("eventTrigger",o),n(c,s,i)}}}de();var Dt=class{constructor(r){this.isTracking=!1;this.psm=r.psm,this.core=r.core,this.env=r.env,this.currentUrl=window.location.href}startTracking(){if(this.isTracking)return;this.isTracking=!0;let r=window.history.pushState,t=window.history.replaceState;window.history.pushState=function(...n){r.apply(window.history,n),window.dispatchEvent(new Event("psmlocationchange"))},window.history.replaceState=function(...n){t.apply(window.history,n),window.dispatchEvent(new Event("psmlocationchange"))},window.addEventListener("popstate",this.handleNavigation.bind(this)),window.addEventListener("hashchange",this.handleNavigation.bind(this)),window.addEventListener("psmlocationchange",this.handleNavigation.bind(this))}handleNavigation(){let r=window.location.href;this.currentUrl!==r&&(this.currentUrl=r,this.psm.setSessionProperties(!1,this.env),this.sendEvents())}sendEvents(){(Et(),Cr(Hn)).hydratePayload(this.psm,this.core),this.core.trackIdentityRegistration("identity on page start",new Date().toISOString(),r=>{this.psm.queryFlag("doppler-identity-onstart")&&(this.psm.requestQueue.addItem(r),this.psm.resetNewSessionFields())}),this.core.trackIdentityRegistration("identity on page complete",new Date().toISOString(),r=>{this.psm.queryFlag("doppler-identity-oncomplete")&&(this.psm.requestQueue.addItem(r),this.psm.resetNewSessionFields())})}};function Mo(e){return(r,t)=>{let n=["bot","crawl","spider"];if(new RegExp(n.join("|"),"i").test(window.navigator.userAgent))return t(null,{});r.sentAtTimestamp=new Date().toISOString(),pe(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(s=>t(null,s)).catch(s=>{P({err:s,methodName:"sendRequest",eventType:r.eventType||"queue"}),t(s)})}}var Lo=(e,r)=>{let t=r.psmObject;t.initPsm=e.initPsm.bind(e),t.getVersion=e.getVersion.bind(e),t.getWMUKID=r.getWMUKID.bind(e),t.getCDPID=r.getCDPID.bind(e),t.getConfig=e.getConfig.bind(e),t.getConsentProperties=r.getConsentProperties.bind(e),t.getBrand=e.getBrand.bind(e),t.getBrandToken=e.getBrandToken.bind(e),t.getSubBrand=e.getSubBrand.bind(e),t.getCoppaPrivacyMode=e.getCoppaPrivacyMode.bind(e),t.setCoppaPrivacyMode=e.setCoppaPrivacyMode.bind(e),t.getDeviceProperties=e.getDeviceProperties.bind(e),t.getIds=e.getIds.bind(e),t.getLibrary=e.getLibrary.bind(e),t.getLocationProperties=e.getLocationProperties.bind(e),t.getDeviceProperties=e.getDeviceProperties.bind(e),t.getNavigationProperties=e.getNavigationProperties.bind(e),t.getSessionProperties=e.getSessionProperties.bind(e),t.isDopplerIdentityOnStartEnabled=()=>e.queryFlag("doppler-identity-onstart"),t.isDopplerIdentityOnCompleteEnabled=()=>e.queryFlag("doppler-identity-oncomplete"),t.isDopplerPrivacyEnabled=()=>e.queryFlag("doppler-privacy"),t.isDopplerTelemetryEnabled=()=>e.queryFlag("doppler-telemetry"),e.setUspData&&(t.setUspData=e.setUspData.bind(e),t.getUspBoolean=e.getUspBoolean.bind(e),t.getUspString=e.getUspString.bind(e),t.getComScoreFromUsp=e.getComScoreFromUsp.bind(e),t.getUspData=e.getUspData.bind(e))};We();Et();var No="3.2.1";var K=class extends Kr{constructor(){super();K.dependencies=Jn(this),Lo(this,K.dependencies),K.dependencies.getFlags=this.getFlags.bind(this)}async initPsm(t){var c;let n=window,o=n.psmInitialized;if(this.ready||o)return;if(this.browser=gn(),this.config.browser=this.browser,this.config=Object.assign(this.config,t),Mn(this),typeof t>"u")throw new Error("[PSM]: Please provide a valid configuration to initPsm");let s=async()=>{if(this.coppaPrivacyMode===Fo.COPPAPrivacyModesEnum.ZERO_ID)return;n.psmInitialized=!0;let a=t.psmEnvironment.toUpperCase(),u=Do();this.core=u,this.requestQueue=new Uo.default("prismCE",at,Mo($.identity[a]));let l=!1;if(window.location!==window.parent.location&&t.psmBrandToken!=="cnnamp")return;t.psmBrandToken==="cnnamp"&&(l=!0),this.wmukid=K.dependencies.initWMUKID(this.coppaPrivacyMode,l,a),this.cdpid=await K.dependencies.initCDPID(a,this.config.platform),this.setSendWMSegs(a),this.setSendAuth2Token(a),(it.includes(this.countryCode)||this.getBrand()==="CNN")&&K.dependencies.resolveAuthTokens(u,S,this),window.ZionMessageBus&&window.ZionMessageBus.getInstance().publish("id_found",{type:"wmukid",value:this.wmukid}),this.setSessionProperties(!0,a),this.setIsInExperiment("isInAuthTokenExperiment",a),Ie(this,u),u.trackIdentityRegistration("identity on page start",new Date().toISOString(),p=>{this.queryFlag("doppler-identity-onstart")&&(this.requestQueue.addItem(p),this.resetNewSessionFields()),a==="AUTOMATED_TEST"&&window.localStorage.setItem("payload-on-start",JSON.stringify(p))});let d=()=>{this.setSessionProperties(!1,a),Ie(this,u),u.trackIdentityRegistration("identity on page complete",new Date().toISOString(),p=>{this.queryFlag("doppler-identity-oncomplete")&&(this.requestQueue.addItem(p),a==="AUTOMATED_TEST"&&window.localStorage.setItem("payload-on-complete",JSON.stringify(p)),this.resetNewSessionFields())})};if(document.readyState==="complete"?d():window.addEventListener("load",d),document.addEventListener("userConsentChanged",p=>{P({message:"userConsentChanged event received",methodName:"initPsm",eventType:"privacy",context:{eventDetails:p.detail}}),this.setSessionProperties(!1,a),Ie(this,u),u.trackConsentUpdated("userConsentChanged",p.detail,new Date().toISOString(),f=>{this.queryFlag("doppler-consent-update")&&(P({message:"Consent Update event registered",methodName:"initPsm",eventType:"privacy",context:{payload:f}}),this.requestQueue.addItem(f),this.resetNewSessionFields())})}),this.queryFlag("doppler-pubsub-event"))for(let p in t.topics)t.topics[p].forEach(f=>{window.PubSub&&window.PubSub.subscribe(f,(...g)=>{let h=typeof g[1]=="object"?g[1]:g[0];h=Object.keys(h).length<3&&h.video?h.video:h,window.psmPubSubData=window.psmPubSubData||{},window.psmPubSubData[p]=window.psmPubSubData[p]||{},Object.assign(window.psmPubSubData[p],h),Ie(this,u),u.trackPubSub(f,new Date().toISOString(),y=>{this.requestQueue.addItem(y),this.resetNewSessionFields()})})});this.requestQueue.start(),this.queryFlag("enable-spa-navigation-tracking")&&(this.navigationTracker=new Dt({psm:this,core:u,env:a}),this.navigationTracker.startTracking(),P({message:"[PSM]: Simplified navigation tracker initialized",methodName:"initPsm",eventType:"navigation"})),this.ready=!0};this.validateConfig(t),this.countryCode=this.hasProperty("countryCode",t)&&typeof t.countryCode<"u"&&this.config.countryCode.length?this.config.countryCode.toUpperCase():"";try{this.config.appId=typeof this.config.appId<"u"||this.config.appId?this.config.appId:"";let a=await pe($.locateV2,{headers:{"app-id":this.config.appId}});this.location.ip_address=a.ip,this.location.country=a.country,this.location.country_alpha2=a.countryAlpha2,this.location.country_alpha3=a.countryAlpha3,this.countryCode=this.countryCode===""?this.location.country_alpha2:this.countryCode,this.location.states=[{cities:[a.city],counties:[...a.counties],state:a.state,zipcodes:[...a.zipcodes]}],this.location.proxy=a.proxy}catch(a){this.location.country=(c=this.countryCode)!=null?c:void 0,this.location.country_alpha2=void 0}try{let{shouldLoad:a,categories:u}=await Un(t.brand);it.includes(this.countryCode)?this.consentRule="US":a&&kr.includes(this.countryCode)?this.consentRule="LATAM":a&&jr.includes(this.countryCode)&&(this.consentRule="GDPR"),this.consentCategories=u.reduce((l,d)=>R(R({},l),d),{})}catch(a){this.consentCategories={}}this.initCoppaPrivacyMode();let i=`psmFFClient-${this.config.brand}-${this.config.subBrand}`;this.ffClient=new Io({configUrl:$.featureFlag[t.psmEnvironment.toUpperCase()],configRefreshInterval:6e4,userTargetingProperties:{Platform:["Web"],Brand:[t.brand],Browser:this.browser,ClientID:i,CountryCode:this.countryCode},clientId:i});try{let a=await this.ffClient.queryAllFeatureFlags();this.flags=a.results,(this.consentRule==="US"||this.consentRule==="GDPR"&&this.queryFlag("outside-us-location-check")||this.consentRule==="LATAM"&&this.queryFlag("outside-us-location-check"))&&await s()}catch(a){console.log("[PSM]: Error encountered during location check",a)}}getWMUKID(){return K.dependencies.getWMUKID()}getCDPID(){return K.dependencies.getCDPID()}getConsentProperties(){return K.dependencies.getConsentProperties()}setSendAuth2Token(t){let n=this.queryFlag("sendAuthToken2");return S.set("sendAuthToken",n,{secure:t!=="AUTOMATED_TEST"}),S.set("sendAuthToken2",n,{secure:t!=="AUTOMATED_TEST"})}setIsInExperiment(t,n){let o=this.queryFlag(t);return S.set(t,o,{secure:n!=="AUTOMATED_TEST"})}setSendWMSegs(t){let n=this.queryFlag("sendWMSegs");return S.set("sendWMSegs",n,{secure:t!=="AUTOMATED_TEST"})}getPageLoadId(t,n){let o=S.get("psmPageLoadId"),s=o&&parseInt(o),i=s;return t&&(i=1),!t&&n&&s&&(i=s+1),i}setSessionProperties(t=!1,n){let o=new Date,s={isSessionStart:!0,pageloadid:this.getPageLoadId(!0,t),psmLastActiveTimestamp:o.toISOString(),psmSessionStart:o.toISOString(),sessionDuration:0,sessionid:be()},i=S.get("psmSessionId"),c=S.get("psmSessionStart"),a=S.get("psmLastActiveTimestamp");if(i!==null){let u=new Date(a),l=new Date(c),d=o.getTime()-u.getTime();d>18e5?(je({message:`[PSM]: Session ${i} timed out after ${d/1e3} seconds.`,methodName:"setSessionProperties",eventType:"session"}),s=Ue(R({},s),{previousSession:{psmLastActiveTimestamp:a,psmSessionStart:c,sessionDuration:(u.getTime()-l.getTime())/1e3,sessionid:i}})):(P({message:`[PSM]: Session ${i} still active after ${d/1e3} seconds. Updating last active timestamp.`,methodName:"setSessionProperties",eventType:"session"}),s={isSessionStart:!1,pageloadid:this.getPageLoadId(!1,t),psmLastActiveTimestamp:o.toISOString(),psmSessionStart:c,sessionDuration:(o.getTime()-l.getTime())/1e3,sessionid:i})}else je({message:"[PSM]: Creating new session",methodName:"setSessionProperties",eventType:"session"});S.set("psmSessionId",s.sessionid,{secure:n!=="AUTOMATED_TEST"}),S.set("psmLastActiveTimestamp",s.psmLastActiveTimestamp,{secure:n!=="AUTOMATED_TEST"}),S.set("psmSessionStart",s.psmSessionStart,{secure:n!=="AUTOMATED_TEST"}),S.set("psmPageLoadId",JSON.stringify(s.pageloadid),{secure:n!=="AUTOMATED_TEST"}),this.session=s}resetNewSessionFields(){this.session=Ue(R({},this.session),{isSessionStart:!1,previousSession:null})}getFlags(){return this.flags.reduce((t,n)=>Ue(R({},t),{[n.flagId]:n}),{})}getDeviceProperties(){return{type:K.dependencies.platform,userAgent:window.navigator.userAgent}}getLibrary(){return{name:"Prism JS",version:No,initConfig:this.config}}getIds(){return{attuuid:xe()||"",cdpid:K.dependencies.getCDPID(),cnnuid:Te()||"",convivaid:De()||"",ecid:Re()||"",kruxid:ke()||"",liverampatsid:S.get("tok_lr"),wminid:S.get("wminid"),zionid:Me()||""}}getNavigationProperties(){return{url:window.location.href,rootDomain:dt(window.location.href),referrer:mt(),path:window.location.pathname,search:window.location.search,title:window.document.title}}queryFlag(t){let n=Rr[t]||!1;try{let{enabled:o}=this.flags.find(s=>s.flagId===t);n=o}catch(o){Ln({err:o,methodName:"queryFlag",eventType:"featureFlagging"})}return n}};var Sd=new K;})();
//# sourceMappingURL=psm.legacy.min.umd.js.map